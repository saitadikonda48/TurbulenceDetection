function CustomLabel(e,t,a,i){this.latlng_=e,this.aircraft_id=a,void 0!==i&&(this.active_label=1),this.setMap(t)}function format_flight_level(e){var t="FL",a=Math.round(e/100);return t+=a<10?"00"+a:a<100?"0"+a:a}function initSettings(){setting_map_weather=getSetting("map_weather"),null!==setting_map_weather&&(init_weather=parseInt(setting_map_weather)),setting_map_clouds=0,null!==setting_map_clouds&&(init_clouds=parseInt(setting_map_clouds)),setting_map_lightning=getSetting("map_lightning"),null!==setting_map_lightning&&(init_lightning=parseInt(setting_map_lightning)),setting_map_weather_tile_ir_satellite=getSetting("map_weather_tile_ir_satellite"),null!==setting_map_weather_tile_ir_satellite&&(weather_tile_ir_satellite=parseInt(setting_map_weather_tile_ir_satellite)),setting_map_weather_tile_global_radar=getSetting("map_weather_tile_global_radar"),null!==setting_map_weather_tile_global_radar&&(weather_tile_global_radar=parseInt(setting_map_weather_tile_global_radar)),setting_map_weather_tile_air_sigmets=getSetting("map_weather_tile_air_sigmets"),null!==setting_map_weather_tile_air_sigmets&&(weather_tile_air_sigmets=parseInt(setting_map_weather_tile_air_sigmets)),setting_map_weather_tile_volcanic_eruptions=getSetting("map_weather_tile_volcanic_eruptions"),null!==setting_map_weather_tile_volcanic_eruptions&&(weather_tile_volcanic_eruptions=parseInt(setting_map_weather_tile_volcanic_eruptions)),setting_map_weather_tile_sigwx_high=getSetting("map_weather_tile_sigwx_high"),null!==setting_map_weather_tile_sigwx_high&&(weather_tile_sigwx_high=parseInt(setting_map_weather_tile_sigwx_high)),setting_map_weather_tile_lightning_heat_map=getSetting("map_weather_tile_lightning_heat_map"),null!==setting_map_weather_tile_lightning_heat_map&&(weather_tile_lightning_heat_map=parseInt(setting_map_weather_tile_lightning_heat_map)),setting_map_weather_tile_precipitation_rate_forcast=getSetting("map_weather_tile_precipitation_rate_forecast"),null!==setting_map_weather_tile_precipitation_rate_forcast&&(weather_tile_precipitation_rate_forcast=parseInt(setting_map_weather_tile_precipitation_rate_forcast)),setting_map_weather_tile_wind_speed=getSetting("map_weather_tile_wind_speed"),null!==setting_map_weather_tile_wind_speed&&(weather_tile_wind_speed=-1!==setting_map_weather_tile_wind_speed.indexOf("gfs")?1:0),setting_map_precipitations=getSetting("map_precipitations"),null!==setting_map_precipitations&&(init_precipitations=parseInt(setting_map_precipitations)),setting_map_pressure=getSetting("map_pressure"),null!==setting_map_pressure&&(init_pressure=parseInt(setting_map_pressure)),setting_map_snow=getSetting("map_snow"),null!==setting_map_snow&&(init_snow=parseInt(setting_map_snow)),setting_map_wind_temp=getSetting("map_wind_temp"),null!==setting_map_wind_temp&&("temp"==setting_map_wind_temp?init_temp=1:"wind"==setting_map_wind_temp&&(init_wind=1));var e=getSetting("clock_local"),t=getSetting("clock_12h");if(""===t){var a=navigator.language||navigator.userLanguage;init_clock_12h="en-US"==a||"en-CA"==a?1:0}else init_clock_12h=t;if(init_clock_local=null===e?1:e,setting_unit_speed=getSetting("unit_speed"),null!==setting_unit_speed&&(init_unit_speed=setting_unit_speed,updateSliderUnits()),setting_unit_temp=getSetting("unit_temp"),null!==setting_unit_temp&&(init_unit_temp=setting_unit_temp),setting_unit_alt=getSetting("unit_alt"),null!==setting_unit_alt&&(init_unit_alt=setting_unit_alt,updateSliderUnits()),setting_unit_dist=getSetting("unit_dist"),null!==setting_unit_dist&&(init_unit_dist=setting_unit_dist),setting_map_track_tooltip=getSetting("map_track_tooltip"),null!==setting_map_track_tooltip&&"function"==typeof window.get_navdata&&(init_track_tooltip=parseInt(setting_map_track_tooltip)),setting_map_tracks=getSetting("map_tracks"),null!==setting_map_tracks&&"function"==typeof window.get_navdata&&(1===(init_tracks=parseInt(setting_map_tracks))?fr24Tracks.loadTracks():fr24Tracks.removeTracks()),setting_map_atc=getSetting("map_atc"),null!==setting_map_atc&&"function"==typeof window.get_navdata&&(1===(init_atc=parseInt(setting_map_atc))?setTimeout(function(){loadATC()},200):setTimeout(function(){removeATC()},300)),setting_map_navdata=getSetting("map_navdata"),null!==setting_map_navdata&&"function"==typeof window.get_navdata&&("none"!==(init_navcharts=setting_map_navdata)?setTimeout(function(){navdataLayer=new NavDataLayer,navdataLayer.createLayer(setting_map_navdata)},200):setTimeout(function(){navdataLayer&&navdataLayer.removeLayer()},300)),setting_menu_stats=getSetting("menu_stats"),null!==setting_menu_stats&&(init_menu_stats=parseInt(setting_menu_stats),toggleStats("aircraft")),setting_menu_stats_status=getSetting("menu_stats_status"),null!==setting_menu_stats_status&&(init_menu_stats_status=parseInt(setting_menu_stats_status),showLeftMenuItem($("#menuStats a.menuChoice"))),setting_menu_delay_stats_continent=getSetting("menu_delay_stats_continent"),null!==setting_menu_delay_stats_continent&&("function"==typeof window.get_navdata?init_menu_delay_stats_continent=parseInt(setting_menu_delay_stats_continent):(init_menu_delay_stats_continent=0,setSetting("menu_delay_stats_continent",0,365)),toggleStats("delay")),-1!=init_menu_delay_stats_continent&&void 0!==angular.element("#menuAirportStats").scope()&&angular.element("#menuAirportStats").scope().fetchStats(),setting_menu_delay_stats_status=null===getSetting("menu_delay_stats_status")?1:getSetting("menu_delay_stats_status"),null!==setting_menu_delay_stats_status&&(init_setting_menu_delay_stats_status=parseInt(setting_menu_delay_stats_status),showLeftMenuItem($("#menuAirportStats a.menuChoice"))),setting_menu_socialmedia=getSetting("menu_socialmedia"),null!==setting_menu_socialmedia&&"function"==typeof window.get_navdata?(init_menu_socialmedia=parseInt(setting_menu_socialmedia),toggleSocialMedia()):null===setting_menu_socialmedia&&setSetting("menu_socialmedia",1,365),setting_menu_twitter=getSetting("menu_twitter"),null!==setting_menu_twitter&&"function"==typeof window.get_navdata?(init_menu_twitter=parseInt(setting_menu_twitter),toggleTwitter()):null===setting_menu_twitter&&setSetting("menu_twitter",1,365),setting_menu_blog=getSetting("menu_blog"),null!==setting_menu_blog&&"function"==typeof window.get_navdata?(init_menu_blog=parseInt(setting_menu_blog),toggleBlog()):null===setting_menu_blog&&setSetting("menu_blog",1,365),setting_menu_twitter_status=getSetting("menu_twitter_status"),null!==setting_menu_twitter_status?(init_menu_twitter_status=parseInt(setting_menu_twitter_status),showLeftMenuItem($("#menuTwitter h5"))):showLeftMenuItem($("#menuTwitter h5")),setting_menu_blog_status=getSetting("menu_blog_status"),null!==setting_menu_blog_status?(init_menu_blog_status=parseInt(setting_menu_blog_status),showLeftMenuItem($("#menuBlog h5"))):showLeftMenuItem($("#menuBlog h5")),setting_map_left_menu_view=getSetting("map_left_menu_view"),null!==setting_map_left_menu_view){var i=(map_left_menu_view=setting_map_left_menu_view).replace("View","");if("airport"===i){var l=getSetting("airportViewAirport");angular.element("#fr24_ViewsDropdown").scope().openAirportView(l)}else i=$("#fr24_ViewsDropdown a[data-value='"+i+"']"),angular.element(i).triggerHandler("click");"airport"!==i&&"fleet"!==i||angular.element($("#fr24_ViewsDropdownContainer")).triggerHandler("click")}else $("#leftCol #mapView").show();setting_map_fullscreen_view=getSetting("map_fullscreen_view"),null!==setting_map_fullscreen_view&&1==(map_fullscreen_view=setting_map_fullscreen_view)&&$("#fr24_Fullscreen a").trigger("click"),setting_filter_selective_unblocking=getSetting("filter_selective_unblocking"),null!==setting_filter_selective_unblocking&&(selective_unblocking=setting_filter_selective_unblocking,$.each(selective_unblocking,function(e,t){$("#selective_unblocking input[data-value='"+t+"']").prop("checked",!0)}),NavigationManager&&"function"==typeof NavigationManager.renderFilterPopup&&NavigationManager.renderFilterPopup())}function initialize_map(){function e(e){this.tileSize=e}convertAircraftTypeAssignmentList();var t=[{featureType:"administrative",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"administrative",elementType:"geometry.fill",stylers:[{visibility:"off"}]},{featureType:"administrative.country",elementType:"geometry.stroke",stylers:[{visibility:"on"},{color:"#ffffff"}]},{featureType:"administrative.province",elementType:"geometry.stroke",stylers:[{visibility:"off"}]},{featureType:"landscape",elementType:"geometry",stylers:[{visibility:"on"},{color:"#e5e3df"}]},{featureType:"landscape.natural",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"transit.line",elementType:"geometry",stylers:[{visibility:"off"}]},{featureType:"transit.line",elementType:"labels.text",stylers:[{visibility:"off"}]},{featureType:"transit.station.airport",elementType:"geometry",stylers:[{visibility:"off"}]},{featureType:"transit.station.airport",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#c9c9c9"}]},{featureType:"water",elementType:"labels",stylers:[{visibility:"off"}]}],a=[{featureType:"landscape",elementType:"all",stylers:[{saturation:-100},{lightness:-20}]},{featureType:"water",elementType:"all",stylers:[{saturation:-100},{lightness:70}]},{featureType:"road",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"administrative",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"poi",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"all",stylers:[{visibility:"off"}]}],l=[{featureType:"landscape",elementType:"all",stylers:[{hue:"#1e85ae"},{saturation:-20},{lightness:-40}]},{featureType:"water",elementType:"all",stylers:[{hue:"#203c4a"},{saturation:-70},{lightness:-60}]},{featureType:"water",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"administrative",elementType:"geometry",stylers:[{visibility:"off"}]},{featureType:"poi",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"transit.station.airport",elementType:"all",stylers:[{visibility:"on"},{hue:"#203c4a"},{saturation:-10},{lightness:0}]},{featureType:"administrative.country",elementType:"geometry.stroke",stylers:[{visibility:"on"},{hue:"#0091ff"},{saturation:35},{lightness:60},{weight:1}]}],r=[{stylers:[{visibility:"off"}]},{featureType:"landscape",stylers:[{visibility:"on"}]},{featureType:"administrative",stylers:[{visibility:"on"}]},{featureType:"poi",stylers:[{visibility:"on"}]},{featureType:"road",stylers:[{visibility:"on"}]},{featureType:"transit",stylers:[{visibility:"on"}]},{featureType:"water",stylers:[{visibility:"on"}]},{featureType:"all",elementType:"labels.text.fill",stylers:[{saturation:36},{color:"#000000"},{lightness:40}]},{featureType:"all",elementType:"labels.text.stroke",stylers:[{visibility:"on"},{color:"#000000"},{lightness:16}]},{featureType:"all",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"administrative",elementType:"geometry.fill",stylers:[{color:"#000000"},{lightness:20},{visibility:"off"}]},{featureType:"administrative",elementType:"geometry.stroke",stylers:[{color:"#6d6d6d"},{lightness:17},{weight:1.2}]},{featureType:"administrative",elementType:"labels.text",stylers:[{color:"#fbc339"}]},{featureType:"administrative",elementType:"labels.text.stroke",stylers:[{visibility:"off"}]},{featureType:"landscape",elementType:"geometry",stylers:[{color:"#000000"},{lightness:20}]},{featureType:"landscape",elementType:"geometry.fill",stylers:[{color:"#424a50"},{visibility:"on"}]},{featureType:"landscape",elementType:"labels.text",stylers:[{color:"#343b40"},{visibility:"off"}]},{featureType:"landscape.natural.terrain",elementType:"geometry.fill",stylers:[{color:"#343b40"}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#000000"},{lightness:21}]},{featureType:"poi",elementType:"geometry.fill",stylers:[{color:"#35383c"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#0f252e"},{lightness:17}]},{featureType:"water",elementType:"geometry.fill",stylers:[{color:"#7f8e98"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#3f4c55"}]},{featureType:"water",elementType:"labels.text.stroke",stylers:[{visibility:"off"}]},{featureType:"all",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"administrative",elementType:"geometry.stroke",stylers:[{visibility:"off"}]},{featureType:"administrative.country",elementType:"geometry.stroke",stylers:[{visibility:"on"}]},{featureType:"transit.line",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"transit.station.airport",elementType:"geometry.fill",stylers:[{invert_lightness:!1},{saturation:-100},{lightness:0},{gamma:.5},{hue:"#A4A1A1"}]}],n=[{elementType:"geometry",stylers:[{color:"#1d2c4d"}]},{elementType:"labels.text.fill",stylers:[{color:"#8ec3b9"}]},{elementType:"labels.text.stroke",stylers:[{color:"#1a3646"}]},{featureType:"administrative.country",elementType:"geometry.stroke",stylers:[{color:"#4b6878"}]},{featureType:"administrative.land_parcel",elementType:"labels.text.fill",stylers:[{color:"#64779e"}]},{featureType:"administrative.province",elementType:"geometry.stroke",stylers:[{color:"#4b6878"}]},{featureType:"landscape.man_made",elementType:"geometry.stroke",stylers:[{color:"#334e87"}]},{featureType:"landscape.natural",elementType:"geometry",stylers:[{color:"#023e58"}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#283d6a"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#6f9ba5"}]},{featureType:"poi",elementType:"labels.text.stroke",stylers:[{color:"#1d2c4d"}]},{featureType:"poi.park",elementType:"geometry.fill",stylers:[{color:"#023e58"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#3C7680"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#304a7d"}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{color:"#98a5be"}]},{featureType:"road",elementType:"labels.text.stroke",stylers:[{color:"#1d2c4d"}]},{featureType:"road",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#2c6675"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#255763"}]},{featureType:"road.highway",elementType:"labels.text.fill",stylers:[{color:"#b0d5ce"}]},{featureType:"road.highway",elementType:"labels.text.stroke",stylers:[{color:"#023e58"}]},{featureType:"transit",elementType:"labels.text.fill",stylers:[{color:"#98a5be"}]},{featureType:"transit",elementType:"labels.text.stroke",stylers:[{color:"#1d2c4d"}]},{featureType:"transit.line",elementType:"geometry.fill",stylers:[{color:"#283d6a"}]},{featureType:"transit.station",elementType:"geometry",stylers:[{color:"#3a4762"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#0e1626"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#4e6d70"}]}],s=getCookie("_frPl");cookie_enc=s&&""!==$.trim(s)&&"empty"!==$.trim(s)?s:null;var o=getCookie("_frPubKey");if("undefined"!=typeof dispatcher&&"undefined"!==o&&null!==o&&""!==$.trim(o)&&"empty"!==$.trim(o)&&(cookie_pubkey=o),0==simple_mode?(init_labels=1==parseInt(getSetting("map_labels"))?1:0,show_labels=init_labels,1==init_labels&&(init_label_2="",init_label_3="",setting_map_label_1=getSetting("map_label_1"),setting_map_label_2=getSetting("map_label_2"),setting_map_label_3=getSetting("map_label_3"),setting_map_label_4=getSetting("map_label_4"),null!==setting_map_label_1&&(init_label_1=setting_map_label_1),null!==setting_map_label_2&&(init_label_2=setting_map_label_2),null!==setting_map_label_3&&(init_label_3=setting_map_label_3),null!==setting_map_label_4&&(init_label_4=setting_map_label_4))):show_labels=init_labels,init_label_bkg=getSetting("map_label_bkg"),0==init_label_bkg&&$("body").addClass("hide-label-bkg"),setting_enable_filters=getSetting("map_enable_filters"),enable_filters=null!=setting_enable_filters&&1==setting_enable_filters?1:0,setting_enable_unblock_filters=getSetting("map_enable_unblock_filters"),null!=setting_enable_unblock_filters&&(init_unblock_filters=1==setting_enable_unblock_filters?1:0),setting_animate_aircraft=getSetting("animate_aircraft"),null!=setting_animate_aircraft?init_anim=1==setting_animate_aircraft?1:0:setSetting("animate_aircraft",init_anim,365),setting_ground_traffic=getSetting("show_ground_traffic"),null!=setting_ground_traffic&&(ground_traffic=1==setting_ground_traffic?1:0),setting_vehicular_traffic=getSetting("show_vehicles"),null!=setting_vehicular_traffic&&(vehicular_traffic=1==setting_vehicular_traffic?1:0),setting_glider_traffic=getSetting("show_gliders"),null!=setting_glider_traffic&&(glider_traffic=1==setting_glider_traffic?1:0),setting_airborn_traffic=getSetting("show_airborn_traffic"),null!=setting_airborn_traffic&&(airborn_traffic=1==setting_airborn_traffic?1:0),setting_faa_traffic=getSetting("show_faa_traffic"),null!=setting_faa_traffic&&(faa_traffic=1==setting_faa_traffic?1:0),setting_mlat_traffic=getSetting("show_mlat_traffic"),mlat_traffic=null!=setting_mlat_traffic?parseInt(setting_mlat_traffic):1,setting_adsb_traffic=getSetting("show_adsb_traffic"),null!=setting_adsb_traffic&&(adsb_traffic=1==setting_adsb_traffic?1:0),setting_flarm_traffic=getSetting("show_flarm_traffic"),null!=setting_flarm_traffic&&(flarm_traffic=1==setting_flarm_traffic?1:0),setting_estimated_traffic=getSetting("show_estimated_traffic"),null!=setting_estimated_traffic&&(estimated_traffic=parseInt(setting_estimated_traffic)),setting_ash_clouds=getSetting("map_ash_clouds"),init_ash_clouds=null!=setting_ash_clouds?parseInt(setting_ash_clouds):1,setting_map_type=getSetting("map_type"),null!==setting_map_type&&(init_type=setting_map_type.split('"').join("")),setting_map_fade=getSetting("map_fade"),null!==setting_map_fade&&(init_fade=parseInt(setting_map_fade)),setting_map_aircraft_size=getSetting("map_aircraft_size"),setting_map_aircraft_size==parseInt(setting_map_aircraft_size)&&(setting_map_aircraft_size="auto",getSetting("map_aircraft_size","auto")),null!==setting_map_aircraft_size&&(init_aircraft_size=setting_map_aircraft_size),setting_map_airports=getSetting("map_airports"),null!==setting_map_airports&&(init_airports=parseInt(setting_map_airports)),setting_map_airport_density=getSetting("map_airport_density"),null!==setting_map_airport_density&&(init_airport_density=parseInt(setting_map_airport_density)),setting_map_sidemenu_photo_hide=getSetting("map_sidemenu_photo_hide"),null!==setting_map_sidemenu_photo_hide?(init_sidemenu_photo_hide=parseInt(setting_map_sidemenu_photo_hide),toggleAircraftPhoto()):null===setting_map_sidemenu_photo_hide&&setSetting("map_sidemenu_photo_hide",0,365),setting_map_nite=getSetting("map_night"),null!==setting_map_nite&&(init_nite=parseInt(setting_map_nite)),1==simple_mode&&(sidebar_closed=1),setting_map_topbar=getSetting("map_topbar"),null!==setting_map_topbar&&0===(init_topbar=parseInt(setting_map_topbar))&&setSetting("map_topbar",init_topbar=1,365),1!=simple_mode&&0==init_filter_check&&(init_filter_check=1,null!==(init_filter=getSetting("map_filter"))&&""!=init_filter)){var c=init_filter.split("/a/");for(i=0;i<c.length;i++)if(""!=c[i]){var p=c[i].split("/b/");filters.push([p[0],p[1],p[2]])}}initSettings(),showLeftOverlay=isMapView();$("#leftColOverlay");1==simple_mode?(get_querystrings_simple(),loadFullFeed=!0):get_querystrings(),query_callsign.length>1&&(1!=init_follow||multi_select_mode||(follow_aircraft=1),init_call=query_callsign,query_callsign=""),setting_lat=getSetting("map_lat"),setting_lon=getSetting("map_lon"),setting_zoom=getSetting("map_zoom"),get_querystrings(),parseFloat(query_lat)&&parseFloat(query_lon)&&parseFloat(query_z)&&query_lon>-180&&query_lon<180&&query_z<=16&&query_z>1?(init_lat=query_lat,init_lon=query_lon,init_zoom=parseInt(query_z),setting_lat=init_lat,setting_lon=init_lon,setting_zoom=init_zoom):null!==setting_lat||null!==setting_lon||null!==setting_zoom?(init_lat=setting_lat,init_lon=setting_lon,init_zoom=parseInt(setting_zoom,10)||6):(geolocation_move=!0,$.ajax({url:"//freegeoip.net/json/",dataType:"json",timeout:7e3,error:function(e,t,a){}}).done(function(e){moveMap(e.latitude,e.longitude,7)})),cookie_law_consent=getCookie("cookie_law_consent"),weather_data_consent=getCookie("weather_data_consent");var _=new google.maps.LatLng(init_lat,init_lon);if(google.maps.visualRefresh=!0,1==simple_mode)d={zoom:init_zoom,center:_,backgroundColor:"#333333",zoomControl:!0,zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL,position:google.maps.ControlPosition.TOP_LEFT},panControl:!1,streetViewControl:!1,navigationControlOptions:{position:google.maps.ControlPosition.TOP_RIGHT},mapTypeControl:!1,clickableLabels:!1,clickableIcons:!1,gestureHandling:"greedy"};else var d={minZoom:2,zoom:init_zoom,center:_,backgroundColor:"#333333",zoomControl:!1,panControl:!1,scaleControl:!0,scaleControlOptions:{position:google.maps.ControlPosition.BOTTOM_RIGHT},streetViewControl:!1,mapTypeControl:!1,clickableLabels:!1,clickableIcons:!1,gestureHandling:"greedy"};if((map=new google.maps.Map(document.getElementById("map_canvas"),d)).addListener("dblclick",function(e){isMapDblClick=!0,setTimeout(function(){isMapDblClick=!1},500)}),map.addListener("click",function(e){setTimeout(function(){isMapDblClick||(close_aircraft_data(),remove_all_labels(!0),isMapDblClick=!1,Fr24&&Fr24.AirportPanel&&Fr24.AirportPanel.isOpen()&&Fr24.AirportPanel.close())},500)}),map.panToOffsetted=function(e){var t=parseInt($(window).outerWidth())/2,a=isMapPannable()?parseInt($("#"+map_left_menu_view).outerWidth()):0,i=getOffsetCenter(a+(parseInt($(window).outerWidth())-a)/2-t,0,e);i?map.panTo(i):setTimeout(function(){map.panToOffsetted(e)},1e3)},infowindow=new google.maps.InfoWindow({maxWidth:300}),"undefined"!=typeof nite&&(nite.init(map),1==init_nite?(nite.show(),nite_initialised=1):(nite.hide(),nite_initialised=0),setInterval(function(){nite.refresh()},1e4)),map.mapTypes.set("simple_style",new google.maps.StyledMapType(a,{name:"Grayscale"})),map.mapTypes.set("radar_style",new google.maps.StyledMapType(l,{name:"Radar (blue)"})),map.mapTypes.set("radar_style2",new google.maps.StyledMapType(r,{name:"Radar (dark)"})),map.mapTypes.set("gray_style",new google.maps.StyledMapType(t,{name:"Simple gray"})),map.mapTypes.set("aubergine_style",new google.maps.StyledMapType(n,{name:"Aubergine"})),"delayView"===map_left_menu_view?map.setMapTypeId("gray_style"):map.setMapTypeId(init_type),mapCanvasStub=function(e){this.setMap(e)},mapCanvasStub.prototype=new google.maps.OverlayView,mapCanvasStub.prototype.draw=function(){},mapCanvasStub=new mapCanvasStub(map),spriteIcons={airport:{anchor:new google.maps.Point(8,20),origin:new google.maps.Point(0,0),scaledSize:new google.maps.Size(18,18),size:new google.maps.Size(20,20),url:dispatcher.urls.static+"/images/airport_pin_40_blue.png"},route:{anchor:new google.maps.Point(8,20),origin:new google.maps.Point(0,0),scaledSize:new google.maps.Size(18,18),size:new google.maps.Size(20,20),url:dispatcher.urls.static+"/images/airport_pin_40_yellow.png"},selected:{anchor:new google.maps.Point(8,20),origin:new google.maps.Point(0,0),scaledSize:new google.maps.Size(18,18),size:new google.maps.Size(20,20),url:dispatcher.urls.static+"/images/airport_pin_40_red.png"},cache:{}},e.prototype.getTile=function(e,t,a){var i=a.createElement("DIV");return $(i).css({width:this.tileSize.width+"px",height:this.tileSize.height+"px",opacity:init_fade/100,"background-color":"#000"}).addClass("map-opacity-overlay"),i},map.overlayMapTypes.insertAt(0,new e(new google.maps.Size(256,256))),"1"==init_ash_clouds&&get_ash_layer(),google.maps.event.addListener(map,"bounds_changed",function(){if(currentZoom=map.zoom,"NULL"!==selected_aircraft){var e=tooltipRadius[map.getZoom()];for(i=0;i<polyPointCircles.length;i++)polyPointCircles[i].setRadius(e)}}),google.maps.event.addListenerOnce(map,"projection_changed",function(){"selected"===init_goto_aircraft?goToAircraft(selected_aircraft,!0):"query_callsign"===init_goto_aircraft&&goToAircraft(init_call),"1"==init_lightning&&(lightningLayer=lightningLayer||new LightningLayer,!playback_mode&&lightningLayer.initializeLightning()),"1"==init_weather&&"undefined"!=typeof WeatherLayer&&(weatherLayer=weatherLayer||new WeatherLayer,!playback_mode&&weatherLayer.initializeWeather(map)),$("div.weather-tile.on").each(function(e,t){var a=$(t).hasClass("on");HandleWeatherTileChange($(t).data("source"),a)}),fetch_airport_list(),0!=playback_mode&&1!=query_single&&($("#fr24_ViewsDropdown a[data-value='delay'], #fr24_ViewsDropdown a[data-value='airport']").parent().addClass("notAllowed"),-1!==$.inArray(map_left_menu_view,["delayView","airportView"])&&($('#fr24_ViewsDropdown li a[data-value="map"]').trigger("click"),map_left_menu_view="mapView"),fetch_playback_list())}),0==simple_mode){google.maps.event.addListener(map,"maptypeid_changed",function(){"delayView"!==map_left_menu_view&&setSetting("map_type",map.mapTypeId,365)}),mapInitListener=google.maps.event.addListener(map,"tilesloaded",function(){"object"==typeof b2bSidebar&&b2bSidebar.onMapLoad(),dispatcher.isInEurope&&"1"!=cookie_law_consent&&displayCookieMsg(),google.maps.event.removeListener(mapInitListener),setTimeout(function(){"NULL"==selected_aircraft?getMapControl("logo").css("margin-left","212px"):getMapControl("logo").css("margin-left","266px")},500),g_hasAC&&1==sidebar_closed&&setTimeout("closeSidebar();",500)})}google.maps.event.addListener(map,"idle",function(){0==follow_aircraft&&(1===playback_play&&playback_queue.length>0?(clearTimeout(aInterval),aInterval=!1,playback_queue=[]):feed_fetch_timeout=setTimeout(function(){fetch_plane_list()},1e3)),update_planes(1),historyReplaceState()}),google.maps.event.addListener(map,"dragstart",function(){init_anim=0,clearTimeout(aInterval),clearTimeout(feed_fetch_timeout)});var f;google.maps.event.addListener(map,"dragend",function(){isDragged=!0,1==follow_aircraft&&(follow_aircraft=0,$("a#follow-aircraft, #btn-aircraft-action-follow").removeClass("active")),$("body.mobile").length&&checkSidebarState(),multi_select_mode&&remove_all_labels_multi(!0),clearTimeout(f),f=setTimeout(function(){getSetting("animate_aircraft")&&(init_anim=1,animate()),1==playback_play&&("NULL"==selected_aircraft&&remove_polylines(),delete_all_labels(),playback_fetch_time=0,clearTimeout(preFetchInterval),preFetchInterval=!1,clearTimeout(aInterval),aInterval=!1,playback_change_fetch_time())},100)});var u;google.maps.event.addListener(map,"zoom_changed",function(){init_anim=0,clearTimeout(feed_fetch_timeout),clearTimeout(u),clearTimeout(aInterval),u=setTimeout(function(){getSetting("animate_aircraft")&&(init_anim=1,animate()),1==playback_play&&("NULL"==selected_aircraft&&remove_polylines(),delete_all_labels(),playback_fetch_time=0,clearTimeout(preFetchInterval),preFetchInterval=!1,clearTimeout(aInterval),aInterval=!1,playback_change_fetch_time())},100),1==follow_aircraft&&(clearTimeout(fetchInterval),fetchInterval=setTimeout(fetch_plane_list,1e3))}),google.maps.event.addListener(map,"center_changed",function(){var e=map.getBounds();if(e){var t,a=e.getNorthEast().lat(),i=e.getSouthWest().lat();if(a<85&&i>-85)return;if(a>85&&i<-85)return;if(a>85&&(t=map.getCenter().lat()-(a-85)),i<-85&&(t=map.getCenter().lat()-(i+85)),t){var l=new google.maps.LatLng(t,map.getCenter().lng());map.setCenter(l)}}}),""!=query_pb_date&&""!=query_pb_time&&(playback_mode=1,playback_play=1==simple_mode?0:1,1==query_solo&&(playback_play=0),playback_time=new Date(query_pb_date.substr(5,2)+"/"+query_pb_date.substr(8,2)+"/"+query_pb_date.substr(0,4)+" "+query_pb_time+":00"),playbackStep=1,$("#playbackChoice, #playbackStatus").html(playback_time.getFullYear()+"-"+add_zero(playback_time.getMonth()+1)+"-"+add_zero(playback_time.getDate())+" "+add_zero(playback_time.getHours())+":"+add_zero(playback_time.getMinutes())),updateTimeWidget(add_zero(playback_time.getHours())+add_zero(playback_time.getMinutes())),$("#playback-step-back").attr("disabled",!0),$("#playback-step-forward").attr("disabled",!0),1==simple_mode?($("#playback-pause").removeClass("play").removeClass("pause").addClass("play"),$("#playback-step-back").attr("disabled",!1),$("#playback-step-forward").attr("disabled",!1),$("span#playback-date").html(timeline_options.DAYS_SHORT[playback_time.getDay()]+", "+timeline_options.MONTHS_SHORT[playback_time.getMonth()]+" "+playback_time.getDate()+", "+playback_time.getFullYear()+", "+add_zero(playback_time.getHours())+":"+add_zero(playback_time.getMinutes()))):$("#playback-pause").removeClass("play").addClass("pause"),window.busMan&&window.busMan.hideMapAds(),$("#playbackControlsOverlay").show(),drawPlaybackTimeline(),$(".aircraft_marker.active .aircraft_label_container").remove(),clearTimeout(fetchInterval),clearTimeout(timeInterval),query_pb_date="",query_pb_time=""),-1==dispatcher.userFeatures["map.timeout.mins"]||"undefined"!=typeof _initBlackout&&1!=_initBlackout||(idleTimeout=setTimeout(exit_map,60*parseInt(dispatcher.userFeatures["map.timeout.mins"])*1e3)),setTimeout(updateUserFeatures,3e5),"object"==typeof b2bSidebar&&(b2bSidebar.onMapLoad(),clearTimeout(idleTimeout)),$("div#preload-active").addClass("aircraft_marker").addClass("auto"==init_aircraft_size?"normal":init_aircraft_size).addClass("active"),setTimeout(function(){void 0===plane_list&&google.maps.event.trigger(map,"projection_changed")},3e3),multiSelectTimeout=null,multiSelectTimeoutFunction=function(){clearTimeout(multiSelectTimeout),map&&plane_list&&Object.keys(plane_list).length>0?$.each(selected_aircraft_array,function(e,t){if(t&&void 0!==plane_list[t]&&null!=plane_list[t])selected_aircraft=t,show_aircraft_data(t),query_flight_data(t),add_label(t);else{var a=$.inArray(t,selected_aircraft_array);selected_aircraft_array.splice(a,1)}}):multiSelectTimeout=setTimeout(multiSelectTimeoutFunction,1e3)},selected_aircraft_array.length>0&&(map.setZoom(2),multiSelectTimeout=setTimeout(multiSelectTimeoutFunction,3e3))}function getOffsetCenter(e,t,a){if(!map.getProjection())return null;var a=void 0!==a?a:map.getCenter(),i=Math.pow(2,map.getZoom()),l=map.getProjection().fromLatLngToPoint(a),r=new google.maps.Point(e/i||0,t/i||0),n=new google.maps.Point(l.x-r.x,l.y+r.y);return map.getProjection().fromPointToLatLng(n)}function pointToLatLng(e){var t=map.getProjection().fromLatLngToPoint(map.getBounds().getNorthEast()),a=map.getProjection().fromLatLngToPoint(map.getBounds().getSouthWest()),i=Math.pow(2,map.getZoom()),l=new google.maps.Point(e.x/i+a.x,e.y/i+t.y);return map.getProjection().fromPointToLatLng(l)}function getAvailableBound(e){var t=pointToLatLng(new google.maps.Point($("#"+e).outerWidth(),$(window).outerHeight())),a=pointToLatLng(new google.maps.Point($(window).outerWidth(),0));return new google.maps.LatLngBounds(t,a)}function fetch_airport_list(){return nav_list.airport.length||(version=0,!1!==supportsLocalStorage()&&void 0!==localStorage.airportListUpdated&&(version=parseInt(localStorage.airportListUpdated)),(version<(new Date).getTime()-1728e5||version<1462793230943)&&(version=0),version<(new Date).getTime()-864e5?$.getJSON(dispatcher.urls.site+"/airports/list?version="+version,function(e){return!1!==supportsLocalStorage()?void 0!==e.isUpToDate&&!0===e.isUpToDate?cb_airport_list(JSON.parse(localStorage.airportList)):(localStorage.airportList=JSON.stringify(e),localStorage.airportListUpdated=(new Date).getTime(),cb_airport_list(e)):cb_airport_list(e),!0}).fail(function(){return!1}):cb_airport_list(JSON.parse(localStorage.airportList))),!0}function cb_airport_list(e){var t=0;nav_list.airport=[];for(var a in e)nav_list.airport.push({id:e[a][0],icao:e[a][1],pos:new google.maps.LatLng({lat:e[a][3],lng:e[a][4]}),title:e[a][2]+" ("+e[a][1]+"/"+e[a][0]+")",size:e[a][6],marker:null}),airport_index[e[a][1]]=nav_list.airport[t++],""!=query_airport&&e[a][1]==query_airport&&(query_airport="",geolocation_move=!1,map.setCenter(new google.maps.LatLng({lat:e[a][3],lng:e[a][4]})),map.setZoom(10));nav_list.airport.sort(function(e,t){return e.size<t.size?e.size==t.size?0:1:-1}),"function"==typeof window.get_navdata?get_navdata():update_static_pins(),query_airport="",query_airportInfo=0}function fetch_plane_list(e){if(pauseFeed||!0===map_delays_mode||!0===$("#disable-page-text").is(":visible")||void 0===map||$("#mapDynamicOverlays").children(":visible").length>0)return!0;var t=Date.now();if(!(!e&&feed_queued&&feed_queued>t-2*feed_request_slam_ms)){feed_queued=0;var a=map.getBounds(),i=mapCanvasStub.getProjection();if(void 0===a||void 0===i)return clearTimeout(fetchInterval),fetchInterval=setTimeout(fetch_plane_list,500),!1;if(update_static_pins(a),feed_request_time_ms>t-feed_request_slam_ms)return feed_queued=t,clearTimeout(fetchInterval),void(fetchInterval=setTimeout(function(){fetch_plane_list(!0)},feed_request_slam_ms-(t-feed_request_time_ms)));feed_request_time_ms=t;var l=a.getNorthEast(),r=a.getSouthWest(),n=override_filters(),s=0,o=0,c=map.getZoom(),p=1;c>10&&(p=20*(c-10));var _=i.fromContainerPixelToLatLng(new google.maps.Point(10,-10)),d=_.lat()-l.lat(),f=_.lng()-r.lng();1!=sidebar_closed&&window.clientWidth>550&&(s=20*f),1==init_topbar&&(o=5.6*d),d*=p,f*=p;var u;u=n?"1&maxage=14400":estimated_traffic>0?"1&maxage="+60*estimated_traffic:"0&maxage=0";var m="/zones/fcgi/feed.js?bounds="+(l.lat()+d-o).toFixed(2)+","+(r.lat()-d).toFixed(2)+","+(r.lng()-f+s).toFixed(2)+","+(l.lng()+f).toFixed(2)+"&faa="+(1==faa_traffic||n?1:0)+"&mlat="+(1==mlat_traffic||n?1:0)+"&flarm="+(1==flarm_traffic||n?1:0)+"&adsb="+(1==adsb_traffic||n?1:0)+"&gnd="+(1==ground_traffic?1:0)+"&air="+(1===airborn_traffic?1:0)+"&vehicles="+(1===vehicular_traffic?1:0)+"&estimated="+u+"&gliders="+(1===glider_traffic?1:0)+"&stats=1";(null!==selected_aircraft&&"NULL"!==selected_aircraft||selected_aircraft_array.length>0)&&(m+="&selected="+(selected_aircraft_array.length>0?selected_aircraft_array.join(","):selected_aircraft),m+="&ems=1"),cookie_enc&&(m+="&enc="+cookie_enc),null!==selected_airline&&(m+="&airline="+selected_airline);var g=build_filter_params();g&&(m+="&"+g),"init"===feed_state&&init_call&&(m+="&filter_info=1"),m+=addPublicKey();var h="//"+dispatcher.urls.feedPlaneList;$.ajax(h+m,{type:"GET",dataType:feed_request_method,timeout:5e3}).done(function(e,t,a){feed_state="active",parse_fcgi_header(a.getResponseHeader("X-FR24-FCGI")),pd_callback(e)}).fail(function(e,t){"parsererror"===t&&"error"!==feed_state?(feed_state="error",clearTimeout(fetchInterval),fetchInterval=setTimeout(fetch_plane_list,1e3)):("init"===feed_state&&(feed_request_method="jsonp",feed_state="active"),fetch_plane_list())})}}function parse_fcgi_header(e){if(null!=e){var t=e.split("/")[3];t>=0&&t<=7&&(refresh_rate=2*(11-t))}}function pd_callback(e){plane_list_old=$.extend(!0,{},plane_list_org),planes_total=e.full_count;var t=refresh_rate;if(void 0!==e.stats&&showStats(e.stats),feed_error=0,0==playback_mode){if(delete(plane_list=e).version,delete plane_list.full_count,delete plane_list.stats,void 0!==plane_list["selected-aircraft"]&&null!==plane_list["selected-aircraft"]&&"NULL"!==selected_aircraft&&(selected_data_ems.ems=plane_list["selected-aircraft"].ems,selected_data_ems.aircraft=selected_aircraft,selected_data_ems.availability=void 0!==plane_list["selected-aircraft"]["available-ems"]?Object.keys(plane_list["selected-aircraft"]["available-ems"]):[],selected_data_ems.airspace=void 0!==plane_list["selected-aircraft"].airspace?plane_list["selected-aircraft"].airspace:"",delete plane_list["selected-aircraft"]),1!==showRoute||plane_list[selected_aircraft]||(showRoute=0),void 0!==e["selected-matched:"]&&!1===e["selected-matched:"]&&(filters.push(["showall","true",""]),displayShowAllMsg(),t=0),planes_showing=getLength(plane_list),plane_list_org=$.extend(!0,{},e),$("#map_canvas").length>0&&mapCanvasStub.getProjection()&&update_planes(),multi_select_mode&&0==init_call&&0==waiting_for_data){var a=1===force_init_call?0:1;$.each(selected_aircraft_array,function(e,t){show_aircraft_data(t,a)})}else multi_select_mode||"NULL"===selected_aircraft||0!=init_call||0!=waiting_for_data||show_aircraft_data(selected_aircraft,a=1===force_init_call?0:1);multi_select_mode?remove_all_labels_multi():remove_all_labels(),clearTimeout(fetchInterval),fetchInterval=setTimeout(fetch_plane_list,t)}}function override_filters(){for(var e=0;e<=filters.length-1;e++)if("showall"==filters[e][0]&&"true"==filters[e][1])return!0;return!1}function build_filter_params(){function e(e,t){return void 0===a[e]&&(a[e]=t,!0)}function t(t,i){return!e(t,i)&&(a[t]+=","+i,!0)}var a={};if(!0!==simple_mode&&1!==enable_filters&&!isFleetView())return"";var i=getSetting("fleetViewShowAirline");if(!isFleetView()||isFleetView()&&(!i||0==i)&&1===enable_filters)for(var l,r=0;r<=filters.length-1;r++)switch(l=filters[r][0]){case"showall":if("true"==filters[r][1])return"";break;case"aircraft":l="type";case"radar":case"callsign":case"reg":case"fleets":t(l,filters[r][1]);break;case"airport":"in"===filters[r][1]?l="to":"out"===filters[r][1]&&(l="from"),t(l,filters[r][2]);break;case"altitude":case"speed":e(l,filters[r][1]+","+filters[r][2])}if(init_unblock_filters&&$("#filter_select_all").length>0){$("#selective_unblocking input[type=checkbox]:checked").each(function(){t($(this).data("key"),$(this).data("value"))})}if(getCurrentView()){switch(map_left_menu_view){case"airportView":break;case"fleetView":if(i=$("#fleetViewShowAirline .toggle.on").length>0){var n=[],s=[];$("#fleetViewShowAirline .toggle.on").length>0&&getSetting("fleetViewAirline")&&(getSetting("fleetViewAirline").fleet&&$.each(getSetting("fleetViewAirline").fleet.split(","),function(e,t){if(e>=5)return!1;t&&$("#fleetViewShowAirline .toggle[data-value="+t+"]").hasClass("on")&&s.push(t)}),(s=s.join(","))&&e("fleets",s.toLowerCase()),getSetting("fleetViewAirline").airline&&$.each(getSetting("fleetViewAirline").airline.split(","),function(e,t){if(e>=5)return!1;t&&$("#fleetViewShowAirline .toggle[data-value="+t+"]").hasClass("on")&&n.push(t)}),(n=n.join(","))&&e("airline",n.toUpperCase()))}}}return $.param(a)}function check_filter(e,t){var a=0,l=0,r=0,n=0;if(1!==enable_filters)return!0;for(i=0;i<=filters.length-1;i++)switch(filters[i][0]){case"altitude":l=1,parseInt(t[4])>=parseInt(filters[i][1])&&parseInt(t[4])<=parseInt(filters[i][2])&&(a=1);break;case"speed":n=1,parseInt(t[5])>=parseInt(filters[i][1])&&parseInt(t[5])<=parseInt(filters[i][2])&&(r=1)}return(1!==l||0!==a)&&(1!==n||0!==r)}function renderMapPins(e,t,a){var i,l=0,r={airport:90800,route:90805};if(!t)return!1;for(var n=0;n<nav_list[e].length;n++)if(i=nav_list[e][n],(void 0===a||l<a)&&t.contains(i.pos)){if(l++,map_nav_pins[e].hasOwnProperty(i.id))continue;i.marker||(i.marker=new google.maps.Marker({iata:i.icao?i.icao.toLowerCase():null,icon:spriteIcons[e],position:i.pos,title:i.title,zIndex:r[e]}),"airport"!==e&&"route"!==e||function(e,t){google.maps.event.addListener(e,"click",function(){if(1==simple_mode)return!1;if(objSelectedAirportMarker&&objSelectedAirportMarker.setIcon(spriteIcons.airport),Fr24&&Fr24.AirportPanel&&this.iata==Fr24.AirportPanel.getCurrentAirportIata())Fr24.AirportPanel.close();else{if(-1==["mapView","multiView","delayView"].indexOf(map_left_menu_view))return!1;var t=Fr24.AirportPanel.getCurrentAirportIata();e.setIcon(spriteIcons.selected),Fr24.AirportPanel.setCurrentAirportIata(this.iata).setCurrentAirportMarker(this),Fr24.AirportPanel.isOpen()&&this.iata===t||Fr24.AirportPanel.open(dispatcher.display.isMobile?null:"arrivals"),objSelectedAirportMarker=e}})}(i.marker,i.icao.toLowerCase())),i.marker.setMap(map),map_nav_pins[e][i.id]=i.marker}else map_nav_pins[e][i.id]&&(map_nav_pins[e][i.id].setMap(null),delete map_nav_pins[e][i.id])}function clearMapPins(e){for(var t in map_nav_pins[e])map_nav_pins[e][t].setMap(null),delete map_nav_pins[e][t]}function update_static_pins(e){if("delayView"===map_left_menu_view)return!1;if(init_airports>=1||1==init_vor||1==init_ndb||1==showRoute){var t,e=e||map.getBounds();map.getZoom();if(0!=init_airports&&(1==init_airports&&(t=$("body").hasClass("mobile")?Math.min(init_airport_density,$(window).width()/10):init_airport_density),renderMapPins("airport",e,t)),1==showRoute&&null!=selected_aircraft){var a=plane_list[selected_aircraft],i=airport_index[a[11]],l=airport_index[a[12]],r=null;selected_data[selected_aircraft]&&selected_data[selected_aircraft].airport&&selected_data[selected_aircraft].airport.real&&selected_data[selected_aircraft].airport.real.code&&(r=airport_index[selected_data[selected_aircraft].airport.real.code.iata]),nav_list.route=[],i&&((i=jQuery.extend({},i)).marker=null,nav_list.route.push(i)),l&&((l=jQuery.extend({},l)).marker=null,nav_list.route.push(l)),r&&((r=jQuery.extend({},r)).marker=null,nav_list.route.push(r)),renderMapPins("route",e)}else clearMapPins("route")}}function update_planes(e){if(e&&multi_select_mode&&selected_aircraft_array.length>0&&remove_all_labels_multi(!0),multi_select_mode&&showMultiSelectRoute&&delete_all_planes(),plane_list){0==playback_mode&&(planes_array_fake={}),1==show_labels&&1==playback_mode&&delete_all_labels();var t=0,a=getLength(plane_list);if($.each(plane_list,function(e,i){t++;var l=-1!==$.inArray(e,selected_aircraft_array);if(1===showRoute&&plane_list[selected_aircraft]&&e!==selected_aircraft)return!0;if(multi_select_mode&&showMultiSelectRoute&&!l)return!0;if(!i)return!0;if(1==simple_mode&&""!=query_reg&&(i[9]==query_reg||i[9].replace("-","")==query_reg.replace("-",""))&&(show_aircraft_data(e),query_reg="",1==simple_mode&&query_z&&init_zoom?map.setZoom(init_zoom):map.setZoom(8),1==init_follow)){r=new google.maps.LatLng(i[1],i[2]);isAirportView()||(isMapPannable()?map.panToOffsetted(r):map.setCenter(r))}var r;if(planes_array[e]){if(i[1]!=planes_array[e].getPosition().lat()||i[2]!=planes_array[e].getPosition().lng()){r=new google.maps.LatLng(i[1],i[2]),planes_array[e].aircraft_track=i[3],planes_array[e].alt=i[4],planes_array[e].aircraft_type=i[8],planes_array[e].squawk=i[6],planes_array[e].radar=i[7],void 0===i[16]||0==i[16].length?planes_array[e].callsign="nocallsign_":planes_array[e].callsign=i[16],(0==a_active||1==playback_mode&&0==playback_play)&&planes_array[e].setPosition(r);var n=0;if((e==selected_aircraft||e==current_hover||l)&&(n=1),planes_array[e].setIcon(get_sprite(i[8],i[3],n,i[6],i[7],i[16])),planes_array[e].setZIndex(2e3*Math.ceil(i[4]/2e3)+t),1==show_labels&&a<=intAircraftLimitForLabel&&!planes_array[e].label&&(planes_array[e].label=new CustomLabel(r,map,e)),1==show_labels&&a<=intAircraftLimitForLabel&&planes_array[e].label&&!showMultiSelectRoute&&0==showRoute&&e!=selected_aircraft&&!l?$(planes_array[e].label.div_).show():planes_array[e].label&&$(planes_array[e].label.div_).hide(),planes_array[e].label&&(0==a_active||1==playback_mode?(planes_array[e].label.latlng_=r,planes_array[e].label.draw()):planes_array[e].label.rewrite()),planes_array[e].temp_label&&(0==a_active||1==playback_mode?(planes_array[e].temp_label.latlng_=r,planes_array[e].temp_label.draw()):planes_array[e].temp_label.rewrite()),multi_select_mode&&l&&add_label(e),l){var s=$("#multi_"+e),o=[];void 0===i[16]||0==i[16].length?(i[16]="",o.callsign="nocallsign_"):o.callsign=i[16],s.length>0&&$(".callsign",s).html("/"+o.callsign),delete o}window.fnPopulateClickhandlerData("marker",planes_array[e],e)}}else{1==show_labels&&showMultiSelectRoute&&1==showRoute&&planes_array[e].label&&$(planes_array[e].label.div_).hide(),r=1==a_active&&0==playback_mode?calculateFirstPos(e):new google.maps.LatLng(i[1],i[2]);var c=new google.maps.Marker({position:r,icon:get_sprite(i[8],i[3],l?"1":"0",i[6],i[7],i[16]),zIndex:2e3*Math.ceil(i[4]/2e3)+t});c.setMap(map),c.aircraft_track=i[3],c.alt=i[4],c.aircraft_type=i[8],c.squawk=i[6],void 0===i[16]||0==i[16].length?(i[16]="",c.callsign="nocallsign_"):c.callsign=i[16],google.maps.event.addListener(c,"click",function(t){if(fnPopulateClickhandlerData("marker",this),"NULL"!=selected_aircraft&&planes_array[selected_aircraft]&&planes_array[selected_aircraft].label&&(planes_array[selected_aircraft].label.setMap(null),planes_array[selected_aircraft].label.remove(),planes_array[selected_aircraft].label=null),multi_select_mode){if(!1===addMultiSelect(e))return!1;statusMultiSelect()}e!=selected_aircraft?(selected_aircraft=e,polylines_fake[e]=[],polylines_fake_index[e]=[],polylines[e]=[],polylines_index[e]=[],multi_select_mode?remove_all_labels_multi():remove_all_labels(),show_aircraft_data(e),this.setIcon(get_sprite(this.aircraft_type,this.aircraft_track,1,i[6],i[7],i[16])),showPromoPopup()):close_aircraft_data()}),google.maps.event.addListener(c,"mouseover",function(){this.setIcon(get_sprite(this.aircraft_type,this.aircraft_track,1,this.squawk,this.radar,i[16])),add_label(e),current_hover=e}),google.maps.event.addListener(c,"mouseout",function(){e!=selected_aircraft&&-1===$.inArray(e,selected_aircraft_array)&&(this.setIcon(get_sprite(this.aircraft_type,this.aircraft_track,0,this.squawk,this.radar,i[16])),remove_label(e)),current_hover=""}),1==show_labels&&a<=intAircraftLimitForLabel&&(c.label=new CustomLabel(r,map,e)),planes_array[e]=c,selected_aircraft==e&&add_label(e)}}),delete_planes(plane_list,e),1==follow_aircraft&&"NULL"!=selected_aircraft&&plane_list[selected_aircraft]&&(0==a_active||1==playback_mode)&&isMapPannable()){l=new google.maps.LatLng(plane_list[selected_aircraft][1],plane_list[selected_aircraft][2]);isMapPannable()&&!isAirportView()&&map.panToOffsetted(l)}updateViewData()}else delete_planes(plane_list);if(plane_list_org&&0!=init_call){if(plane_list=plane_list_org,plane_list_org[init_call]){if(geolocation_move=!1,1==init_follow&&!multi_select_mode){follow_aircraft=1;l=new google.maps.LatLng(plane_list_org[init_call][1],plane_list_org[init_call][2]);isAirportView()||isListView()||(isMapPannable()?map.panToOffsetted(l):map.setCenter(l))}$("a#follow-aircraft").addClass("active"),isAirportView()||isListView()||isFleetView()||(1==simple_mode&&query_z&&init_zoom?map.setZoom(init_zoom):map.setZoom(8)),show_aircraft_data(init_call),add_label(init_call),1==query_view&&(query_view=0)}else{var i="";if($.each(plane_list_org,function(e,t){if(t){if(t[9]==init_call)return i=e,!1;if(t[16]==init_call)return i=e,!1;if(t[13]==init_call)return i=e,!1}}),""!=i){if(1==simple_mode&&query_z&&init_zoom?map.setZoom(init_zoom):map.setZoom(8),1==init_follow&&!multi_select_mode){follow_aircraft=1;var l=new google.maps.LatLng(plane_list_org[i][1],plane_list_org[i][2]);isAirportView()||(isMapPannable()?map.panToOffsetted(l):map.setCenter(l))}$("a#follow-aircraft").addClass("active"),geolocation_move=!1,show_aircraft_data(i),add_label(i),1==query_view&&(query_view=0)}else historyReplaceState()}init_call=0}multi_select_mode&&(selected_aircraft="NULL",$.each(selected_aircraft_array,function(e,t){add_label(t)}))}function isEmpty(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function get_sprite(e,t,a,i,l,r){var n;if("auto"==init_aircraft_size)switch(currentZoom){case 15:case 14:case 13:case 12:case 11:case 10:case 9:case 8:n="large";break;case 7:case 6:case 5:n="normal";break;case 4:case 3:case 2:case 1:n="small";break;default:n="normal"}else n=init_aircraft_size;if("BALL"===e||"LOON"===e)s=sprite_list[n].default.ball;else{var e=aircraft_type_icons[e]?aircraft_type_icons[e]:"default";if(sprite_list[n])s=sprite_list[n][e][round_to_15(t)];else var s=sprite_list.normal.default.unknown}var o="yellow";!l||0!==l.indexOf("T-GOMX")&&0!==l.indexOf("T-WGLD")&&0!==l.indexOf("F-WGLD")||(o="blue"),(1==a||i&&("7500"==i||"7600"==i||"7700"==i))&&(o="red"),"grnd"===e&&(o="yellow"),void 0===s&&(s=sprite_list[n].default.unknown);var c=o+"_"+n+"_"+s.join("_");return spriteIcons.cache[c]||(spriteIcons.cache[c]={url:dispatcher.urls.static+"/images/sprites/"+o+"_"+n+".png?b",size:new google.maps.Size(s[0],s[1]),origin:new google.maps.Point(s[2],s[3]),anchor:new google.maps.Point(s[4],s[5])}),spriteIcons.cache[c]}function delete_planes(e,t){if(void 0===mapCanvasStub.getProjection())return!1;map.getBounds();var a=!1;if(e){1==init_labels&&(planes_showing>intAircraftLimitForLabel?(a=!0,show_labels=0):show_labels=1);var i=getLength(planes_array);for(var l in planes_array)planes_array.hasOwnProperty(l)&&(e[l]?a?planes_array[l].label&&(planes_array[l].label.setMap(null),planes_array[l].label=null,show_labels=0):show_labels&&!planes_array[l].label&&i>0&&i<=intAircraftLimitForLabel&&(planes_array[l].label=new CustomLabel(planes_array[l].getPosition(),map,l)):(planes_array[l].label&&(planes_array[l].label.setMap(null),planes_array[l].label=null),remove_label(l,!0),planes_array[l].setMap(null),delete planes_array[l]))}var r=map.getZoom();update_map_position(map.center.lat(),map.center.lng(),r),planes_showing<250&&1==init_anim&&0==playback_mode&&(a_active=1),1==playback_mode?1==a_active&&0!=aInterval&&(aInterval=setTimeout(animate_playback,playback_tick_ms_step)):1==a_active&&(aInterval=setTimeout(animate,100))}function update_map_position(e,t,a){setting_lat!=e&&(setSetting("map_lat",e,365),setting_lat=e),setting_lon!=t&&(setSetting("map_lon",t,365),setting_lon=t),setting_zoom!=a&&(setSetting("map_zoom",a,365),setting_zoom=a)}function delete_all_planes(){for(var e in planes_array)planes_array[e].label&&planes_array[e].label.setMap(null),remove_label(e,!0),planes_array[e].setMap(null),delete planes_array[e]}function show_loader(){}function hide_loader(){}function atmosphericPressure(e,t,a){var i=.0065*t;return e*Math.pow(1-i/(a+i+273.15),5.257)}function flight_data_service_cb(e,t){var a=document.getElementById("cnt-ch-sm-ad");if(a&&a.classList.remove("ad-hide"),waiting_for_data=!1,init_call=0,"NULL"!=selected_aircraft)if(aircraft=selected_aircraft,t?(selected_data[selected_aircraft]&&selected_data[selected_aircraft].from_pos&&!e.from_pos&&(e.from_pos=selected_data[selected_aircraft].from_pos),selected_data[selected_aircraft]&&selected_data[selected_aircraft].to_pos&&!e.to_pos&&(e.to_pos=selected_data[selected_aircraft].to_pos),selected_data[selected_aircraft]&&selected_data[selected_aircraft].old_pos&&!e.old_pos&&(e.old_pos=selected_data[selected_aircraft].old_pos),selected_data[selected_aircraft]=e):selected_data[selected_aircraft]=e,"1"!=e.offline&&plane_list[aircraft]){if(fnPopulateClickhandlerData("clickhandler",e,selected_aircraft),showLeftOverlay){var i="",l=[];$(".routeInformationBox","#leftColOverlay, #cnt-panel-clickhandler").show(),$(".showRouteLink","#leftColOverlay, #cnt-panel-clickhandler").removeClass("disabled"),$(".pilotViewLink","#leftColOverlay, #cnt-panel-clickhandler").removeClass("disabled"),$(".shareFlightLink","#leftColOverlay, #cnt-panel-clickhandler").attr("data-callsign","").attr("data-aircraft",""),$("#aircraftIcaoVal").html(""),$("#aircraftVal").html("N/A"),$("#registrationVal").html("N/A"),$("#hexVal").html("N/A"),$("#altSpeedGraphContainerLarge .flight").html(""),1==playback_mode&&($(".showRouteLink","#leftColOverlay, #cnt-panel-clickhandler").addClass("disabled"),$(".pilotViewLink","#leftColOverlay, #cnt-panel-clickhandler").addClass("disabled"));var r=e.identification&&e.identification.number?e.identification.number.default:"";if($("#altSpeedGraphContainerLarge .flight").text(""),plane_list[aircraft]){var n="No callsign";if(plane_list[aircraft][16]&&""!=plane_list[aircraft][16]&&(n=plane_list[aircraft][16]),n=n.replace("#",'<a href="javascript: void(0);" class="hasTooltip" data-tooltip-value="Unblocked"><svg class="premium-unlock"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#icon-fr24-unlock"></use></svg></a>'),n=n.replace("*",'<a href="javascript: void(0);" class="hasTooltip" data-tooltip-value="Unblocked"><svg class="premium-unlock"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#icon-fr24-unlock"></use></svg></a>'),null!==r&&""!==r?("undefined"!=typeof _initBlackout&&!1===_initBlackout?l.push('<span class="flightHeader"><span>'+r+'</span></span><span class="flightCallsign"> /'+n+"</span>"):(l.push('<span class="flightHeader flightLink" data-flight="'+r+'">'+r+'</span><span class="flightCallsign"> /'+n+"</span>"),$("#cnt-flight-average-time span.flight-number").text(r),$("#cnt-flight-more-flights a").html("More "+r+' flights <svg class="icon-fr24-goto"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#icon-fr24-goto"></use></svg>').prop("href","/data/flights/"+r.toLowerCase()).prop("target","_blank").addClass("hasTooltip"),document.querySelector("#cnt-flight-more-flights a")&&(document.querySelector("#cnt-flight-more-flights a").dataset.tooltipValue="Get full information on past and upcoming "+r+" flights",document.querySelector("#cnt-flight-more-flights a").dataset.tooltipMaxwidth="200px"),$("#cnt-flight-more-flights").show()),$("#altSpeedGraphContainerLarge .flight").html(r)):(l.push('<span class="flightHeader">'+n+"</span>"),$("#altSpeedGraphContainerLarge .flight").html(plane_list[aircraft][16]),$("#cnt-flight-more-flights").hide()),e.airline&&null!==e.airline){var s=e.airline?e.airline.name.split(/ ?\(/):[""];""!==s&&l.push('<span class="airlineLink">'+s[0]+(s[1]?"<br />("+s[1]:"")+"</span>")}else l.push('<span class="airlineLink"></span>')}l.length||l.push('<span class="flightHeader">No callsign</span>'),e.owner&&""!==e.owner.name&&l.push('<span class="ownerLink">Operated by '+e.owner.name+"</span>"),l.push('<span class="pilotViewLink"><svg class="icon-threeD"><use xlink:href="#icon-fr24-3d" /></svg><span class="label">3D VIEW</span></span>');var o=e.aircraft&&e.aircraft.images&&e.aircraft.images.medium?e.aircraft.images.medium[0]:"";if(""==o&&e.aircraft&&e.aircraft.images&&e.aircraft.images.thumbnails&&(o=e.aircraft.images.thumbnails[0]),""==o&&l.length<=3?$(".aircraftSummary .titleBox","#leftColOverlay, #cnt-panel-clickhandler").addClass("shortTitle").html(l.join("")):$(".aircraftSummary .titleBox","#leftColOverlay, #cnt-panel-clickhandler").removeClass("shortTitle").html(l.join("")),t||""==o)t||($(".aircraftSummary .aircraftImage","#leftColOverlay, #cnt-panel-clickhandler").html(""),$("#leftColOverlay, #cnt-panel-clickhandler").addClass("no-image"));else{var c="<img onerror=\"this.src='"+e.aircraft.images.thumbnails[0].src+'\'; this.onerror=null;" src="'+o.src+'" />';if(void 0!=o.copyright&&""!=o.copyright){var p=void 0==o.source||e.aircraft.images.hasOwnProperty("sideview")?"":'<svg class="icon-fr24-goto"><use xlink:href="#icon-fr24-goto" /></svg>';c+='<span class="imageOwner">&copy; '+(o.copyright.substring(0,38)+(o.copyright.length>38?"...":""))+" "+p+"</span>"}e.aircraft.images.hasOwnProperty("sideview")?($(".aircraftSummary .aircraftImage","#leftColOverlay, #cnt-panel-clickhandler").addClass("sideview").on("click",function(){var e=$(this).find("img").attr("src").replace("thumbnails","full").replace(".jpg",".png"),t=$(this).find(".imageOwner").clone(),a=new Image;a.onload=function(){var e=this.width;$("#sideview-dialog .image-area").css("width",e),$("#sideview-dialog .image-area").empty(),$("#sideview-dialog .image-area").append(a),$("#sideview-dialog .image-area").append(t),$("#sideview-dialog").dialog({dialogClass:"sideview-dialog",width:728,closeText:"",position:{at:"top+350",of:window}})},a.src=e}),i+='<span class="sideview-mag fa fa-search-plus" title="View full-size image of '+(""!=plane_list[aircraft][9]?plane_list[aircraft][9]:plane_list[aircraft][16])+'"></span>'):$(".aircraftSummary .aircraftImage","#leftColOverlay, #cnt-panel-clickhandler").removeClass("sideview");var _=$(".aircraftSummary .aircraftImage img","#leftColOverlay, #cnt-panel-clickhandler");0!==_.length&&_.attr("src")===o.src||(void 0!=o.link&&""!=o.link?"undefined"!=typeof _initBlackout&&!1===_initBlackout?i+=c:e.aircraft.images.large&&e.aircraft.images.large.length>0&&(i+='<a href="'+e.aircraft.images.large[0].link+'" target="_blank" title="View full-size image of '+plane_list[aircraft][9]+'">'+c+"</a>"):i+='<a title="View full-size image of '+(""!=plane_list[aircraft][9]?plane_list[aircraft][9]:plane_list[aircraft][16])+'">'+c+"</a>",$(".aircraftSummary .aircraftImage","#leftColOverlay, #cnt-panel-clickhandler").html(i))}var d={from:{iata:"",name:"",tzCode:"",tzName:"",tzOffset:""},to:{iata:"",name:"",tzCode:"",tzName:"",tzOffset:""}},f=e.airport&&e.airport.origin?e.airport.origin:null,u=e.airport&&e.airport.destination?e.airport.destination:null;e.airport&&e.airport.real&&e.airport.real;selected_data[selected_aircraft].from_pos=[];var m=document.getElementById("airport-origin-link"),g=document.getElementById("airport-origin-city"),h=document.getElementById("airport-origin-timezone"),y=document.getElementById("airport-destination-link"),v=document.getElementById("airport-destination-city"),b=document.getElementById("airport-destination-timezone");if(m.href="",m.dataset.iata="",g.classList.remove("animate"),h.classList.remove("hasTooltip"),y.href="",y.dataset.iata="",v.classList.remove("animate"),b.classList.remove("hasTooltip"),f&&f.code)if(d.from.name=f.name,d.from.iata=f.code.iata,d.from.icao=f.code.icao,d.from.city=f.position.region.city,d.from.tzCode=f.timezone.abbr,d.from.tzName=f.timezone.abbrName,d.from.tzOffset=f.timezone.offset,selected_data[selected_aircraft].from_pos[0]=f.position.latitude,selected_data[selected_aircraft].from_pos[1]=f.position.longitude,m.innerHTML=d.from.iata,m.href=("/airport/"+d.from.iata+"/arrivals").toLowerCase(),m.dataset.iata=String(d.from.iata).toUpperCase(),g.innerHTML=d.from.city,String(d.from.city.length).trim()>15&&g.classList.add("animate"),init_clock_local){var w=(0!=d.from.tzOffset?moment.duration(d.from.tzOffset,"seconds").format("HH:mm"):"00:00").replace("-",""),k=0!=d.from.tzOffset?d.from.tzOffset>0?"+":"-":"";h.innerHTML=d.from.tzCode+" (UTC "+k+w+")",h.dataset.tooltipValue=d.from.tzName,h.classList.add("hasTooltip")}else h.innerHTML="UTC";else m.innerHTML="N/A",g.innerHTML="",h.innerHTML="",e.trail&&e.trail.length>1?(selected_data[selected_aircraft].from_pos[0]=e.trail[0].lat,selected_data[selected_aircraft].from_pos[1]=e.trail[0].lng):$(".showRouteLink","#leftColOverlay, #cnt-panel-clickhandler").addClass("disabled");if(u&&u.code)if(d.to.name=u.name,d.to.iata=u.code.iata,d.to.icao=u.code.icao,d.to.city=u.position.region.city,d.to.tzCode=u.timezone.abbr,d.to.tzName=u.timezone.abbrName,d.to.tzOffset=u.timezone.offset,y.innerHTML=d.to.iata,y.href=("/airport/"+d.to.iata+"/arrivals").toLowerCase(),y.dataset.iata=String(d.to.iata).toUpperCase(),v.innerHTML=d.to.city,String(d.to.city.length).trim()>15&&v.classList.add("animate"),init_clock_local){var w=(0!=d.to.tzOffset?moment.duration(d.to.tzOffset,"seconds").format("HH:mm"):"00:00").replace("-",""),k=0!=d.to.tzOffset?d.to.tzOffset>0?"+":"-":"";b.innerHTML=d.to.tzCode+" (UTC "+k+w+")",b.dataset.tooltipValue=d.to.tzName,b.classList.add("hasTooltip")}else b.innerHTML="UTC";else y.innerHTML="N/A",v.innerHTML="",b.innerHTML="";m.dataset.tooltipValue="",y.dataset.tooltipValue="";F=document.querySelectorAll("#routeInformationBox aside > div:not(.airport), #routeInformationBox aside div.airport");if(f||u){for(B=0;B<F.length;B++)-1!=F[B].className.indexOf("airport")?F[B].classList.remove("min"):F[B].classList.remove("hidden");m.dataset.tooltipValue=f?d.from.name+"<br>("+d.from.iata+"/"+d.from.icao+")":"",y.dataset.tooltipValue=u?d.to.name+"<br>("+d.to.iata+"/"+d.to.icao+")":"",$(".routeInformationBox .airportInfo","#leftColOverlay, #cnt-panel-clickhandler").show(),!1}else for(B=0;B<F.length;B++)-1!=F[B].className.indexOf("airport")?F[B].classList.add("min"):F[B].classList.add("hidden");1===init_clock_12h?($(".routeInformationBox .statusInfo","#leftColOverlay, #cnt-panel-clickhandler").addClass("clock-12hr"),$(".routeInformationBox .statusInfo .ampm","#leftColOverlay, #cnt-panel-clickhandler").show()):($(".routeInformationBox .statusInfo","#leftColOverlay, #cnt-panel-clickhandler").removeClass("clock-12hr"),$(".routeInformationBox .statusInfo .ampm","#leftColOverlay, #cnt-panel-clickhandler").text("").hide());var T={real:e.time&&e.time.real?e.time.real.departure:null,schd:e.time&&e.time.scheduled?e.time.scheduled.departure:null},C={eta:e.time&&e.time.estimated?e.time.estimated.arrival:null,schd:e.time&&e.time.scheduled?e.time.scheduled.arrival:null,etaOther:e.time&&e.time.other&&e.time.other.eta?e.time.other.eta:null},L=e.time&&e.time.historical?e.time.historical:null,M=!1,I=!1;if(T.schd&&T.schd>0){M=1,I=!0;var S;if(S=d.from.tzCode&&d.from.tzOffset&&1==init_clock_local?new Date(1e3*(T.schd+d.from.tzOffset)):new Date(1e3*T.schd),$("#stdWrapper").attr("data-tooltip-value",d.from.tzName+" (UTC"+(d.from.tzOffset<0?"-":"+")+minutesToHHMM(d.from.tzOffset/60,!1)+")"),1==init_clock_12h){D=formatAMPM(S);$("#stdVal").html(D[0]),$("#stdWrapper .ampm").text(D[1])}else $("#stdVal").html(add_zero(S.getUTCHours())+":"+add_zero(S.getUTCMinutes()))}else $("#stdVal").html("-"),$("#stdWrapper .ampm").text(""),$("#stdWrapper").attr("data-tooltip-value","");if(C.schd&&C.schd>0){M=1,I=!0;var x;if(x=d.to.tzCode&&d.to.tzOffset&&1==init_clock_local?new Date(1e3*(C.schd+d.to.tzOffset)):new Date(1e3*C.schd),$("#staWrapper").attr("data-tooltip-value",d.to.tzName+" (UTC"+(d.to.tzOffset<0?"-":"+")+minutesToHHMM(d.to.tzOffset/60,!1)+")"),1==init_clock_12h){D=formatAMPM(x);$("#staVal").html(D[0]),$("#staWrapper .ampm").text(D[1])}else $("#staVal").html(add_zero(x.getUTCHours())+":"+add_zero(x.getUTCMinutes()))}else $("#staVal").html("-"),$("#staWrapper .ampm").text(""),$("#staWrapper").attr("data-tooltip-value","");!0===I&&(f||u)?$(".statusInfo .airport.from").show():$(".statusInfo .airport.from").hide(),$("#timeElapsed, #timeRemaining").hide();var A=!1;if(T.real){M=1,A=!0;var O=new Date(1e3*T.real),P=minutesToHHMM((O.getTime()-timeLocal.getTime())/1e3/60);if(d.from.tzCode&&d.from.tzOffset&&1==init_clock_local&&(O=new Date(1e3*(T.real+d.from.tzOffset))),$("#atdWrapper").attr("data-tooltip-value",d.from.tzName+" (UTC"+(d.from.tzOffset<0?"-":"+")+minutesToHHMM(d.from.tzOffset/60,!1)+")"),1==init_clock_12h){D=formatAMPM(O);$("#atdVal").html(D[0]).attr("data-tooltip-value",P),$("#atdWrapper .ampm").text(D[1])}else $("#atdVal").html(add_zero(O.getUTCHours())+":"+add_zero(O.getUTCMinutes())).attr("data-tooltip-value",P);$("#timeElapsed").html(P).show(),selected_data[selected_aircraft].status&&selected_data[selected_aircraft].status.generic&&"departure"===selected_data[selected_aircraft].status.generic.status.type&&$("#atdVal").prepend('<span class="status '+selected_data[selected_aircraft].status.generic.status.color+'"></span>')}else document.getElementById("atdVal").innerHTML="-",$("#atdWrapper .ampm").text(""),$("#atdWrapper").attr("data-tooltip-value","");var q=0;if(C.etaOther&&C.etaOther>0?q=C.etaOther:C.eta&&C.eta>0&&(q=C.eta),q>0&&(f||u)){M=1,A=!0;var z=new Date(1e3*q),V=minutesToHHMM((z.getTime()-timeLocal.getTime())/1e3/60);if(d.to.tzCode&&d.to.tzOffset&&1==init_clock_local&&(z=new Date(1e3*(q+d.to.tzOffset))),$("#etaWrapper").attr("data-tooltip-value",d.to.tzName+" (UTC"+(d.to.tzOffset<0?"-":"+")+minutesToHHMM(d.to.tzOffset/60,!1)+")"),1==init_clock_12h){var D=formatAMPM(z);$("#etaVal").html(D[0]).attr("data-tooltip-value",V),$("#etaWrapper .ampm").text(D[1])}else $("#etaVal").html(add_zero(z.getUTCHours())+":"+add_zero(z.getUTCMinutes())).attr("data-tooltip-value",V);$("#timeRemaining").html(V).show(),selected_data[selected_aircraft].status&&selected_data[selected_aircraft].status.generic&&"arrival"===selected_data[selected_aircraft].status.generic.status.type&&$("#etaVal").prepend('<span class="status '+selected_data[selected_aircraft].status.generic.status.color+'"></span>')}else $("#etaVal").html("-"),$("#etaWrapper .ampm").text(""),$("#etaWrapper .ampm").text("");!0===A&&(f||u)?$(".statusInfo .airport.to").show():$(".statusInfo .airport.to").hide(),L?(I=!0,M=1,document.getElementById("avgftVal").innerHTML=minutesToHHMM(L.flighttime/60,!1),document.getElementById("cnt-flight-average-time").classList.remove("hidden")):document.getElementById("cnt-flight-average-time").classList.add("hidden");var F=document.querySelectorAll("#routeInformationBox div.progress, #routeInformationBox aside > div:not(.airport)");if(0==M||1==paramNoTime||!f&&!u)for(B=0;B<F.length;B++)F[B].classList.add("hidden");else{for(var B=0;B<F.length;B++)F[B].classList.remove("hidden");!1}if(1===$(".statusInfo .airport:visible").length?$(".routeInformationBox .statusInfo","#leftColOverlay, #cnt-panel-clickhandler").addClass("single-child"):$(".routeInformationBox .statusInfo","#leftColOverlay, #cnt-panel-clickhandler").removeClass("single-child"),"full"===aircraftInfoLevel){e.aircraft&&e.aircraft.msn?document.getElementById("msnVal").innerHTML=e.aircraft.msn:document.getElementById("msnVal").innerHTML="N/A";var N="N/A",R="";e.aircraft&&e.aircraft.age&&(e.aircraft.age.date&&-1!==e.aircraft.age.date.indexOf("0000")||(N=!0===e.aircraft.age.testflight?"Test flight":0===e.aircraft.age.years?"Brand New":e.aircraft.age.years+" year"+(e.aircraft.age.years>1?"s":"")),e.aircraft.age.date&&(R="("+e.aircraft.age.date+")")),document.getElementById("ageVal").innerHTML=N,document.getElementById("monthVal").innerHTML=R}else{H='<a target="premium" href="javascript: void(0);" class="'+subscriptionFeatureTooltip+' premium-content disabled featureInfo-53" data-tooltip-value="'+subscriptionUpgradetext+'" data-tooltip-maxwidth="250px"><svg class="premium-lock"><use xlink:href="#icon-fr24-lock" /></svg></a>';$("#firVal").html(H.replace("featureInfo53","featureInfo120").replace("featureInfo-53","featureInfo-120")),$("#monthVal").html(""),-1!==$.inArray("AGE",e.availability)?$("#ageVal").html(H.replace("featureInfo53","featureInfo123").replace("featureInfo-53","featureInfo-123")):document.getElementById("ageVal").innerHTML="N/A",-1!==$.inArray("MSN",e.availability)?$("#msnVal").html(H.replace("featureInfo53","featureInfo122").replace("featureInfo-53","featureInfo-122")):$("#msnVal").html("N/A")}"full"===aircraftInfoLevel&&void 0!==e.ems&&e.ems;var U=[["IAS","speed"],["TAS","speed"],["MACH","speed"],["AGPS","altitude"],["OAT","temperature"],["WIND","wspeed"]];if($("#emsWDIR, #emsOAT, #emsIAS, #emsTAS, #emsMACH, #emsAGPS, #emsWIND, #vspdVal, #squawkVal").html("-"),$.each(U,function(e,t){$("#ems"+t[0]).html("-")}),"full"!==aircraftInfoLevel){var H='<a href="javascript: void(0);" target="premium" class="'+subscriptionFeatureTooltip+' premium-content disabled featureInfo-53" data-tooltip-value="'+subscriptionUpgradetext+'" data-tooltip-maxwidth="250px"><svg class="premium-lock"><use xlink:href="#icon-fr24-lock" /></svg></a>';$("#emsWIND").html(H.replace("featureInfo53","featureInfo127").replace("featureInfo-53","featureInfo-127")),$("#emsIAS").html(H.replace("featureInfo53","featureInfo124").replace("featureInfo-53","featureInfo-124")),$("#emsTAS").html(H.replace("featureInfo53","featureInfo125").replace("featureInfo-53","featureInfo-125")),$("#emsMACH").html(H.replace("featureInfo53","featureInfo126").replace("featureInfo-53","featureInfo-126")),$("#emsOAT").html(H.replace("featureInfo53","featureInfo128").replace("featureInfo-53","featureInfo-128")),$("#emsAGPS").html(H.replace("featureInfo53","featureInfo129").replace("featureInfo-53","featureInfo-129"))}update_aircraft_data_overlay(e),$(".errorMsg","#leftColOverlay, #cnt-panel-clickhandler").remove(),$("body").removeClass("loading-left-overlay")}else showAircarfInfoWindow(e);if(t)return!0;if(1==playback_mode&&(playback_last>playback_time.getTime()&&remove_polylines(),playback_last=playback_time.getTime()),remove_polylines_fake(),e.trail&&(e.trail.length>1||1==playback_mode)){if(selected_count[aircraft]=0,1==playback_mode&&"NULL"!=selected_aircraft&&plane_list[selected_aircraft]){var W=plane_list[selected_aircraft][10];e.firstTimestamp}var E=plane_list_org[aircraft],j=100,G=0,Q=null,Z={default:900,"T-F5M":1800};for(B=e.trail.length-2;B>0;B--){var Y=plane_list[aircraft]?plane_list[aircraft][7]:"";if(Q=Y in Z?Z[Y]:Z.default,1==playback_mode){if(plane_list[aircraft][5]>0&&(j=1.5*plane_list[aircraft][5]),e.trail[B-1].ts>=W-j){var K=toRad(e.trail[B+1].lat),J=toRad(e.trail[B+1].lng),X=toRad(plane_list[aircraft][1]),ee=J-toRad(plane_list[aircraft][2]),te=Math.sin(ee)*Math.cos(K),ae=Math.cos(X)*Math.sin(K)-Math.sin(X)*Math.cos(K)*Math.cos(ee),ie=Math.atan2(te,ae);if(ie=(toDeg(ie)+360)%360,brngDiff=Math.abs(bearingDiff(ie,parseInt(plane_list[aircraft][3]))),brngDiff<10||e.trail[B-1].ts>=W)break}}else if(E[1]==e.trail[B-1].lat&&E[2]==e.trail[B].lng)break;if(polylines_index[aircraft]&&!polylines_index[aircraft][e.trail[B].lat+"/"+e.trail[B].lng]){var le,re=null,ne=[new google.maps.LatLng(e.trail[B].lat,e.trail[B].lng),new google.maps.LatLng(e.trail[B+1].lat,e.trail[B+1].lng)],se=meter_to_color(e.trail[B].alt/10*10*.3048),oe=null;void 0===e.trail[B-1]?G<Q?(oe=null,le=.6):(oe=[{icon:{path:"M 0,0 0,2",strokeColor:"#000",strokeOpacity:.5},repeat:"10px"}],le=0):G<Q?(oe=null,le=.6):e.trail[B].alt>0&&(oe=[{icon:{path:"M 0,0 0,2",strokeColor:"#000",strokeOpacity:.5},repeat:"10px"}],le=0),null!==le&&((re=new google.maps.Polyline({path:ne,strokeColor:se,strokeWeight:3,geodesic:!0,strokeOpacity:le,icons:oe})).setMap(map),pushPolyPoint(se,[e.trail[B].lat,e.trail[B].lng],{time:e.trail[B].ts,speed:e.trail[B].spd,alt:e.trail[B].alt}),polylines[aircraft].push(re),polylines_index[aircraft][e.trail[B].lat+"/"+e.trail[B].lng]="1")}G=e.trail[B-1].ts-e.trail[B].ts}drawPolyPoint(),polylineInCoverage[aircraft]=!0,create_selected_aircraft_graph(selected_data[selected_aircraft].trail),$("#altSpeedGraphContainerLarge").is(":visible")&&create_selected_aircraft_graph(selected_data[selected_aircraft].trail,"#altSpeedGraphLarge")}else ne=[new google.maps.LatLng(plane_list[aircraft][1],plane_list[aircraft][2]),new google.maps.LatLng(plane_list[aircraft][1],plane_list[aircraft][2])],(re=new google.maps.Polyline({path:ne,strokeColor:meter_to_color(.3048*plane_list[aircraft][4]),strokeOpacity:.6,strokeWeight:3,geodesic:!0})).setMap(map),polylines[aircraft].push(re),polylines_index[aircraft][plane_list[aircraft][1]+"/"+plane_list[aircraft][2]]="1";if(polylines[aircraft]&&polylines[aircraft].length>0&&(selected_count[aircraft]++,void 0!==polylines[aircraft][polylines[aircraft].length-1])){var ce=polylines[aircraft][polylines[aircraft].length-1].getPath().getAt(0);plane_list[aircraft][1]!=ce.lat()&&plane_list[aircraft][2]!=ce.lng()&&(G=plane_list[aircraft][10]-e.trail[0].ts,!(plane_list[aircraft]?plane_list[aircraft][7]:"").match(radarRegexp)&&G<Q?(oe=null,le=.6):(oe=[{icon:{path:"M 0,0 0,2",strokeColor:"#000",strokeOpacity:.5},repeat:"10px"}],le=0),ne=[new google.maps.LatLng(plane_list[aircraft][1],plane_list[aircraft][2]),ce],(re=new google.maps.Polyline({path:ne,strokeColor:meter_to_color(.3048*plane_list[aircraft][4]),strokeOpacity:le,strokeWeight:3,geodesic:!0,icons:oe})).setMap(map),G>=Q?(re.setMap(map),pushPolyPoint(se,[e.trail[B].lat,e.trail[B].lng],{time:e.trail[B].ts,speed:e.trail[B].spd,alt:10*e.trail[B].alt}),polylines[aircraft].push(re),polylines_index[aircraft][e.trail[B].lat+"/"+e.trail[B].lng]="1"):(polylines_fake[aircraft].push(re),polylines_fake_index[aircraft][plane_list[aircraft][1]+"/"+plane_list[aircraft][2]]="1"))}}else close_aircraft_data()}function flight_data_service_cb_multi(e,t,a){if(waiting_for_data=!1,!a||"NULL"===a)return!1;if(init_call=0,$("#leftColOverlay, #cnt-panel-clickhandler").removeClass("active").hide(),$("#clickLoader").removeAttr("class").hide(),$("body").hasClass("show-left-overlay")||$("body").addClass("show-left-overlay"),$("#leftColOverlayMulti").show(),multi_select_mode){if(a=a||selected_aircraft,selected_data[a]=e,0===$("#multi_"+a).length&&-1!==$.inArray(a,selected_aircraft_array)){var l="",r="",n="",s={from:{iata:"",name:"",tzCode:"",tzName:"",tzOffset:""},to:{iata:"",name:"",tzCode:"",tzName:"",tzOffset:""}},o=e.airport&&e.airport.origin?e.airport.origin:null,c=e.airport&&e.airport.destination?e.airport.destination:null;e.airport&&e.airport.real&&e.airport.real;o&&o.code?(s.from.name=o.name,s.from.iata=o.code.iata,s.from.icao=o.code.icao,s.from.city=o.position.region.city,s.from.tzCode=o.timezone.abbr,s.from.tzName=o.timezone.abbrName,s.from.tzOffset=o.timezone.offset,r='<h3><a href="javascript: void(0);" class="hasTooltip" data-tooltip-value="'+s.from.name+'">'+s.from.iata+"</a></h3>",r+='<span class="airport-city">'+s.from.city+"</span>"):r="<h3>N/A</h3>",c&&c.code?(s.to.name=c.name,s.to.iata=c.code.iata,s.to.icao=c.code.icao,s.to.city=c.position.region.city,s.to.tzCode=c.timezone.abbr,s.to.tzName=c.timezone.abbrName,s.to.tzOffset=c.timezone.offset,n='<h3><a href="javascript: void(0);" class="hasTooltip" data-tooltip-value="'+s.to.name+'">'+s.to.iata+"</a></h3>",n+='<span class="airport-city">'+s.to.city+"</span>"):n="<h3>N/A</h3>";var p=e.aircraft&&e.aircraft.model&&e.aircraft.model.text?e.aircraft.model.text:"",_=e.identification&&e.identification.number?e.identification.number.default:"",d=e.identification&&e.identification.callsign?e.identification.callsign:"",f=e.airline&&e.airline.name?e.airline.name:"",u=e.owner&&""!==e.owner.name?e.owner.name:"",m="";if(e.aircraft&&e.aircraft.images&&e.aircraft.images.thumbnails){var g=e.aircraft.images.thumbnails[0];m+='<div class="aircraftImage">',m+='<a target="_blank" href="'+(""!==g.link?g.link:g.src)+'">',m+='<img title="'+g.copyright+'" src="'+g.src+'" />',m+="</a>",m+="</div>"}l+='<div class="flightInfoboxMulti" id="multi_'+a+'" '+(showMultiSelectInfo?"":'style="display:none;"')+">",l+='<a class="close" title="Close" onclick="remove_aircraft_polylines(\''+a+'\');"><svg class="icon-fr24-close"><use xlink:href="#icon-fr24-close" /></svg></a>',l+='<div class="header">',l+=m,l+='<div class="titleBox">',l+=_?'<span class="flight">'+_+"</span>":"",l+=d?'<span class="callsign"> / '+d+"</span>":"",l+=f?'<span class="airline"><a href="javascript: void(0);" class="hasTooltip" data-tooltip-value="'+f+'">'+f+"</a></span>":"",l+=u?'<span class="operator"><a href="javascript: void(0);" class="hasTooltip" data-tooltip-value="'+u+'">'+u+"</a></span>":"",l+="</div>",l+="</div>",l+='<div ng-show="selectedData.has_schedule" class="airportInfo">',l+='<span class="airport from">'+r+"</span>",l+='<svg class="icon icon-fr24-flight-status"><use xlink:href="#icon-fr24-aircraft-big" /></svg>',l+='<span class="airport to">'+n+"</span>",l+="</div>",l+=p?'<div class="aircraftDetail"><div>'+p+"</div></div>":"",l+="</div>",$("#leftColOverlayMulti").append(l),arrangeMultiSelectWindows()}if(plane_list[a]&&e.trail&&(e.trail.length>1||1===parseInt(playback_mode))){if(selected_count[a]=0,1===parseInt(playback_mode)){var h=plane_list[a][10];e.firstTimestamp}var y=plane_list_org[a],v=100,b=0,w=null,k={default:900,"T-F5M":1800};for(i=e.trail.length-2;i>0;i--){var T=plane_list[a]?plane_list[a][7]:"";if(w=T in k?k[T]:k.default,1===parseInt(playback_mode)){if(plane_list[a][5]>0&&(v=1.5*plane_list[a][5]),e.trail[i-1].ts>=h-v){var C=toRad(e.trail[i+1].lat),L=toRad(e.trail[i+1].lng),M=toRad(plane_list[a][1]),I=L-toRad(plane_list[a][2]),S=Math.sin(I)*Math.cos(C),x=Math.cos(M)*Math.sin(C)-Math.sin(M)*Math.cos(C)*Math.cos(I),A=Math.atan2(S,x);if(A=(toDeg(A)+360)%360,brngDiff=Math.abs(bearingDiff(A,parseInt(plane_list[a][3]))),brngDiff<10||e.trail[i-1].ts>=h)break}}else if(y[1]==e.trail[i-1].lat&&y[2]==e.trail[i].lng)break;if(!polylines_index[a][e.trail[i].lat+"/"+e.trail[i].lng]){var O,P=null,q=[new google.maps.LatLng(e.trail[i].lat,e.trail[i].lng),new google.maps.LatLng(e.trail[i+1].lat,e.trail[i+1].lng)],z=meter_to_color(e.trail[i].alt/10*10*.3048),V=null;void 0===e.trail[i-1]?b<w?(V=null,O=.6):(V=[{icon:{path:"M 0,0 0,2",strokeColor:"#000",strokeOpacity:.5},repeat:"10px"}],O=0):b<w?(V=null,O=.6):e.trail[i].alt>0&&(V=[{icon:{path:"M 0,0 0,2",strokeColor:"#000",strokeOpacity:.5},repeat:"10px"}],O=0),null!==O&&((P=new google.maps.Polyline({path:q,strokeColor:z,strokeWeight:3,geodesic:!0,strokeOpacity:O,icons:V})).setMap(map),polylines[a].push(P),polylines_index[a][e.trail[i].lat+"/"+e.trail[i].lng]="1")}b=e.trail[i-1].ts-e.trail[i].ts}polylineInCoverage[a]=!0}else polylines[a]&&(q=[new google.maps.LatLng(plane_list[a][1],plane_list[a][2]),new google.maps.LatLng(plane_list[a][1],plane_list[a][2])],(P=new google.maps.Polyline({path:q,strokeColor:meter_to_color(.3048*plane_list[a][4]),strokeOpacity:.6,strokeWeight:3,geodesic:!0})).setMap(map),polylines[a].push(P),polylines_index[a][plane_list[a][1]+"/"+plane_list[a][2]]="1");if(polylines[a]&&polylines[a].length>0&&(selected_count[a]++,void 0!==polylines[a][polylines[a].length-1])){var D=polylines[a][polylines[a].length-1].getPath().getAt(0);plane_list[a][1]!=D.lat()&&plane_list[a][2]!=D.lng()&&(b=plane_list[a][10]-e.trail[0].ts,!(plane_list[a]?plane_list[a][7]:"").match(radarRegexp)&&b<w?(V=null,O=.6):(V=[{icon:{path:"M 0,0 0,2",strokeColor:"#000",strokeOpacity:.5},repeat:"10px"}],O=0),q=[new google.maps.LatLng(plane_list[a][1],plane_list[a][2]),D],(P=new google.maps.Polyline({path:q,strokeColor:meter_to_color(.3048*plane_list[a][4]),strokeOpacity:O,strokeWeight:3,geodesic:!0,icons:V})).setMap(map),b>=w?(P.setMap(map),polylines[a].push(P),polylines_index[a][e.trail[i].lat+"/"+e.trail[i].lng]="1"):(polylines_fake[a].push(P),polylines_fake_index[a][plane_list[a][1]+"/"+plane_list[a][2]]="1"))}}}function planedata_single(e){plane_list={},e.flight_id=parseInt(e.flight_id).toString(16),plane_list[e.flight_id]=[e.hex,e.trail[0],e.trail[1],0,0,0,0,0,e.aircraft_icao,e.registration,0,e.from_iata,e.to_iata,e.flight,0,0,e.callsign,0],plane_list_org=plane_list;var t=new Date(playback_time.getTime()-6e4*playback_time.getTimezoneOffset()).getTime(),a=(plane_list[e.flight_id],{}),l={};for(l.ts=0,l.alt=0,l.speed=0,l.heading=0,l.squawk=0,i=0;i<=e.trail.length-7;i+=7)if(l.alt+=10*e.trail[i+2],l.ts+=1e3*e.trail[i+3],l.speed+=4*e.trail[i+4],l.heading+=2*e.trail[i+5],l.squawk+=e.trail[i+6],l.ts>=t)(a={})[e.flight_id]=plane_list[e.flight_id].slice(0),a[e.flight_id][1]=e.trail[i],a[e.flight_id][2]=e.trail[i+1],a[e.flight_id][3]=l.heading,a[e.flight_id][4]=l.alt,a[e.flight_id][5]=l.speed,a[e.flight_id][6]=l.squawk,a[e.flight_id][10]=l.ts,playback_queue.unshift(a),0;else if(e.trail[i+7]&&!polylines_index[aircraft][e.trail[i]+"/"+e.trail[i+1]]){var r=[new google.maps.LatLng(e.trail[i],e.trail[i+1]),new google.maps.LatLng(e.trail[i+7],e.trail[i+8])],n=meter_to_color(.3048*l.alt),s=new google.maps.Polyline({path:r,strokeColor:n,strokeOpacity:.6,strokeWeight:3,geodesic:!0});s.setMap(map),pushPolyPoint(n,[e.trail[i],e.trail[i+1]],{time:l.ts,speed:l.speed,alt:l.alt}),polylines[aircraft].push(s),polylines_index[aircraft][e.trail[i]+"/"+e.trail[i+1]]="1"}drawPolyPoint(),e.trail=[],e.offline=0,selected_aircraft=e.flight_id,a_active=1,playback_play=1,playback_queue.pop(),plane_list_next=playback_queue.pop(),$(".errorMsg","#leftColOverlay, #cnt-panel-clickhandler").remove(),flight_data_service_cb(e),step_playback_queue(plane_list_next),clearTimeout(aInterval),aInterval=setTimeout(animate_playback,100)}function update_aircraft_data_overlay(e){if(void 0===e)return!1;if("NULL"==typeof selected_aircraft||void 0===plane_list_org[selected_aircraft])return remove_polylines(),void show_aircraft_data(selected_aircraft);$(".routeInformationBox .progressBar, .routeInformationBox .progressBarEmpty","#leftColOverlay, #cnt-panel-clickhandler").hide();var t=e.airport&&e.airport.origin?e.airport.origin.position:null,a=e.airport&&e.airport.destination?e.airport.destination.position:null,i=e.airport&&e.airport.real?e.airport.real:null;e.status&&e.status.distance&&e.status.distance;$("#routeInformationBox .progress > p, #distanceCovered, #distanceRemaining").hide(),$(".flightRouteInfo","#leftColOverlay, #cnt-panel-clickhandler").hide();var l=!1,r=!1,n=selected_aircraft;if(t&&0!==t.latitude&&0!==t.longitude&&(r=calculateDistanceBetween(plane_list_org[n][1],plane_list_org[n][2],t.latitude,t.longitude)),a&&0!==a.latitude&&0!==a.longitude&&(l=calculateDistanceBetween(plane_list_org[n][1],plane_list_org[n][2],a.latitude,a.longitude)),!1!==r&&!1!==l){var s=calculateDistanceBetweenVincenty(t.latitude,t.longitude,a.latitude,a.longitude),o=Math.round(100*(1-l/s));if(o<5&&(o=5),0==paramNoProgress){$(".routeInformationBox .progressBar .progress","#leftColOverlay, #cnt-panel-clickhandler").css("width",o+"%");var c=o-13,p=c<0?0:c;$(".routeInformationBox .progressBar .icon-progress","#leftColOverlay, #cnt-panel-clickhandler").css("margin-left",p+"%");var _=NavigationManager.ConvertUnits("distance",s);$(".routeInformationBox .progressBar","#leftColOverlay, #cnt-panel-clickhandler").show(),$("#distanceVal").html(_).show(),$("#routeInformationBox .progress > p").show(),$("#distanceCovered").html(NavigationManager.ConvertUnits("distance",r)).show(),$("#distanceRemaining").html(NavigationManager.ConvertUnits("distance",l)).show(),$(".flightRouteInfo","#leftColOverlay, #cnt-panel-clickhandler").show()}}else document.querySelector("#routeInformationBox div.progress").classList.add("hidden");var d=null;i&&i.code&&i.code.iata&&(d=i.code.iata),function(e,t,a,i,l,r){var n="",s="icon-fr24-aircraft-big",o="Airborne",c=" active",p=$(e);!1!==a&&i<-6&&a<100?(s="icon-fr24-aircraft-down",o="On approach",c+=" approaching"):!1!==t&&i>6&&t<100?(s="icon-fr24-aircraft-up",o="Taking off",c+=" leaving"):0===l&&(t<100||a<100)?(s="icon-fr24-aircraft-onground",o="On ground",c=" onground"):r?(s="icon-fr24-aircraft-diversion",o="Diverted to "+r,c=" diverted"):c=" airborne",p.attr("data-tooltip-value")!==o&&(n+='<svg id="aircraftStatusIcon" class="icon icon-fr24-flight-status hasTooltip'+c+'" data-tooltip-value="'+o+'"><use xlink:href="#'+s+'" /></svg>',p.replaceWith(n))}("#aircraftStatusIcon",r,l,plane_list[n][15],plane_list[n][4],d);var f=getTooltipUnits("speed",plane_list[n][5]),u=getTooltipUnits("altitude",plane_list[n][4]),m=getTooltipUnits("vspeed",plane_list[n][15]);plane_list[n][8]&&$("#aircraftIcaoVal").html("("+plane_list[n][8]+")"),e.aircraft&&e.aircraft.model&&e.aircraft.model.text?$("#aircraftVal").html(e.aircraft.model.text):$("#aircraftVal").html("N/A");var g=document.getElementById("btn-aircraft-data-add");g instanceof HTMLElement&&(!plane_list[n][8]&&plane_list[n][0]&&parseInt(plane_list[n][0],16)>16383?g.classList.remove("hidden"):g.classList.add("hidden"));var h=document.getElementById("btn-ch-lg-flights-toggle");if(plane_list[n][9]){if(h){var y=document.getElementById("txt-btn-ch-lg-flights-toggle-label");h.classList.remove("hidden"),h.dataset.reg=plane_list[n][9],y&&(y.textContent="Recent "+plane_list[n][9]+" flights")}$("#registrationVal").html(plane_list[n][9]);for(var v,b="",w=0;w<plane_list[n][9].length;w++)v=plane_list[n][9][w],phonetics.hasOwnProperty(v)&&(b+=(""!==b?" ":"")+phonetics[v]);$("#registrationVal").attr("data-tooltip-value",b)}else h&&h.classList.add("hidden"),$("#registrationVal").attr("data-tooltip-value","");var k="";e&&e.aircraft&&e.aircraft.hex?("000000"==(k=e.aircraft.hex)&&(k="N/A"),document.getElementById("hexVal").innerHTML=k):plane_list[n][0]?document.getElementById("hexVal").innerHTML=plane_list[n][0]:document.getElementById("hexVal").innerHTML="N/A",$("#altitudeVal").html("<span class='hasTooltip' data-tooltip-value='"+u+"'>"+NavigationManager.ConvertUnits("altitude",plane_list[n][4])+"</span>"),$("#speedVal").html("<span class='hasTooltip' data-tooltip-value='"+f+"'>"+NavigationManager.ConvertUnits("speed",plane_list[n][5])+"</span>"),$("#trackVal").html(plane_list[n][3]+"&deg;");var T=Math.round(1e4*plane_list_org[n][1])/1e4,C=Math.round(1e4*plane_list_org[n][2])/1e4,L=plane_list[n]?plane_list[n][7]:"",M=void 0!==dispatcher.userFeatures["user.role"]?dispatcher.userFeatures["user.role"]:null;null!=M&&(M.indexOf("support")||M.indexOf("admin"))&&(L='<a href="'+dispatcher.urls.site+"/account/feed-stats/?alias="+L+'" target="_blank">'+L+"</a>"),$("#radarVal").html(L),$("#latVal").html(T),$("#lonVal").html(C);var I=plane_list[n][6];if("limited"!==aircraftInfoLevel)$("#vspdVal").html("<span class='hasTooltip' data-tooltip-value='"+m+"'>"+NavigationManager.ConvertUnits("vspeed",plane_list[n][15])+"</span>"),I>0?$("#squawkVal").html(I):$("#squawkVal").html("N/A"),$(".alertsLink").attr({title:"Alerts",target:"alerts",href:"/account/alerts"}).unbind("click").html('<svg class="icon icon-fr24-alert"><use xlink:href="#icon-fr24-alert" /></svg>');else{if("7500"==I||"7600"==I||"7700"==I)$("#squawkVal").html(I);else{var S='<a href="javascript: void(0);" target="premium" class="'+subscriptionFeatureTooltip+' premium-content disabled featureInfo-53" data-tooltip-value="'+subscriptionUpgradetext+'" data-tooltip-maxwidth="250px"><svg class="premium-lock"><use xlink:href="#icon-fr24-lock" /></svg></a>';$("#vspdVal").html(S.replace("featureInfo53","featureInfo119").replace("featureInfo-53","featureInfo-119")),$("#squawkVal").html(S.replace("featureInfo53","featureInfo118").replace("featureInfo-53","featureInfo-118"))}$(".alertsLink").attr({title:subscriptionUpgradetext,"data-tooltip-value":subscriptionUpgradetext?"Alerts: "+subscriptionUpgradetext:"Alerts",target:"premium",href:"javascript:void(0);"}).html('<svg class="icon icon-fr24-alert-lock"><use xlink:href="#icon-fr24-alert-lock" /></svg>'),""===subscriptionFeatureTooltip&&$(".alertsLink").removeClass("hasTooltip")}$(".showRouteLink","#leftColOverlay, #cnt-panel-clickhandler").attr("data-callsign",plane_list[n][16]),$(".pilotViewLink","#leftColOverlay, #cnt-panel-clickhandler").attr("data-callsign",plane_list[n][16]),$(".shareFlightLink","#leftColOverlay, #cnt-panel-clickhandler").attr("data-callsign",plane_list[n][16]).attr("data-aircraft",n);var x={lat:T,lng:C,alt:plane_list[n][4],spd:plane_list[n][5],ts:plane_list[n][10],hd:plane_list[n][3]};selected_data[n].trail&&(selected_data[n].trail.unshift(x),$("#aircraftInfoGridContainer").hasClass("show-graph")&&update_selected_aircraft_graph(x))}function getTooltipUnits(e,t){var a={TAS:"speed",IAS:"speed",AGPS:"altitude",OAT:"temperature",WIND:"speed"};void 0!==a[e]&&(e=a[e]);var i=NavigationManager.ConvertUnits("speed",t,"kt","kt"),l=NavigationManager.ConvertUnits("speed",t,"kt","kmh"),r=NavigationManager.ConvertUnits("speed",t,"kt","mph"),n=NavigationManager.ConvertUnits("altitude",t,"ft","m"),s=NavigationManager.ConvertUnits("altitude",t,"ft","ft"),o=NavigationManager.ConvertUnits("vspeed",t,"ft","m"),c={speed:{kmh:l,mph:r,kt:i},altitude:{m:n,ft:s},vspeed:{ft:NavigationManager.ConvertUnits("vspeed",t,"ft","ft"),m:o},temperature:{c:NavigationManager.ConvertUnits("temperature",t,"c","c"),f:NavigationManager.ConvertUnits("temperature",t,"c","f")}},p="";return $.each(c[e],function(e,t){e!==init_unit_speed&&e!==init_unit_alt&&e!==init_unit_temp&&(p+=t+", ")}),p=p.substring(0,p.length-2)}function panAircraftIntoView(e){if(e in plane_list&&plane_list[e].length>2){var t=mapCanvasStub.getProjection(),a=t.fromLatLngToContainerPixel(map.getCenter()),i=t.fromLatLngToContainerPixel(new google.maps.LatLng(plane_list[e][1],plane_list[e][2])),l=t.fromLatLngToContainerPixel(map.getBounds().getNorthEast());if(!dispatcher.display.isMobile&&i.x<=280){var r=260+(l.x-260)/2,n=t.fromContainerPixelToLatLng({x:a.x-(r-i.x),y:a.y});map.panTo(n)}}}function show_aircraft_data(e,t){if(hideShareBox(),"undefined"!=typeof Fr24&&Fr24.AirportPanel&&Fr24.AirportPanel.isOpen()&&Fr24.AirportPanel.close(),t=void 0!==t?t:0,1!=waiting_for_data){var a=document.getElementById("btn-ch-lg-flights-toggle");if(0===t&&a&&a.classList.contains("active")&&(mouseEvent.initEvent("click",!0,!1),a.dispatchEvent(mouseEvent),a.isDataLoaded=!1),plane_list&&plane_list[e]){if(1===follow_aircraft&&document.getElementById("follow-aircraft").classList.add("active"),force_init_call=0,e!=selected_aircraft&&$("#aircraft_"+selected_aircraft+" .temporary_label").length>0&&$("#aircraft_"+selected_aircraft+" .temporary_label").removeClass("opacity_0").show(),0===t&&(selected_aircraft=e,multi_select_mode||($("body").addClass("loading-left-overlay"),$("#leftColOverlay, #cnt-panel-clickhandler").removeClass("no-image"),remove_polylines(),$(".aircraft_marker.active .aircraft_label_container").remove(),$(".aircraft_marker.active").removeClass("active")),$("#aircraft_"+e).addClass("active"),$(".errorMsg","#leftColOverlay, #cnt-panel-clickhandler").remove(),1==simple_mode&&$("#playbackControlsOverlay").addClass("pushed"),load3dView&&(load3dView=!1,cockpitViewModel=new CesiumCockpit(function(){init_anim=0,window.busMan&&window.busMan.showThreeDAd()})),dispatcher&&dispatcher.display&&dispatcher.display.isDevice&&panAircraftIntoView(selected_aircraft)),0==t)1==query_single||($("#dialog-message").dialog("close"),query_flight_data(e),load_flight_ems());else{update_aircraft_data_overlay(selected_data[e]),load_flight_ems();var i=plane_list[e][4];i<1e4?selected_count[e]=3:i>1e4&&i<2e4&&1===selected_count[e]&&(selected_count[e]+=1),draw_fake_polyline(e,1)}show_aircraft_data_requests=0}else show_aircraft_data_requests>show_aircraft_data_threshold?(close_aircraft_data(),show_aircraft_data_requests=0):show_aircraft_data_requests++;historyReplaceState()}else setTimeout(function(){show_aircraft_data(e,t)},500)}function load_flight_ems(){var e="full"===aircraftInfoLevel&&void 0!==selected_data_ems.ems&&null!==selected_data_ems.ems,t=[["IAS","speed"],["TAS","speed"],["MACH","speed"],["AGPS","altitude"],["OAT","temperature"],["WIND","wspeed"]];if($("#emsWDIR, #emsOAT, #emsIAS, #emsTAS, #emsMACH, #emsAGPS, #emsWIND").html("-"),selected_data_ems.aircraft===selected_aircraft){var a={IAS:124,TAS:125,MACH:126,AGPS:129,OAT:128,WIND:127};if($.each(t,function(t,i){var l=i[0],r=i[1],n=a[l],s=!1,o=$("#ems"+l),c="",p='<a href="javascript: void(0);" target="premium" class="'+subscriptionFeatureTooltip+" premium-content disabled featureInfo-"+n+'" data-tooltip-value="'+subscriptionUpgradetext+'" data-tooltip-maxwidth="250px"><svg class="premium-lock"><use xlink:href="#icon-fr24-lock" /></svg></a>';e?(void 0!==selected_data_ems.ems[l]&&("WIND"===l?(s=selected_data_ems.ems[l].split("@"),c=getTooltipUnits(l,parseInt(s[1]))):c=getTooltipUnits(l,s=selected_data_ems.ems[l])),"full"===flightInfoLevel?"WIND"===l&&$.isArray(s)?o.html("<span class='hasTooltip' data-tooltip-value='"+c+" "+s[0]+"&deg'>"+NavigationManager.ConvertUnits(r,s[1])+'</span><span style="transform: rotate('+(parseInt(s[0])+180)+'deg);" class="fa fa-long-arrow-up"></span> '+s[0]+"&deg;"):!1!==s&&""!==s?"MACH"===l?o.html((s/1e3).toFixed(3)+" Ma"):o.html("<span class='hasTooltip' data-tooltip-value='"+c+"'>"+NavigationManager.ConvertUnits(r,s)+"</span>"):o.html("N/A"):o.html(p)):"full"!==aircraftInfoLevel&&-1!==$.inArray(l,selected_data_ems.availability)?o.html(p):o.html("N/A")}),e&&void 0!==selected_data_ems.ems.AGPS&&void 0!==selected_data_ems.ems.OAT&&void 0!==selected_data_ems.ems.QNH&&$("#emsAP").html(atmosphericPressure(selected_data_ems.ems.QNH,selected_data_ems.ems.AGPS,selected_data_ems.ems.OAT)+" hPa"),"full"!==aircraftInfoLevel&&$("#emsAP,#emsWDIR").html('<a href="javascript: void(0);" target="premium" class="'+subscriptionFeatureTooltip+' premium-content disabled featureInfo-53" data-tooltip-value="'+subscriptionUpgradetext+'" data-tooltip-maxwidth="250px"><svg class="premium-lock"><use xlink:href="#icon-fr24-lock" /></svg></a>'),"full"===aircraftInfoLevel)if("full"===flightInfoLevel)selected_data_ems.airspace?$("#firVal").html(selected_data_ems.airspace):1==playback_mode?$("#firVal").html("Not Available"):$("#firVal").html("Position Estimated");else{var i='<a target="premium" href="javascript: void(0);" class="'+subscriptionFeatureTooltip+' premium-content disabled featureInfo-53" data-tooltip-value="'+subscriptionUpgradetext+'" data-tooltip-maxwidth="250px"><svg class="premium-lock"><use xlink:href="#icon-fr24-lock" /></svg></a>';$("#firVal").html(i.replace("featureInfo53","featureInfo120").replace("featureInfo-53","featureInfo-120"))}}else selected_data_ems={ems:{},availability:[],aircraft:null,airspace:""}}function query_flight_data(e,t){if(!0===pauseFeed||!0===map_delays_mode)return!1;if(waiting_for_data=!0,clearTimeout(updateInterval),void 0===plane_list[e])return selected_aircraft=null,aircraftInfoSlideOut(),!1;var a="//"+dispatcher.urls.feedPlaneDetail;a+="/clickhandler/?version=1.5&flight="+e,t&&(a+="&notrail=true"),playback_mode&&0!=playback_fetch_time&&(a+="&history="+Math.floor(playback_fetch_time.getTime()/1e3)),$("body").hasClass("show-left-overlay")||isListView()||isAirportView()||isFleetView()||multi_select_mode||(planeInfoLoadingTimeout=setTimeout(function(){clickLoaderSlideIn("loading")},1e3)),$.ajax(a,{type:"GET",dataType:"json",timeout:7e3,xhrFields:{withCredentials:!0}}).success(function(a){void 0===polylines[e]&&(polylines[e]=[],polylines_index[e]=[]),void 0===polylines_fake[e]&&(polylines_fake[e]=[],polylines_fake_index[e]=[]),multi_select_mode?flight_data_service_cb_multi(a,t,e):flight_data_service_cb(a,t),fetch_plane_list(),updateInterval=setTimeout(function(){query_flight_data(e,!0)},9e4),t||multi_select_mode||aircraftInfoSlideIn()}).fail(function(a){waiting_for_data=!1,t||(selected_aircraft="NULL",a.status,clearTimeout(planeInfoLoadingTimeout),clickLoaderSlideIn("error"),$("#clickLoader button").off("click"),$("#clickLoader button").on("click",function(){$("body").removeClass("loading-left-overlay"),query_flight_data(e)}))})}function draw_fake_polyline(e,t){remove_polylines_fake(e);var a,i,l=plane_list[e]?plane_list[e][7]:"";if(1==t&&polylines[e]&&polylines[e].length>0&&3==selected_count[e]&&1==polylineInCoverage[e]&&(selected_count[e]=0,void 0!==polylines[e][polylines[e].length-1])){n=polylines[e][polylines[e].length-1].getPath().getAt(0);if(plane_list[e][1]!=n.lat()&&plane_list[e][2]!=n.lng()){polyLineCoordinates=[new google.maps.LatLng(plane_list[e][1],plane_list[e][2]),n];var r=meter_to_color(.3048*plane_list[e][4]);l.match(radarRegexp)||(a=null,i=.6,_=new google.maps.Polyline({path:polyLineCoordinates,strokeColor:r,strokeOpacity:i,strokeWeight:3,geodesic:!0,icons:a}),pushPolyPoint(r,[plane_list[e][1],plane_list[e][2]],{time:plane_list[e][10],speed:plane_list[e][5],alt:plane_list[e][4]}),drawPolyPoint(),_.setMap(map),polylines[e].push(_),polylines_index[e][plane_list[e][1]+"/"+plane_list[e][2]]="1")}}if(1==t&&selected_count[e]++,newCoordinate=new google.maps.LatLng(plane_list[e][1],plane_list[e][2]),polylines[e]&&polylines[e].length>0&&void 0!==polylines[e][polylines[e].length-1]){var n=polylines[e][polylines[e].length-1].getPath().getAt(0);if(plane_list[e][1]!=n.lat()&&plane_list[e][2]!=n.lng()){if(polylines_fake[e]||(polylines_fake[e]=[],polylines_fake_index[e]=[]),l.match(radarRegexp))polylineInCoverage[e]=!1,a=[{icon:{path:"M 0,0 0,2",strokeColor:"#000",strokeOpacity:.5},repeat:"10px"}],i=0;else if(a=null,i=.9,!1===polylineInCoverage[e])return selected_count[e]=0,polyLineCoordinates=[newCoordinate,n],_=new google.maps.Polyline({path:polyLineCoordinates,strokeColor:r,strokeOpacity:0,strokeWeight:3,geodesic:!0,icons:[{icon:{path:"M 0,0 0,2",strokeColor:"#000",strokeOpacity:.5},repeat:"10px"}]}),pushPolyPoint(r,[plane_list[e][1],plane_list[e][2]],{time:plane_list[e][10],speed:plane_list[e][5],alt:plane_list[e][4]}),drawPolyPoint(),_.setMap(map),polylines[e].push(_),polylines_index[e][plane_list[e][1]+"/"+plane_list[e][2]]="1",polylineInCoverage[e]=!0,void draw_fake_polyline(e,t);polyLineCoordinates=[newCoordinate,n],(_=new google.maps.Polyline({path:polyLineCoordinates,strokeColor:meter_to_color(.3048*plane_list[e][4]),strokeOpacity:i,strokeWeight:3,geodesic:!0,icons:a})).setMap(map),polylines_fake[e].push(_),polylines_fake_index[e][plane_list[e][1]+"/"+plane_list[e][2]]="1"}}if(1===showRoute&&!0===showRouteEnabled){var s=polylines[e][0].getPath().getAt(1),o=new google.maps.LatLng(selected_data[e].to_pos[0],selected_data[e].to_pos[1]),c=new google.maps.LatLng(selected_data[e].from_pos[0],selected_data[e].from_pos[1]);if(polyLineCoordinates=[o,newCoordinate],(_=new google.maps.Polyline({path:polyLineCoordinates,strokeColor:meter_to_color(.3048*plane_list[e][4]),strokeOpacity:.9,strokeWeight:1,geodesic:!0})).setMap(map),polylines_fake[e].push(_),polyLineCoordinates=[c,s],(_=new google.maps.Polyline({path:polyLineCoordinates,strokeColor:meter_to_color(.3048*plane_list[e][4]),strokeOpacity:.6,strokeWeight:1,geodesic:!0})).setMap(map),polylines_fake[e].push(_),polylines_fake_index[e][plane_list[e][1]+"/"+plane_list[e][2]]="1",selected_data[e].old_pos){var p=new google.maps.LatLng(selected_data[e].old_pos[0],selected_data[e].old_pos[1]),_=new google.maps.Polyline({path:[c,p],strokeColor:"#400",strokeOpacity:0,strokeWeight:2,geodesic:!0,icons:[{icon:{path:"M 0,0 0,2",strokeColor:"#400",strokeOpacity:.4},repeat:"10px"}]});_.setMap(map),polylines_fake[e].push(_)}}}function close_aircraft_data(e){clearTimeout(updateInterval),"undefined"!=typeof cockpitViewModel&&cockpitViewModel.close(function(){getSetting("animate_aircraft")&&(init_anim=1),window.busMan&&window.busMan.hideThreeDAd()}),follow_aircraft=0,1===showRoute&&hideSelectedRoute(!1),e&&1===e||aircraftInfoSlideOut(),$(".aircraft_marker.active").removeClass("active"),$("#follow-aircraft").removeClass("active"),hideShareBox(),remove_label(selected_aircraft),planes_array[selected_aircraft]&&planes_array[selected_aircraft].setIcon(get_sprite(planes_array[selected_aircraft].aircraft_type,planes_array[selected_aircraft].aircraft_track,0,planes_array[selected_aircraft].squawk,planes_array[selected_aircraft].radar,plane_list[selected_aircraft][16])),selected_aircraft="NULL",remove_polylines(),1==simple_mode&&$("#playbackControlsOverlay").removeClass("pushed"),historyReplaceState()}function select_random_aircraft(e){var t=1e3*e,a=map.getBounds(),i=mapCanvasStub.getProjection().fromLatLngToDivPixel(new google.maps.LatLng(a.getNorthEast().lat(),a.getSouthWest().lng())),l=0,r=[];for(n in planes_array)divPos=mapCanvasStub.getProjection().fromLatLngToDivPixel(planes_array[n].position),xpos=divPos.x-i.x,xpos>220&&(r[n]=planes_array[n],l++);if(0==l)return close_aircraft_data(),void(randomAircraft=setTimeout(function(){select_random_aircraft(e)},t));if(plane_to_show=Math.floor(Math.random()*l+1),0==l)return close_aircraft_data(),void(randomAircraft=setTimeout(function(){select_random_aircraft(e)},t));cnt=1;for(var n in r){if(plane_to_show==cnt){if(l>1&&n==selected_aircraft){select_random_aircraft(e);break}if(n==selected_aircraft){randomAircraft=setTimeout(function(){select_random_aircraft(e)},t);break}close_aircraft_data(1),show_aircraft_data(n),r[n].setIcon(get_sprite(r[n].aircraft_type,r[n].aircraft_track,1,r[n].squawk,r[n].radar,plane_list[n][16])),add_label(n),randomAircraft=setTimeout(function(){select_random_aircraft(e)},t)}cnt++}}function add_label(e){planes_array[e]&&!planes_array[e].temp_label&&(planes_array[e].temp_label=new CustomLabel(planes_array[e].getPosition(),map,e,1)),1==show_labels&&planes_array[e]&&planes_array[e].label&&$(planes_array[e].label.div_).hide()}function remove_label(e,t){if(null==e||void 0===e||"null"==e||"NULL"==e)return!1;t=void 0!==t&&t,(selected_aircraft!==e||t)&&planes_array[e]&&planes_array[e].temp_label&&(planes_array[e].temp_label.setMap(null),planes_array[e].temp_label.remove(),planes_array[e].temp_label=null),1==show_labels&&planes_array[e]&&planes_array[e].label&&$(planes_array[e].label.div_).show()}function remove_all_labels(e){if(multi_select_mode)return remove_all_labels_multi(),!1;e=void 0!==e&&e;for(var t in planes_array)planes_array[t].temp_label&&(t!=selected_aircraft||e)&&t!=current_hover&&(planes_array[t].temp_label.setMap(null),planes_array[t].temp_label.remove(),planes_array[t].temp_label=null,planes_array[t].setIcon(get_sprite(plane_list[t][8],plane_list[t][3],0,plane_list[t][6],plane_list[aircraft]?plane_list[aircraft][7]:"",plane_list[t][16])))}function remove_all_labels_multi(e){e=void 0!==e&&e;for(var t in planes_array)planes_array[t].temp_label&&(-1===$.inArray(t,selected_aircraft_array)||e)&&(planes_array[t].temp_label.setMap(null),planes_array[t].temp_label.remove(),planes_array[t].temp_label=null,planes_array[t].setIcon(get_sprite(plane_list[t][8],plane_list[t][3],0,plane_list[t][6],plane_list[aircraft]?plane_list[aircraft][7]:"",plane_list[t][16])))}function delete_all_labels(){for(var e in planes_array)planes_array[e].temp_label&&(planes_array[e].temp_label.setMap(null),planes_array[e].temp_label.remove(),planes_array[e].temp_label=null),planes_array[e].label&&(planes_array[e].label.setMap(null),planes_array[e].label.remove(),planes_array[e].label=null)}function remove_polylines(){if(multi_select_mode)return!1;for($.each(polylines,function(e,t){for(i=0;i<=polylines[e].length-1;i++)polylines[e][i].setMap(null);delete polylines[e],delete polylines_index[e]}),"NULL"!=selected_aircraft&&(polylines_index[selected_aircraft]=[],polylines[selected_aircraft]=[]),remove_polylines_fake(),i=0;i<polyPointCircles.length;i++)polyPointCircles[i].setMap(null);polyPointCircles=[],polyPointCirclesRaw=[],last_polycircle_time=null}function remove_aircraft_polylines(e){if(polylines.hasOwnProperty(e))for(i=0;i<=polylines[e].length-1;i++)polylines[e][i].setMap(null);if(polylines[e]=[],polylines_index[e]=[],polylines_fake.hasOwnProperty(e))for(i=0;i<=polylines_fake[e].length-1;i++)polylines_fake[e][i].setMap(null);polylines_fake[e]=[],polylines_fake_index[e]=[],planes_array[e]&&planes_array[e].label&&(planes_array[e].label.setMap(null),planes_array[e].label=null),planes_array[e]&&planes_array[e].temp_label&&(planes_array[e].temp_label.setMap(null),planes_array[e].temp_label=null),$("#multi_"+e).remove(),-1!==$.inArray(e,selected_aircraft_array)&&(planes_array[e]&&plane_list[e]&&planes_array[e].setIcon(get_sprite(plane_list[e][8],plane_list[e][3],0,plane_list[e][6],plane_list[e]?plane_list[e][7]:"",plane_list[e][16])),selected_aircraft_array.splice($.inArray(e,selected_aircraft_array),1)),0==playback_mode&&0===selected_aircraft_array.length&&(selected_aircraft="NULL",showMultiSelectRoute=!1,$(".flightInfoboxMulti").remove(),update_planes(),statusMultiSelect()),arrangeMultiSelectWindows(),close_aircraft_data(),update_planes()}function remove_polylines_fake(e){$.each(polylines_fake,function(t,a){if(!e||e===t){for(i=0;i<=polylines_fake[t].length-1;i++)polylines_fake[t][i].setMap(null);multi_select_mode||selected_aircraft==t||(delete polylines_fake[t],delete polylines_fake_index[t])}})}function ajax_load(e,t){$("html, body").scrollTop(0),clearTimeout(playbackInterval),clearTimeout(preFetchInterval),clearTimeout(fetchInterval),clearTimeout(aInterval),aInterval=!1,playback_tick_ms=0,playback_fetch_time=0,playback_queue=[],playbackStep=$("#slider-playbackSpeed-value").attr("data-playback-speed")/12,planes_showing=0,planes_array={},plane_list={},map_nav_pins={airport:{}},remove_polylines(),loadFullFeed=!0,map&&google.maps.event.clearInstanceListeners(map),"planes.php"!=t?($("ul.menuChoices li.active").removeClass("active"),$("ul.menuChoices ul.subChoices").hide(),$("ul.menuChoices li").eq(0).addClass("active"),$("ul.menuChoices li").eq(0).find("ul.subChoices").show(),window.busMan&&window.busMan.showMapAds()):window.busMan&&window.busMan.hideMapAds(),-1==e.indexOf("?")?url_query="?":url_query="&",$.get(e+url_query+"ajax",function(e){$("#content-container").html(e),$("body").css("cursor","auto"),$("#loading").hide()})}function setSetting(e,t,a){return-1===$.inArray(e,ignoredSettings)&&void 0!==NavigationManager&&NavigationManager.setClientSetting&&NavigationManager.setClientSetting(e,t,a),_objLocalStorage.hasLocalStorage()?_objLocalStorage.setItem(e,t):setCookie(e,t,a)}function getSetting(e){return _objLocalStorage.hasLocalStorage()?_objLocalStorage.getItem(e):getCookie(e)}function setCookie(e,t,a,i){if(!1===simple_mode){var l=new Date;l.setDate(l.getDate()+a);var i=void 0!==i?";domain="+i:"";document.cookie=e+"="+escape(t)+i+(null===a?"":";expires="+l.toUTCString()+";path=/")}}function getCookie(e){return!1===simple_mode&&document.cookie.length>0&&(c_start=document.cookie.indexOf(e+"="),-1!=c_start)?(c_start=c_start+e.length+1,c_end=document.cookie.indexOf(";",c_start),-1==c_end&&(c_end=document.cookie.length),unescape(document.cookie.substring(c_start,c_end))):null}function getQuerystring(e,t){var a;a=-1==window.location.href.indexOf("#!/")?window.location.href:window.location.href.split("#!/")[1],null==t&&(t=""),e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var i=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(a);return null==i?t:i[1]}function exit_map(){$("#map_canvas").length>0&&"object"!=typeof b2bSidebar&&($("#disable-page-text").show(),clearTimeout(fetchInterval),clearTimeout(aInterval),aInterval=!1,clearInterval(mediaFeedInterval),a_active=0,clearTimeout(preFetchInterval),preFetchInterval=!1,1===playback_play&&(clearTimeout(playbackInterval),playbackInterval=!1,playback_mode=0,playback_play=0,playback_time=0,playback_fetch_time=0),"NULL"!=selected_aircraft&&(remove_label("aircraft_"+selected_aircraft,!0),close_aircraft_data()),$(".modalContainer").hide(),blackoutMap(),$("#modalBlackout").addClass("timeout"))}function add_filter(e,t,a,i){i||(i="standard"),filters.length<max_filters&&filters.push([e,t,a]),"standard"==i&&(delete_all_planes(),clearTimeout(fetchInterval),fetch_plane_list())}function show_utc_time(){var e=new Date;UTC_time=add_zero(String(e.getUTCHours()))+add_zero(String(e.getUTCMinutes())),updateTimeWidget(UTC_time),timeInterval=setTimeout(function(){show_utc_time()},1e4)}function updateTimeWidget(e){$(".timeWidget span").attr("class",""),$(".timeWidget span").eq(0).addClass("nr"+e.substr(0,1)),$(".timeWidget span").eq(1).addClass("nr"+e.substr(1,1)),$(".timeWidget span").eq(2).addClass("nrx"),$(".timeWidget span").eq(3).addClass("nr"+e.substr(2,1)),$(".timeWidget span").eq(4).addClass("nr"+e.substr(3,1))}function add_zero(e){return 1==(e=String(e)).length?"0"+e:e}function playback_start(e,t){if($("#playbackOverlay").hide(),$("#fr24_ViewsDropdown a[data-value='delay'], #fr24_ViewsDropdown a[data-value='airport']").parent().addClass("notAllowed"),-1!==$.inArray(map_left_menu_view,["delayView","airportView"])&&($('#fr24_ViewsDropdown li a[data-value="map"]').trigger("click"),map_left_menu_view="mapView"),multi_select_mode){var a=[];$.each(selected_aircraft_array,function(e,t){a.push(t)}),$.each(a,function(e,t){t&&remove_aircraft_polylines(t)}),showMultiSelectRoute=!1,selected_aircraft_array=[],statusMultiSelect()}setTimeout(function(){adjustViewHeight()},500),playback_queue=[],playback_mode=1,playback_play=1,playback_fetch_time=0,playbackTimeline=null,selected_time=new Date($("#playback-date").val().substr(5,2)+"/"+$("#playback-date").val().substr(8,2)+"/"+$("#playback-date").val().substr(0,4)+" "+$("#playback-hour").val()+":"+$("#playback-minute").val()+":00"),playback_time=void 0!==e?e:selected_time,playbackStep=1,updateTimeWidget(add_zero(playback_time.getHours())+add_zero(playback_time.getMinutes())),$("#playback-step-back").attr("disabled",!0),$("#playback-step-forward").attr("disabled",!0),$(".aircraft_marker.active .aircraft_label_container").remove(),close_aircraft_data(),clearTimeout(fetchInterval),plane_list={},delete_all_planes(),playback_speed=$("#playback-speed").val(),$("#slider-playbackSpeed").slider("value",playback_speed),$("#slider-playbackSpeed-value").html(playback_speed+"x").attr("data-playback-speed",playback_speed),$("#playback-pause").removeClass("play").addClass("pause"),$("#playbackControlsOverlay").fadeIn(),window.busMan&&window.busMan.hideMapAds(),drawPlaybackTimeline(),$("#playbackChoice, #playbackStatus").html(timeline_options.DAYS_SHORT[playback_time.getDay()]+", "+timeline_options.MONTHS_SHORT[playback_time.getMonth()]+" "+playback_time.getDate()+", "+playback_time.getFullYear()+", "+add_zero(playback_time.getHours())+":"+add_zero(playback_time.getMinutes())),clearTimeout(timeInterval),clearTimeout(aInterval),aInterval=!1,init_call=void 0!==t?t:0,fetch_playback_list(),1==init_lightning&&lightningLayer.hideLightning(),$(".weather-tile.toggle.on").each(function(){var e=$(this).data("value");void 0!==$(this).data("point-query")&&(void 0!==pointQueries[e]&&pointQueries[e].destroy(),delete pointQueries[e]),weatherTiles[e].remove()}),1==init_weather&&weatherLayer.resetData(),"object"==typeof _gaq&&_gaq.push(["_trackPageview","/playback"])}function playback_exit(e){if($("body").removeClass("show-playback-overlay"),$("#fr24_ViewsDropdown a[data-value='delay'], #fr24_ViewsDropdown a[data-value='airport']").parent().removeClass("notAllowed"),multi_select_mode){var t=[];$.each(selected_aircraft_array,function(e,a){t.push(a)}),$.each(t,function(e,t){t&&remove_aircraft_polylines(t)}),showMultiSelectRoute=!1,selected_aircraft_array=[],statusMultiSelect()}setTimeout(function(){adjustViewHeight()},500);var a=selected_aircraft,i=follow_aircraft;clearTimeout(playbackInterval),clearTimeout(preFetchInterval),playbackInterval=!1,playback_mode=0,playback_play=0,playback_time=0,playback_fetch_time=0,playbackTimeline=null,$("#playbackChoice, #playbackStatus").html("Playback"),updateNiteOverlay(),$(".aircraft_marker.active .aircraft_label_container").remove(),1!=e&&close_aircraft_data(),plane_list={},delete_all_planes(),$("#playbackControlsOverlay").hide(),window.busMan&&window.busMan.showMapAds(),show_utc_time(),fetch_plane_list(),1==e&&""!=a&&(selected_aircraft=a,a="",follow_aircraft=i,i=""),$(".weather-tile.toggle.on").each(function(){var e=$(this).data("value"),t=$(this).data("point-query");void 0!==t&&(pointQueries[e]?pointQueries[e]:pointQueries[e]=new window[t],pointQueries[e].init()),weatherTiles[e].show()}),1==init_lightning&&lightningLayer.initializeLightning(),1==init_weather&&weatherLayer.initializeWeather(),historyReplaceState()}function playback_change_time(e){clock_interval=playbackStep<1&&playbackStep>0?5e3/playbackStep:5e3,clearTimeout(playbackInterval),playbackInterval=setTimeout("playback_change_time('')",clock_interval),1==playback_mode&&(playbackStep=$("#slider-playbackSpeed-value").attr("data-playback-speed")/12,0==playback_play&&0==e?(playback_time.setMinutes(playback_time.getMinutes()-Math.ceil(playbackStep)),setTimeout(enable_playback_buttons,3e3)):0==playback_play&&1==e?(playback_time.setMinutes(playback_time.getMinutes()+Math.ceil(playbackStep)),setTimeout(enable_playback_buttons,3e3)):1==playback_play&&""==e&&playback_time.setMinutes(playback_time.getMinutes()+Math.ceil(playbackStep)),$("#playbackChoice, #playbackStatus, span#playback-date").html(timeline_options.DAYS_SHORT[playback_time.getDay()]+", "+timeline_options.MONTHS_SHORT[playback_time.getMonth()]+" "+playback_time.getDate()+", "+playback_time.getFullYear()+", "+add_zero(playback_time.getHours())+":"+add_zero(playback_time.getMinutes())),updateTimeWidget(add_zero(playback_time.getHours())+add_zero(playback_time.getMinutes())),multi_select_mode?isDragged?(isDragged=!1,remove_all_labels_multi(!0)):remove_all_labels_multi():remove_all_labels())}function playback_change_fetch_time(){if(1==waiting_for_pb_data)return pb_data_fail_timeout||(pb_data_fail_timeout=setInterval("playback_change_fetch_time('')",1e3)),void pb_data_fail_count++;pb_data_fail_count=0,clearInterval(pb_data_fail_timeout),pb_data_fail_timeout="",1==playback_mode&&(0==playback_fetch_time&&(playback_fetch_time=new Date(playback_time.getTime())),playbackStep=$("#slider-playbackSpeed-value").attr("data-playback-speed")/12,playback_fetch_time.setMinutes(playback_fetch_time.getMinutes()+Math.ceil(playbackStep)),fetch_playback_list())}function enable_playback_buttons(){0==playback_play&&($("#playback-step-back").attr("disabled",!1),$("#playback-step-forward").attr("disabled",!1),$("#playback-pause").attr("disabled",!1))}function fetch_playback_list(){fetch_airport_list(),0==playback_fetch_time&&(playback_fetch_time=new Date(playback_time.getTime()));var e=map.getBounds().getNorthEast().lat(),t=map.getBounds().getNorthEast().lng(),a=map.getBounds().getSouthWest().lat(),i=map.getBounds().getSouthWest().lng(),l=override_filters(),r=new Date(playback_fetch_time.getUTCFullYear(),playback_fetch_time.getUTCMonth(),playback_fetch_time.getUTCDate(),playback_fetch_time.getUTCHours(),playback_fetch_time.getUTCMinutes()),n=new Date,s=parseInt(dispatcher.userFeatures["history.playback.global.days"]);if(Math.floor((n-r)/864e5)>=s){var o=new Date(n.setDate(n.getDate()-s));r=playback_time=playback_fetch_time=o,setTimelineCustomeTime()}var c;if(c=l?"1&maxage=14400":estimated_traffic>0?"1&maxage="+60*estimated_traffic:"0&maxage=0",r.setUTCFullYear(playback_fetch_time.getFullYear()),r.setUTCMonth(playback_fetch_time.getMonth()),r.setUTCDate(playback_fetch_time.getDate()),r.setUTCHours(playback_fetch_time.getHours()),r.setUTCMinutes(playback_fetch_time.getMinutes()),(n=new Date).setFullYear(n.getUTCFullYear()),n.setMonth(n.getUTCMonth()),n.setDate(n.getUTCDate()),n.setHours(n.getUTCHours()),n.setMinutes(n.getUTCMinutes()),playback_fetch_time.getTime()<=n.getTime()){var p="/zones/fcgi/feed.js?bounds="+Math.ceil(e)+","+Math.floor(a)+","+Math.floor(i)+","+Math.ceil(t)+"&faa="+(1==faa_traffic||l?1:0)+"&mlat="+(1==mlat_traffic||l?1:0)+"&flarm="+(1==flarm_traffic||l?1:0)+"&adsb="+(1==adsb_traffic||l?1:0)+"&gnd="+(1===ground_traffic||l?1:0)+"&air="+(1===airborn_traffic||l?1:0)+"&vehicles="+(1===vehicular_traffic||l?1:0)+"&estimated="+c+"&gliders="+(1===glider_traffic||l?1:0)+"&stats=1&history="+Math.floor(r.getTime()/1e3)+"&prefetch="+5*playback_speed;(null!==selected_aircraft&&"NULL"!==selected_aircraft||selected_aircraft_array.length>0)&&(p+="&selected="+(selected_aircraft_array.length>0?selected_aircraft_array.join(","):selected_aircraft),p+="&ems=1"),cookie_enc&&(p+="&enc="+cookie_enc);var _=build_filter_params();_&&(p+="&"+_),p+=addPublicKey();var d="//"+dispatcher.urls.feedPlayback+p;waiting_for_pb_data=!0,updateNiteOverlay(r),$.ajax(d,{jsonpCallback:"fetch_playback_cb",type:"GET",dataType:"jsonp",timeout:1e4}).error(function(e){void 0===preFetchInterval?(waiting_for_pb_data=!1,setTimeout("fetch_playback_list()",4e3)):(waiting_for_pb_data=!1,clearInterval(preFetchInterval),200===e.status?(playback_change_fetch_time(""),preFetchInterval=setInterval("playback_change_fetch_time('')",clock_interval)):preFetchInterval=setInterval("playback_change_fetch_time('')",clock_interval))})}else playback_fetch_time.setHours(n.getHours()),playback_fetch_time.setMinutes(n.getMinutes()-playback_speed),playback_time.setHours(n.getHours()),playback_time.setMinutes(n.getMinutes()-playback_speed),playback_fetch_time=0,playback_change_fetch_time();historyReplaceState()}function fetch_playback_cb(e){if(void 0!==e.version&&delete e.version,void 0!==e.full_count&&delete e.full_count,void 0!==e.stats&&(showStats(e.stats),delete e.stats),waiting_for_pb_data=!1,1==playback_mode){if(multi_select_mode?isDragged?remove_all_labels_multi(!0):remove_all_labels_multi():remove_all_labels(),"object"!=typeof e||0==e.success)playback_exit(1),a_active=0,clearTimeout(aInterval);else{if(0==playback_play)return plane_list_next=e,plane_list=e,plane_list_org=e,filters.length>0&&!override_filters()&&$.each(plane_list,function(e,t){check_filter(e,t)||delete plane_list[e]}),step_playback_queue(e),void($("#map_canvas").length>0&&mapCanvasStub.getProjection()&&update_planes());playback_queue.length<=2&&!aInterval?(0==playback_queue.length&&($("#map_canvas").length>0&&mapCanvasStub.getProjection()&&delete_all_planes(),delete_all_labels(),planes_array={},plane_list={},planes_array_fake={},a_active=0,clearTimeout(aInterval),aInterval=!1,plane_list_next=e,plane_list=e,plane_list_org=e,filters.length>0&&!override_filters()&&$.each(plane_list,function(e,t){check_filter(e,t)||delete plane_list[e]}),update_planes()),planes_showing=getLength(plane_list),playback_queue.unshift(e),clearTimeout(preFetchInterval),playback_change_fetch_time()):aInterval?(preFetchInterval||(preFetchInterval=setInterval("playback_change_fetch_time('')",clock_interval)),playback_queue.unshift(e)):(update_planes(),a_active=1,playback_queue.unshift(e),playback_queue.pop(),step_playback_queue(e=playback_queue.pop()),clearTimeout(aInterval),aInterval=setTimeout(animate_playback,1e3),clearTimeout(preFetchInterval),preFetchInterval=setInterval("playback_change_fetch_time('')",clock_interval)),setTimelineCustomeTime()}1==playback_play&&aInterval&&(playbackInterval||(playbackInterval=setTimeout("playback_change_time('')",clock_interval)))}}function step_playback_queue(e){plane_list=plane_list_next,plane_list_next=e,plane_list_org=$.extend(!0,{},plane_list),filters.length>0&&!override_filters()&&$.each(plane_list,function(e,t){check_filter(e,t)||delete plane_list[e]}),$("#map_canvas").length>0&&mapCanvasStub.getProjection()&&update_planes(),multi_select_mode&&selected_aircraft_array.length>0&&1!=init_call?($.each(selected_aircraft_array,function(e,t){show_aircraft_data(selected_aircraft=t,1)}),selected_aircraft="NULL"):multi_select_mode||"NULL"===selected_aircraft||1==init_call||show_aircraft_data(selected_aircraft,1)}function show_ash_layer(){}function draw_map_layer(){for(var e=0;e<map_layers.length;e++)map_layers[e].setMap(map)}function get_ash_layer(){var e,t,a;if("undefined"!=typeof restrictionZones)for(var i in restrictionZones){e=[],a=restrictionZones[i].area;for(var l in a)e.push(new google.maps.LatLng(a[l][0],a[l][1]));t=new google.maps.Polygon({paths:e,strokeColor:"#000000",strokeOpacity:.6,strokeWeight:1,fillColor:"#000000",geodesic:!0,fillOpacity:.35}),map_layers.push(t)}draw_map_layer()}function get_ash_layer_orig(e){$.getJSON(dispatcher.urls.site+"/AshCloudService.php?valid="+init_ash_valid+"&alt="+e,function(e){var t=[];for(var a in e)t.push(new google.maps.LatLng(e[a][0],e[a][1]));poly_layer=new google.maps.Polygon({paths:t,strokeColor:"#000000",strokeOpacity:.6,strokeWeight:1,fillColor:"#000000",fillOpacity:.35}),map_layers.push(poly_layer),draw_map_layer()})}function remove_layers(){for(i=0;i<map_layers.length;i++)map_layers[i].setMap(null);map_layers=[]}function get_mediaFeeds(){return!0!==pauseFeed&&(null!==mediaFeedInterval&&(!0!==$("#mapView").is(":visible")||!0===$("#disable-page-text").is(":visible")||void 0===map||$("#mapDynamicOverlays").children(":visible").length>0)||void $.getJSON(dispatcher.urls.site+"/mediafeed",function(e){var t="",a="";$.each(e.twitter,function(e,a){t+="<hr />",t+="<div>",t+='<span class="twitterText">'+a.text+"</span>",t+='<span class="twitterTime">'+a.time+"</span>",t+="</div>"}),$.each(e.blog,function(e,t){t.text&&(a+="<hr />",a+="<div>",a+='<span class="blogText">'+t.text+"</span>",a+='<span class="blogTime">'+t.time+"</span>",a+="</div>")}),$("#latestTwitterContainer").html(t),$("#latestBlogContainer").html(a),getMediaFeedLimits()}))}function get_querystrings(){var e,t=0,a=!1;if((e=(e=(e=-1==window.location.href.indexOf("#!/")?window.location.href:window.location.href.split("#!/")[1]).replace(dispatcher.urls.site+"/","").replace("?ref=nf","")).split("/"))&&e[0]&&-1!==$.inArray(e[0],["mapview","multiview","delayview","listview","airportview","fleetview","radarview"])){var i=e[0].replace("view",""),l=i+"View",r=$("#fr24_ViewsDropdown a[data-value='"+i+"']");if(e.splice(0,1),"airport"===i){n=/^[a-z]{3}$/i;e[0]&&n.test(e[0])&&(setSetting("airportViewAirport",e[0].toUpperCase()),e.splice(0,1),setSetting("map_left_menu_view",map_left_menu_view="airportView")),angular.element("#fr24_ViewsDropdown").scope().openAirportView(getSetting("airportViewAirport"))}else if("fleet"===i){setSetting("fleetViewAirlineRecent",getSetting("fleetViewAirline"));var n=/^[a-z]{3}$/i,s={airline:null,fleet:null};e[0]&&n.test(e[0])?(s.airline=e[0].toUpperCase(),setSetting("fleetViewAirline",s),e.splice(0,1),angular.element("#fr24_ViewsDropdown").scope().openFleetView(s.airline)):e[0]&&0===e[0].indexOf("custom-")?(s.fleet=e[0].substring(7),setSetting("fleetViewAirline",s),e.splice(0,1),angular.element("#fr24_ViewsDropdown").scope().openFleetView(s.fleet,!0)):(s=_objLocalStorage.getItem("fleetViewAirline"))&&s.airline?angular.element("#fr24_ViewsDropdown").scope().openFleetView(s.airline):s&&s.fleet?angular.element("#fr24_ViewsDropdown").scope().openFleetView(s.fleet,!0):angular.element("#fr24_ViewsDropdown").scope().openFleetView("SAS")}else{angular.element(r).triggerHandler("click");n=/^[a-z0-9,]+$/i;"multiView"===l&&void 0!==e[0]&&n.test(e[0])&&(selected_aircraft_array=[],$.each(e[0].split(","),function(e,t){var a=$.trim(t);if(a&&a.length>3&&addMultiSelect(a),selected_aircraft_array.length>selected_aircraft_limit)return!1}),statusMultiSelect())}"airport"!==i&&"fleet"!==i||angular.element($("#fr24_ViewsDropdownContainer")).triggerHandler("click")}else a=!0;""!=e[0]&&""!=e[1]&&/^\d{4}-\d{2}-\d{2}$/.test(e[0])&&/^\d{2}:\d{2}$/.test(e[1])&&(query_pb_date=e[0],query_pb_time=e[1],e[2]&&/^\d{2}x$/.test(e[2])?((playback_speed=parseInt(e[2].replace("x","")))%12==0&&playback_speed>=12&&playback_speed<=120&&($("#slider-playbackSpeed-value").html(playback_speed+"x"),$("#slider-playbackSpeed-value").attr("data-playback-speed",playback_speed),$("#slider-playbackSpeed").slider("value",playback_speed)),t=3):t=2),e[0+t]&&"filter"==e[0+t]&&e[1+t]&&/^[A-Za-z]{3}$/.test(e[1+t])?(add_filter("callsign",e[1+t].toUpperCase()),init_filter_check=1):e[0+t]&&"airport"==e[0+t]&&e[1+t]&&("delay"===e[1+t]||/^[A-Za-z]{3}$/.test(e[1+t]))?/^[A-Za-z]{3}$/.test(e[1+t])&&(query_airport=e[1+t].toUpperCase(),e[2+t]&&"info"==e[2+t]&&(query_airportInfo=1)):e[0+t]&&"planes"==e[0+t]||(e[0+t]&&""!=e[0+t]&&/^[A-Za-z0-9_-]{3,8}(\/[a-fA-F0-9]+)?$/.test(e[0+t])?(query_callsign=e[0+t],"solo"==e[1+t]?(query_solo=1,add_filter("callsign",query_callsign.toUpperCase()),init_filter_check=1):"view"==e[1+t]?query_view=1:0===selected_aircraft_array.length&&e[1+t]&&(query_callsign=e[1+t],selected_aircraft=query_callsign,a&&(map_left_menu_view="mapView",$("#fr24_ViewsDropdown a[data-value='map']").triggerHandler("click"))),"flight"!=e[0+t]&&"reg"!=e[0+t]||(query_callsign="",selected_aircraft="NULL",map_left_menu_view="mapView",$("#fr24_ViewsDropdown a[data-value='map']").triggerHandler("click")),$query_callsign=query_callsign,"3d"===e[e.length-1].toLowerCase()&&(load3dView=!0),e[0]&&"flight"!==e[0]&&"reg"!==e[0]&&(init_goto_aircraft="NULL"!==selected_aircraft?"selected":"query_callsign")):e[0+t]&&""!=e[0+t]&&/^[0-9\.-]+$/.test(e[0+t].split(",")[0])&&/^[0-9\.-]+$/.test(e[0+t].split(",")[1])&&(query_lat=e[0+t].split(",")[0],query_lon=e[0+t].split(",")[1],query_z=e[1+t]&&""!=e[1+t]&&/^\d{1,2}$/.test(e[1+t])?e[1+t]:7))}function get_querystrings_simple(){if(query_lat=getQuerystring("lat",""),query_lon=getQuerystring("lon",""),query_z=getQuerystring("z",""),query_type=getQuerystring("filter_type",""),query_filter_callsign=getQuerystring("filter_callsign",""),query_airports=getQuerystring("airports"),query_pb_date_test=getQuerystring("pb_date"),query_pb_time_test=getQuerystring("pb_time"),query_callsign_test=getQuerystring("callsign"),query_flight_id=getQuerystring("flight_id"),query_solo=getQuerystring("solo"),query_label1=getQuerystring("label1"),query_label2=getQuerystring("label2"),query_label3=getQuerystring("label3"),query_clouds=getQuerystring("clouds"),query_weather=getQuerystring("weather"),query_faa=getQuerystring("faa"),query_ground=getQuerystring("ground"),query_size=getQuerystring("size"),query_color=getQuerystring("color"),query_cycle_interval=getQuerystring("cycle"),query_filter_airport=getQuerystring("airport_filter"),query_single=getQuerystring("single"),query_noinfo=getQuerystring("noinfo"),query_maptype=getQuerystring("maptype"),query_brightness=getQuerystring("brightness"),query_trail=getQuerystring("trail"),query_follow=getQuerystring("follow"),query_flight=getQuerystring("flight"),paramMinAlt>paramMaxAlt?alert("Sorry, but minAlt param cannot be greater than maxAlt param"):filters.push(["altitude",paramMinAlt,paramMaxAlt]),paramMinSpeed>paramMaxSpeed?alert("Sorry, but minSpeed param cannot be greater than maxSpeed param"):filters.push(["speed",paramMinSpeed,paramMaxSpeed]),parseInt(query_cycle_interval)>0&&(select_interval=parseInt(query_cycle_interval),randomAircraft=setTimeout(function(){select_random_aircraft(select_interval)},5e3)),""!=query_trail&&(trail_color=query_trail),""!=query_follow&&(init_follow=query_follow),""!=query_brightness&&(query_brightness=parseInt(query_brightness),query_brightness>100&&(query_brightness=100),query_brightness<0&&(query_brightness=0),init_fade=100-query_brightness),""!=query_maptype&&(mapTypes={1:google.maps.MapTypeId.ROADMAP,2:google.maps.MapTypeId.TERRAIN,3:google.maps.MapTypeId.SATELLITE,4:google.maps.MapTypeId.HYBRID,5:"simple_style",6:"radar_style",7:"radar_style2",8:"gray_style",9:"aubergine_style"},init_type=mapTypes[query_maptype]),""!=query_label1&&(init_label_1=query_label1,init_labels=1),""!=query_label2&&(init_label_2=query_label2,init_labels=1),""!=query_label3&&(init_label_3=query_label3,init_labels=1),""!=query_faa&&(faa_traffic=query_faa),""!=query_ground&&(ground_traffic=query_ground),""!=query_size&&(init_aircraft_size=query_size),parseInt(query_airports)>0&&(init_airports=1,parseInt(query_airports)>1&&(init_airport_density=query_airports)),parseInt(query_clouds)>0&&(init_clouds=query_clouds,weather_tile_global_radar=1,new WeatherTileLayer("C09-0x0316-0",!1).show(),parseInt(query_clouds)>1&&(weather_tile_ir_satellite=1,new WeatherTileLayer("C09-0x0374-0",!1).show())),""!=query_weather&&(init_weather=query_weather),""!=query_type&&null!==query_type){var e=query_type.split(",");for(var t in e)filters.push(["aircraft",e[t].toUpperCase()])}if(""!=query_filter_callsign&&null!==query_filter_callsign){var a=query_filter_callsign.split(",");for(var t in a)filters.push(["callsign",a[t].toUpperCase()])}if(""!=query_filter_airport){var i=new Array,l=query_filter_airport.split(":");i[0]="airport",i[1]=l[1],i[2]=l[0].toUpperCase(),filters.push(i)}if(parseFloat(query_lat)&&parseFloat(query_lon)&&query_lon>-180&&query_lon<180&&(init_lat=query_lat,init_lon=query_lon),parseFloat(query_z)&&query_z<=15&&query_z>1&&(init_zoom=parseFloat(query_z)),query_reg=getQuerystring("reg",""),query_reg=""===query_reg?getQuerystring("_reg",""):query_reg,"1"==query_solo&&""!=query_reg){var r=new Array;r[0]="reg",r[1]=query_reg.toUpperCase(),filters.push(r),init_reg=query_reg,init_call=query_reg,geolocation_move=!1}if(""!=query_reg&&fetchAircraftByReg(),query_flight=getQuerystring("flight",""),""!=query_flight){if("1"==query_solo){var n=new Array;n[0]="flight",n[1]=query_flight.toUpperCase(),filters.push(n),geolocation_move=!1}init_call=query_flight}if(""!=query_pb_date_test&&""!=query_pb_time_test&&/^\d{4}-\d{2}-\d{2}$/.test(query_pb_date_test)&&/^\d{2}:\d{2}$/.test(query_pb_time_test)&&(query_pb_date=query_pb_date_test,query_pb_time=query_pb_time_test),""!=query_callsign_test&&/^[A-Za-z0-9_-]{3,8}$/.test(query_callsign_test)&&(query_callsign=query_flight_id||query_callsign_test,"1"==query_solo))if(query_flight_id){var s=new Array;s[0]="flight_id",s[1]=query_flight_id,filters.push(s)}else{var o=new Array;o[0]="callsign_solo",o[1]=query_callsign.toUpperCase(),filters.push(o)}""!==query_noinfo&&"1"===query_noinfo&&$("#leftColOverlay, #cnt-panel-clickhandler").remove()}function round_to_15(e){if(0==e)return"unknown";switch(e=10*Math.round(e/10)){case 0:return 0;case 10:case 20:return 15;case 30:return 30;case 40:case 50:return 45;case 60:return 60;case 70:case 80:return 75;case 90:return 90;case 100:case 110:return 105;case 120:return 120;case 130:case 140:return 135;case 150:return 150;case 160:case 170:return 165;case 180:return 180;case 190:case 200:return 195;case 210:return 210;case 220:case 230:return 225;case 240:return 240;case 250:case 260:return 255;case 270:return 270;case 280:case 290:return 285;case 300:return 300;case 310:case 320:return 315;case 330:return 330;case 340:case 350:return 345;case 360:return 0;default:return"unknown"}}function meter_to_color(e){return void 0===trail_color&&(trail_color="rainbow"),"grayscale"==trail_color?grayscale(meter_to_color_data(e)):"rainbow"==trail_color?meter_to_color_data(e):trail_color}function meter_to_color_data(e){return e>13e3?"#ff0000":e>12500?"#ff00e4":e>12e3?"#d800ff":e>11500?"#ae00ff":e>11e3?"#9600ff":e>10500?"#7800ff":e>1e4?"#6000ff":e>9500?"#4e00ff":e>9e3?"#3600ff":e>8500?"#2400ff":e>8500?"#1200ff":e>7500?"#0000ff":e>7e3?"#001eff":e>6500?"#0030ff":e>6e3?"#0054ff":e>5500?"#0078ff":e>5e3?"#0096ff":e>4500?"#00a8ff":e>4e3?"#00c0ff":e>3500?"#00eaff":e>3e3?"#00ffe4":e>2500?"#00ffd2":e>2e3?"#00ff9c":e>1500?"#00ff72":e>1200?"#00ff36":e>1e3?"#00ff0c":e>800?"#1eff00":e>600?"#42ff00":e>400?"#ccff00":e>300?"#f0ff00":e>200?"#ffea00":e>100?"#ffe062":e<100?"#ffffff":void 0}function grayscale(e){var t=/#(\w{2})(\w{2})(\w{2})/.exec(e),a=parseInt(t[1],16),i=parseInt(t[2],16),l=parseInt(t[3],16),r=Math.floor(.2126*a+.7152*i+.0722*l);return result="rgb("+r+","+r+","+r+")",result}function show_airport_info(e,t){if(!("fetch"in window)){var a=document.createElement("script");a.id="script-fetch",a.type="text/javascript",a.async=!1,a.src="https://cdnjs.cloudflare.com/ajax/libs/fetch/2.0.3/fetch.min.js";var i=document.getElementsByTagName("script")[0];i.parentNode.insertBefore(a,i.nextSibling)}var l=getCookie("_frPl")||"";switch(e=e.toString().replace(/[^a-z0-9]/gi,""),t){case"arr":case"arrival":case"arrivals":t="arrivals";break;case"dep":case"departure":case"departures":t="departures";break;case"gro":case"ground":t="ground";break;default:t="arrivals"}return fetch(dispatcher.urls.api+"/common/v1/airport.json?code="+e+"&plugin%5Bdetails%5D=details&token="+l,{method:"GET",mode:"cors",headers:{"Access-Control-Request-Headers":"*",Accept:"application/json"},redirect:"follow"}).then(function(e){return e.json().then(function(e){var a=setInterval(function(){if(map){clearInterval(a);var i=e.result.response.airport.pluginData.details;map.panTo(new google.maps.LatLng(i.position.latitude,i.position.longitude));var l=setInterval(function(){if(isset(airport_index,i.code.iata)){var e="";t?e=t:window.location.pathname.match(/\/airport\/[a-z0-9]{3}\/(arrivals|departures|ground)/gi)&&(e=window.location.pathname.match(/(arrivals|departures|ground)/gi)[0]);var a=Fr24.AirportPanel.getCurrentAirportIata();Fr24.AirportPanel.setCurrentAirportIata(i.code.iata).setCurrentAirportMarker(airport_index[i.code.iata].marker),Fr24.AirportPanel.isOpen()&&String(a).toUpperCase()===i.code.iata.toUpperCase()||Fr24.AirportPanel.open(e),objSelectedAirportMarker=airport_index[i.code.iata].marker,clearInterval(l)}},100)}},100)})}),!0}function show_reg_info(e){if(""===e)return!1;window.location.href="/data/aircraft/"+e}function show_flight_info(e){if(""===e)return!1;window.location.href="/data/flights/"+e.toLowerCase()}function show_planes_info(){}function show_delays_info(){}function get_airport_flights(e,t,a){$("#modalContent .flightList").hide(),$("#airportLoader").show(),$.getJSON(dispatcher.urls.site+"/AirportInfoService.php?airport="+e[1]+"&type="+t+(a&&1==a?"&info":""),function(i){$("#airportLoader").hide();var l="";if(flight_list=sort_flight_list(e,t,i.flights),"in"==t){row_count=0;for(var r in flight_list){row_count++;var n=minutesToHHMM((flight_list[r].expected.getTime()-timeLocal.getTime())/1e3/60);l+='<tr class="'+(row_count%2==0?"dark":"")+'"><td class="first">'+flight_list[r].callsign+"</td><td>"+flight_list[r].flight+"</td><td>"+flight_list[r].name+"</td><td>"+flight_list[r].type+"</td><td>"+add_zero(flight_list[r].expected.getUTCHours())+":"+add_zero(flight_list[r].expected.getUTCMinutes())+' <span class="small">('+n+')</span></td><td style="text-align: right;"><button class="standardButton aircraftLink" style="height: 1.6em;" data-aircraft="'+flight_list[r].callsign+'">Go to</button></td></tr>'}0==row_count&&(l='<tr><td colspan="6" style="text-align: center; padding: 20px; font-size: 2em; color: #aaa; font-weight: bold;">No flights</td></tr>'),$("#airportInboundList tbody").html(l),$("#airportInboundList").show()}else if("out"==t){row_count=0;for(var r in flight_list)row_count++,l+='<tr class="'+(row_count%2==0?"dark":"")+'"><td class="first">'+flight_list[r].callsign+"</td><td>"+flight_list[r].flight+"</td><td>"+flight_list[r].name+"</td><td>"+flight_list[r].type+'</td><td style="text-align: right;"><button class="standardButton aircraftLink" style="height: 1.6em;" data-aircraft="'+flight_list[r].callsign+'">Go to</button></td></tr>';0==row_count&&(l='<tr><td colspan="5" style="text-align: center; padding: 20px; font-size: 2em; color: #aaa; font-weight: bold;">No flights</td></tr>'),$("#airportOutboundList tbody").html(l),$("#airportOutboundList").show()}if(a&&1==a){$("#airportRating a").html('<img src="/static/images/ratings/black/'+i.rating+'.png" alt="" />'),$("#airportComment").html(i.comment),$("#modalBottom #bottomRight a").attr("href",i.url),$("#weatherWidgetTemp img").addClass("weather"+i.weather.summary.icon).attr("title",i.weather.summary.icon),$("#weatherWidgetTemp span").html("<h3>"+i.weather.summary.temp+"</h3>QNH "+i.weather.summary.qnh),$("#weatherWidgetWind img").addClass("wind"+i.weather.wind.icon).attr("title",i.weather.wind.icon+" winds"),$("#weatherWidgetWind span").html("<h3>"+i.weather.wind.speed+"</h3>"+i.weather.wind.direction);var s=i.weather.metar,o=s;s.length>112&&(s=s.substring(0,112)+"..."),$("#modalBottom #bottomLeft p").html(s).attr("title",o)}})}function sort_flight_list(e,t,a){for(var i in a){var l=calculateDistanceBetween(e[3],e[4],a[i].lat,a[i].lon);if(l*=1.03,a[i].dist=l,"in"!=t);else{if(0==a[i].eta||a[i].eta<timeLocal.getTime()/1e3){delete a[i];continue}a[i].expected=new Date(1e3*a[i].eta)}}return"in"==t?a.sort(sortByTime):a.sort(sortByDistance),a}function hide_airport_info(){clearBlackout(),$("#modalContainer").hide()}function sortByTime(e,t){return e.expected.getTime()-t.expected.getTime()}function sortByDistance(e,t){return e.dist-t.dist}function minutesToHHMM(e,t){t=void 0==t||1==t,absMinutes=Math.abs(parseInt(e));var a=Math.floor(absMinutes/60),i=absMinutes%60;return e<0?add_zero(a)+":"+add_zero(i)+(t?" ago":""):(t?"in ":"")+add_zero(a)+":"+add_zero(i)}function roundToFive(e){var t=new Date;t.setTime(e.getTime());var a=e.getMinutes(),i=e.getHours(),l=5*parseInt((a+2.5)/5)%60,r=a>57?++i:i;return t.setHours(r),t.setMinutes(l),t}function hideTopBar(){1===init_topbar&&($("nav#navContainer").animate({top:"-52px"},150),init_topbar=0,viewToggleTopbar(),setSetting("map_topbar",0,365),$("body").addClass("topBarHidden"),clearTimeout(fetchInterval),fetch_plane_list())}function showTopBar(){0===init_topbar&&($("nav#navContainer").animate({top:"0"},150),init_topbar=1,viewToggleTopbar(),$("body").removeClass("topBarHidden"),setSetting("map_topbar",1,365))}function sortObject(e){var t,a={},i=[];for(t in e)e.hasOwnProperty(t)&&i.push(t);for(i.sort(),t=0;t<i.length;t++)a[i[t]]=e[i[t]];return a}function moveMap(e,t,a){map&&!0===geolocation_move&&(map.setCenter(new google.maps.LatLng(e,t)),map.setZoom(a))}function showSideView(e){append_html='<div class="modalContainer" id="sideviewContainer"><div class="modalContent" id="sideviewContent"><a class="modalContentClose" id="sideviewContentClose" title="Close"></a><div class="modalMainContainer"><img src="'+e+'" /><span style="display: block; padding: 0 10px 10px 10px;">&copy; Flightradar24</span></div></div></div>',$("body").append(append_html),$("#sideviewContainer").show(),blackoutMap()}function hideSideView(){$("#sideviewContainer").remove(),clearBlackout()}function jumpToController(e){switch(follow_aircraft=0,geolocation_move=!1,e){case"af":map.setCenter(new google.maps.LatLng(-1.399,12.743)),map.setZoom(4);break;case"as":map.setCenter(new google.maps.LatLng(13.075,79.803)),map.setZoom(4);break;case"eu":map.setCenter(new google.maps.LatLng(48.053,9.798)),map.setZoom(4);break;case"na":map.setCenter(new google.maps.LatLng(40.518,-101.427)),map.setZoom(4);break;case"oc":map.setCenter(new google.maps.LatLng(-31.573,143.787)),map.setZoom(4);break;case"sa":map.setCenter(new google.maps.LatLng(-22.506,298.035)),map.setZoom(4)}}function showSelectedRoute(){if(!plane_list[selected_aircraft])return hideSelectedRoute(),!1;if(!(selected_aircraft&&"NULL"!=selected_aircraft&&selected_data[selected_aircraft]&&selected_data[selected_aircraft].from_pos[0]&&selected_data[selected_aircraft].from_pos[1]))return!1;$("#fr24_ViewsDropdown a[data-value='list']").parent().hasClass("disabled")||$("#fr24_ViewsDropdown a[data-value='list'], #fr24_ViewsDropdown a[data-value='airport'], #fr24_ViewsDropdown a[data-value='fleet']").parent().addClass("notAllowed"),showRoute=1,showRoutePrevPos=[map.center.lat(),map.center.lng(),map.zoom];var e=new google.maps.LatLngBounds,t=parseFloat(selected_data[selected_aircraft].from_pos[0]),a=parseFloat(selected_data[selected_aircraft].from_pos[1]);if(selected_data[selected_aircraft].airport.destination){var i=parseFloat(selected_data[selected_aircraft].airport.destination.position.latitude),l=parseFloat(selected_data[selected_aircraft].airport.destination.position.longitude);if(selected_data[selected_aircraft].airport.real&&selected_data[selected_aircraft].airport.real.code.iata!=selected_data[selected_aircraft].airport.destination.code.iata){var r=parseFloat(selected_data[selected_aircraft].airport.real.position.latitude),n=parseFloat(selected_data[selected_aircraft].airport.real.position.longitude);selected_data[selected_aircraft].to_pos=[r,n],selected_data[selected_aircraft].old_pos=[i,l]}else selected_data[selected_aircraft].to_pos=[i,l];showRouteEnabled=!0}else if(selected_data[selected_aircraft].trail&&selected_data[selected_aircraft].trail.length>1){var s=selected_data[selected_aircraft].trail.length;showRouteEnabled=!1,selected_data[selected_aircraft].to_pos=[],selected_data[selected_aircraft].to_pos[0]=selected_data[selected_aircraft].trail[s-1].lat,selected_data[selected_aircraft].to_pos[1]=selected_data[selected_aircraft].trail[s-1].lng,i=parseFloat(selected_data[selected_aircraft].to_pos[0]),l=parseFloat(selected_data[selected_aircraft].to_pos[1])}var o=calculateDistanceBetween(t,a,i,l);delete_all_planes(),update_planes(),a<l&&a-l>-180||a>l&&a-l>180?(west_lon=a,west_lat=t,east_lon=l,east_lat=i):(west_lon=l,west_lat=i,east_lon=a,east_lat=t),o>7e3?(west_lon-=15,west_lat>east_lat?west_lat+=5:east_lat+=5):o>2e3?(west_lon-=5,west_lat>east_lat?west_lat+=1:east_lat+=1):(west_lon-=2,west_lat>east_lat?west_lat+=.3:east_lat+=.3),west_lon<-180&&(west_lon=360+west_lon),e.extend(new google.maps.LatLng(west_lat,west_lon)),e.extend(new google.maps.LatLng(east_lat,east_lon)),e.extend(new google.maps.LatLng(plane_list[selected_aircraft][1],plane_list[selected_aircraft][2])),map.fitBounds(e),update_static_pins()}function hideSelectedRoute(e){showRoute=0,$(".showRouteLink","#leftColOverlay, #cnt-panel-clickhandler").removeClass("active"),$("#fr24_ViewsDropdown a[data-value='list'], #fr24_ViewsDropdown a[data-value='airport'], #fr24_ViewsDropdown a[data-value='fleet']").parent().removeClass("notAllowed"),clearMapPins("route"),clearMapPins("airport"),clearTimeout(fetchInterval),e&&(map.setCenter(new google.maps.LatLng(showRoutePrevPos[0],showRoutePrevPos[1])),map.setZoom(showRoutePrevPos[2])),fetch_plane_list()}function formatNumber(e){var t=new String(e);t=t.split("").reverse();for(var a="",i=0;i<=t.length-1;i++)a=t[i]+a,(i+1)%3==0&&t.length-1!==i&&(a=","+a);return a}function clickLoaderSlideIn(e){if(selected_aircraft_array.length>1)return!1;$("body").addClass("show-click-loader"),$("#clickLoader").removeAttr("class").addClass(e).show()}function aircraftInfoSlideIn(){if(!showLeftOverlay)return!1;var e=$("body").hasClass("show-left-overlay"),t=$("#leftColOverlayAdContainerSmall > ins"),a=$("#leftColOverlayAdContainerLarge > ins");clearTimeout(planeInfoLoadingTimeout),$("#clickLoader").removeAttr("class").hide(),$("body").removeClass("show-click-loader"),$("#leftColOverlay, #cnt-panel-clickhandler").show(),$("body").addClass("show-left-overlay"),left_overlay_first_load?(t.addClass("adsbygoogle"),(adsbygoogle=window.adsbygoogle||[]).push({}),simple_mode||(a.addClass("adsbygoogle"),(adsbygoogle=window.adsbygoogle||[]).push({}))):!e&&t.length&&(t.css({height:"60px","max-height":"60px"}).attr("data-adsbygoogle-status",!1).empty(),$("#leftColOverlayAdContainerSmall").attr("style",""),(adsbygoogle=window.adsbygoogle||[]).push({}),simple_mode||(a.css({height:"200px","max-height":"200px"}).attr("data-adsbygoogle-status",!1).empty(),$("#leftColOverlayAdContainerLarge").attr("style",""),(adsbygoogle=window.adsbygoogle||[]).push({}))),left_overlay_first_load=0,getMapControl("logo").animate({marginLeft:"266px"},200),$("#overlayFlightDetails").focus();var i=1===playback_mode?$("#playbackControlsOverlay").offset().top:"auto";$("#leftColOverlay, #cnt-panel-clickhandler").height(i)}function aircraftInfoSlideOut(){$("body").removeClass("show-left-overlay");var e=document.getElementById("cnt-ch-sm-ad");e&&e.classList.add("ad-hide"),0==sidebar_closed?getMapControl("logo").animate({marginLeft:"212px"},400):getMapControl("logo").animate({marginLeft:"6px"},200),null!==aircraftInfowindow&&aircraftInfowindow.close()}function addOffsetPlus(e){return"-"!=(e+="").substring(0,1)?"+"+e:e}function showShareBox(e){var t=$(e).attr("data-callsign"),a=$(e).attr("data-aircraft"),i=link_url+"/"+(1==playback_mode?playback_time.getFullYear()+"-"+add_zero(playback_time.getMonth()+1)+"-"+add_zero(playback_time.getDate())+"/"+add_zero(playback_time.getHours())+":"+add_zero(playback_time.getMinutes())+"/"+playback_speed+"x/":"")+t+"/"+a;$(".shareBoxWrapper").remove();var l='<div class="shareBoxWrapper"><div class="shareBoxContent">';l+='<input class="flightLink select-on-focus" value="'+i+'" /><ul class="buttons">',l+='<li><a id="tw-share" title="Share on Twitter" class="button twitter" href="https://twitter.com/share/?url='+i+"&text="+t+'+on+Flightradar24.com&hashtags=flightradar24"></a></li>',l+='<li><a id="fb-share" title="Share on Facebook" class="button facebook" href="//www.facebook.com/sharer/sharer.php?s=100&p[title]='+t+"+on+Flightradar24.com&p[summary]=Flightradar24+is+the+best+live+flight+tracker+that+shows+air+traffic+in+real+time.+Best+coverage+and+cool+features!&p[url]="+i+"&p[images][0]="+dispatcher.urls.static+'/images/fb_logo.png"></a></li>',l+='<li><a id="gp-share" title="Share on Google Plus" class="button gplus" href="https://plus.google.com/share?url='+i+'"></a></li>',l+='<li class="last"><a class="button email" title="Share via email" href="mailto:?&subject='+t+" on Flightradar24&body="+i+'"></a></li>',l+='<br class="clear" /></ul></div><span class="arrow"></span>',$("body").append(l),$(".shareBoxWrapper").position({my:"bottom+10",at:"top",of:$(e)}).addClass("scale-start"),setTimeout('$(".shareBoxWrapper").addClass("scale-end");',10),setTimeout('$(".shareBoxWrapper").removeClass("scale-start");',10)}function hideShareBox(){$(".shareBoxWrapper").remove(),$(".shareFlightLink").removeClass("active")}function formatAMPM(e){var t=e.getUTCHours(),a=e.getUTCMinutes(),i=t>=12?"PM":"AM";return[(t=(t%=12)||12)+":"+(a=a<10?"0"+a:a),i]}function blackoutMap(e){var t=!1;$("#modalBlackout").length>0&&(t=!0);var a="";if(e&&(a='<img src="'+dispatcher.urls.static+'/images/loader_dark.gif" class="loader" />'),t)t&&e&&$("#modalBlackout").html(a);else{var i=$('<div id="modalBlackout"><a href="'+dispatcher.urls.site+'" class="modalBlackout-logo" src="'+dispatcher.urls.static+'/images/logo_flat_gray_yellow.svg"></a>'+a+"</div>");$(i).appendTo("body"),setTimeout(function(){$(i).addClass("show")},10)}}function clearBlackout(){var e=$("#modalBlackout");$("#modalBlackout .loader").remove(),$("#modalBlackout .loadError").remove(),$(e).removeClass("show"),setTimeout(function(){$(e).remove()},300)}function clearBlackoutLoader(){$("#modalBlackout .loader").remove()}function showBlackoutError(){clearBlackoutLoader(),innerHTML='<div class="loadError"><img src="'+dispatcher.urls.static+'/images/loader_dark_error.png" /><span><strong>Sorry, couldn\'t load data.</strong><br />Please try again later.</span><input type="button" value="Ok, close" class="standardButton" /></div>',$("#modalBlackout").html(innerHTML)}function showDynamicOverlay(e,t,a,i){if(void 0!==i&&"show"===i)return!1;var l=$("#section-"+e);$("#mapDynamicOverlays div.dynamicOverlay").removeClass("active"),$(l).html().length>0&&$(l).attr("data-dynamic-url")===t?(blackoutMap(),$(l).addClass("active")):(blackoutMap(!0),$.ajax({type:"POST",url:a,dataType:"json",timeout:7e3,data:{}}).done(function(e){!0===e.success&&e.page&&e.page.length>10?(clearBlackoutLoader(),$(l).html(e.page).addClass("active").attr("data-dynamic-url",t)):showBlackoutError()}).fail(function(){showBlackoutError()}))}function hideDynamicOverlay(){$("#mapDynamicOverlays div.dynamicOverlay").removeClass("active"),clearBlackout(),fetch_plane_list()}function closeDynamicOverlay(){hideDynamicOverlay(),setTimeout(function(){historyReplaceState()},500)}function supportsLocalStorage(){try{return"localStorage"in window&&null!==window.localStorage}catch(e){return!1}}function goToAircraft(e,t){if(void 0===t&&(t=!1),""===e)return!1;"delayView"==map_left_menu_view&&(map_left_menu_view="mapView",$("#fr24_ViewsDropdown a[data-value='map']").triggerHandler("click"));var a=!1;if(void 0!==plane_list&&$.each(plane_list,function(t,i){if(i[16]===e){if(hideDynamicOverlay(),isMapPannable()&&!isAirportView()){follow_aircraft=multi_select_mode?0:1,$("a#follow-aircraft").addClass("active"),map.setZoom(8);var l=new google.maps.LatLng(i[1],i[2]);map.panToOffsetted(l)}return show_aircraft_data(t),add_label(t),a=!0,!1}}),!a)if(hideDynamicOverlay(),init_call=e,t){var i=build_filter_params();i&&(i="&"+i);var l="/zones/fcgi/feed.js?faa="+(1==faa_traffic?1:0)+"&mlat="+(1==mlat_traffic?1:0)+"&flarm="+(1==flarm_traffic?1:0)+"&adsb="+(1==adsb_traffic?1:0)+"&gnd="+(1==ground_traffic?1:0)+"&air="+(1===airborn_traffic?1:0)+"&vehicles="+(1===vehicular_traffic?1:0)+"&estimated="+(estimated_traffic>0?"1&maxage="+60*estimated_traffic:"0&maxage=0")+"&gliders="+(1===glider_traffic?1:0)+"&time="+(new Date).getTime()+"&filter_info=1&selected="+e+"&ems=1"+i+"&limit=0";l+=addPublicKey(),$.getJSON("//"+dispatcher.urls.feedPlaneList+l,function(t){if(void 0!==t[e]){if(selected_aircraft=e,multi_select_mode&&-1===$.inArray(e,selected_aircraft_array)&&addMultiSelect(e),isMapPannable()&&!isAirportView()){var a=new google.maps.LatLng(t[e][1],t[e][2]);map.setCenter(a)}force_init_call=1,clearTimeout(fetchInterval),void 0!==t["selected-matched:"]&&!1===t["selected-matched:"]&&(filters.push(["showall","true",""]),displayShowAllMsg()),isAirportView()||isListView()||isFleetView()||map.setZoom(8),feed_request_time_ms=0,feed_queued=0,fetch_plane_list(!0)}else 0!=playback_mode||window._requestExecuted||(window._requestExecuted=!0,$.getJSON(dispatcher.urls.site+"/flights/get-flightnum-by-flightid",{query:e},function(t){if(t&&void 0!==t.result&&t.result){var a;a=null!=t.result&&null!=t.result.value?$('<div id="dialog-message"  data-width="500" style="display: none;"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><h1 class="modal-title">Live flight not found</h1></div><div class="modal-body">'+("flight"==t.result.type?"Flight <strong>"+t.result.value+"</strong> is currently not tracked by Flightradar24. ":"Aircraft with registration <strong>"+t.result.value+"</strong> is currently not tracked by Flightradar24. ")+'It\'s either out of <a href="//www.flightradar24.com/how-it-works">coverage</a> or has already landed. <br/><br/>Do you want to see the history of this flight?</div><div class="modal-footer"><button type="button" class="btn btn-blue" style="cursor: pointer;float:left;" onclick="$(\'#dialog-message\').dialog(\'close\');">No, close pop-up</button>'+("flight"==t.result.type?'<a style="float:right;" href="/data/flights/'+t.result.value+"/#"+e+'" class="btn btn-link-green">Yes, show flight history</a>':'<a style="margin-left:20px;" href="/data/aircraft/'+t.result.value.toLowerCase()+"/#"+e+'" class="btn btn-link-green">Yes, show flight history</a>')+'<div class="clear"></div></div></div></div></div>'):$('<div id="dialog-message"  data-width="480" style="display: none;"><div class="modal-dialog modal-sm"><div class="modal-content"><div class="modal-header"><h1 class="modal-title">Live flight not found</h1></div><div class="modal-body">Sorry, but we couldn\'t find data about this flight.</div><div class="modal-footer"><button type="button" class="btn btn-blue" style="cursor: pointer;" onclick="$(\'#dialog-message\').dialog(\'close\');">OK</button></div></div></div></div>'),$("body > div.bootstrap").append(a),multi_select_mode||$("#dialog-message").dialog({modal:!0,draggable:!1,buttons:{Ok:function(){$(this).dialog("close")}},open:function(e,t){$(this).dialog("adjustWidth",t)},close:function(e,t){fetch_plane_list(!0)},resizable:!1,width:500})}fetch_plane_list(),window._requestExecuted=!1}))})}else $.getJSON(dispatcher.urls.site+"/flights/search-by-callsign/",{query:init_call,timestamp:(new Date).getTime()},function(t){t.lat&&t.lon?(t.id&&(selected_aircraft=t.id,multi_select_mode&&-1===$.inArray(t.id,selected_aircraft_array)&&addMultiSelect(t.id)),clearTimeout(fetchInterval),feed_request_time_ms=0,feed_queued=0,fetch_plane_list(!0)):0==playback_mode&&$.getJSON(dispatcher.urls.site+"/flights/get-flightnum-by-callsign",{query:e},function(t){if(t&&void 0!==t.result&&t.result&&(t.result.value||t.result.registration)){var a;if(null!=t.result&&null!=t.result.value){var i=t.result.value&&t.result.value.length>0?" (flight "+t.result.value+")":"",l=t.result.value&&t.result.value.length>0?'<a style="float:right;" href="/data/flights/'+t.result.value+'" class="btn btn-link-green">Yes, show flight history</button>':'<a style="margin-left:20px;" href="/data/aircraft/'+t.result.registration.toLowerCase()+'" class="btn btn-link-green">Yes, show aircraft history</button>';a=$('<div id="dialog-message"  data-width="480" style="display: none;"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><h1 class="modal-title">Live flight not found</h1></div><div class="modal-body">Aircraft with callsign <strong>'+e.toUpperCase()+i+'</strong> is currently not tracked by Flightradar24. It\'s either out of <a href="//www.flightradar24.com/how-it-works">coverage</a> or has already landed. Do you want to see the history of this flight?</div><div class="modal-footer"><button type="button" class="btn btn-blue" style="cursor: pointer;float:left;" onclick="$(\'#dialog-message\').dialog(\'close\');">No, close pop-up</button>'+l+'<div class="clear"></div></div></div></div></div>')}else a=$('<div id="dialog-message"  data-width="480" style="display: none;"><div class="modal-dialog modal-sm"><div class="modal-content"><div class="modal-header"><h1 class="modal-title">Live flight not found</h1></div><div class="modal-body">Sorry, but we couldn\'t find data about this flight.</div><div class="modal-footer"><button type="button" class="btn btn-blue" style="cursor: pointer;" onclick="$(\'#dialog-message\').dialog(\'close\');">OK</button></div></div></div></div>');$("body > div.bootstrap").append(a),multi_select_mode||$("#dialog-message").dialog({modal:!0,draggable:!1,buttons:{Ok:function(){$(this).dialog("close")}},open:function(e,t){$(this).dialog("adjustWidth",t)},close:function(e,t){fetch_plane_list(!0)},resizable:!1,width:500})}fetch_plane_list()})}),1==faa_traffic&&1==mlat_traffic&&1==flarm_traffic&&1==adsb_traffic&&60==estimated_traffic||(filters.push(["showall","true",""]),displayShowAllMsg())}function login_check(){$.getJSON(dispatcher.urls.site+"/user/session",{},function(e,t,a){if(!e.identity){var i='<h1 class="loggedout">You have been logged out from Flightradar24.</h1>';i+='<div class="login"><a class="btn-link-white" href="'+dispatcher.urls.site+'">Log in again</a></div>',$("#disable-page-text .disable-page-content").html(i),exit_map(),clearInterval(loginCheckInterval)}})}function convertAircraftTypeAssignmentList(){aircraft_type_icons=[],$.each(aircraft_type_assignments,function(e,t){$.each(t,function(t,a){aircraft_type_icons[a]=e})})}function closeSidebar(e){e=e||200,sidebar_closed=1,$(".overlayBoxContainer").hide(),$("#leftCol").animate({left:"-280px"},e,function(){}),$("#map_canvas").children("div").children("div").eq(1).animate({marginLeft:"2px"},200),map&&fetch_plane_list()}function showSidebar(){sidebar_closed=0,$("#leftCol").animate({left:"0"},150,function(){}),$("#map_canvas").children("div").children("div").eq(1).animate({marginLeft:"210px"},200)}function getMediaFeedLimits(){var e=0,t=0,a=0,i=$("body").hasClass("news-feed"),l=$("body").hasClass("blog-feed");i&&$("#latestTwitterContainer").show(),l&&$("#latestBlogContainer").show(),$(".fa.fa-chevron-circle-right","#menuTwitter").removeClass("fa-chevron-circle-right").addClass("fa-chevron-circle-down"),$(".fa.fa-chevron-circle-right","#menuBlog").removeClass("fa-chevron-circle-right").addClass("fa-chevron-circle-down"),$("#latestTwitterContainer div, #latestTwitterContainer hr, #latestBlogContainer div, #latestBlogContainer hr").hide(),$("#mapView > div, #storeBadges a").each(function(t,a){e+=$(a).outerHeight()});var r=dispatcher.isPremium?40:0;i||(r+=23),e+=53+r;for(var n=$(window).height()-e,s=Math.round(n/66),o=0;o<s;o++)o%2==0?i?toggleFeedItem("Twitter",++t):toggleFeedItem("Blog",++a):l?toggleFeedItem("Blog",++a):toggleFeedItem("Twitter",++t);t+a<1?$("#menuTwitter, #menuBlog").hide():t+a<2?($("#menuBlog").hide(),$("#menuTwitter").show()):($("#menuBlog, #menuTwitter").show(),0===t&&($(".fa.fa-chevron-circle-down","#menuTwitter").removeClass("fa-chevron-circle-down").addClass("fa-chevron-circle-right"),$("#latestTwitterContainer").hide()),0===a&&($(".fa.fa-chevron-circle-down","#menuBlog").removeClass("fa-chevron-circle-down").addClass("fa-chevron-circle-right"),$("#latestBlogContainer").hide())),n<-150?$("#gad-container").hide():$("#gad-container").show()}function toggleFeedItem(e,t){$("#latest"+e+"Container div:nth-of-type("+t+")").show(),t>1&&$("#latest"+e+"Container hr:nth-of-type("+t+")").show()}function checkSidebarState(){isResizeForMobile&&("undefined"==typeof cookie_map_sidebar_closed?0===sidebar_closed&&$(window).width()<=550&&setSetting("map_sidebar_closed",1,365):1===parseInt(cookie_map_sidebar_closed)&&(0===sidebar_closed&&$(window).width()<=550?setSetting("map_sidebar_closed",1,365):1===sidebar_closed&&$(window).width()>550&&setSetting("map_sidebar_closed",0,365)))}function blackoutForApps(){if(dispatcher.display&&dispatcher.display.isMobile){blackoutMap();var e=dispatcher.display.isAndroid?"android":"ios",t={android:"https://play.google.com/store/apps/details?id=com.flightradar24free&hl=en&referrer=utm_source%3Dfr24_web_app_promo",ios:"https://itunes.apple.com/app/flightradar24-free/id382233851?ls=1&mt=8&at=10lti3&ct=fr24_web_app_promo"};$("#modalBlackout").append("<a class='close' href='javascript:void(0);'><img class='appPromoClose' src="+dispatcher.urls.static+"/images/app_promo_close.svg /></a>").click(function(){$(this).find("img").remove(),clearBlackout()}),$("#modalBlackout").append("<img class='appPromoHeader' src="+dispatcher.urls.static+"/images/app_promo_header.svg />"),$("#modalBlackout").append("<img class='appPromoBody' src="+dispatcher.urls.static+"/images/app_promo_body_"+e+".svg />"),$("#modalBlackout").append("<img class='appPromoRibbon' src="+dispatcher.urls.static+"/images/app_promo_ribbon.svg />"),$("#modalBlackout").append("<a target='_blank' class='goToApp' href='"+t[e]+"'><img class='appPromoBadge' src="+dispatcher.urls.static+"/images/app_promo_"+e+"_badge.svg /></a>"),$("#modalBlackout").append("<img class='appPromoLogo' src="+dispatcher.urls.static+"/images/app_promo_logo.svg />"),$("#modalBlackout").addClass("dl-apps "+e)}}function handleAppAdBlackout(){if(dispatcher.display&&dispatcher.display.isMobile){var e=new Fr24.SessionStorage,t=e.getItem("infoBoxCloseCount");t=null!=t?t+1:1,e.setItem("infoBoxCloseCount",t),2===t&&blackoutForApps()}}function animate_playback(){if(0!=playback_play){var e=(new Date).getTime();if(0==playback_tick_ms_ts&&(playback_tick_ms_ts=e-playback_tick_ms_step),playback_tick_ms_real=e-playback_tick_ms_ts,playback_tick_ms_ts=e,0!=plane_list_next){if(playback_tick_ms+=playback_tick_ms_real,clock_interval=playbackStep<1&&playbackStep>0?5e3/playbackStep:5e3,playback_tick_ms>=clock_interval&&playback_queue.length>0&&(data=playback_queue.pop(),step_playback_queue(data),playback_tick_ms=0,planes_array_fake={},planes_showing<500&&playbackStep<12&&1==init_anim&&(a_active=1)),planes_showing<500&&1==a_active&&playbackStep<12){for(var t in planes_array){if(plane_list_next[t]){if(!plane_list_org[t])continue;!planes_array_fake[t]&&plane_list_next[t]&&calculateNewPlaybackPos(t);a=calculatePlaybackPos(t)}else if(plane_list_org[t])var a=new google.maps.LatLng(plane_list_org[t][1],plane_list_org[t][2]);planes_array[t]&&(planes_array[t].setPosition(a),planes_array[t].label&&(planes_array[t].label.latlng_=a,planes_array[t].label.move()),planes_array[t].temp_label&&(planes_array[t].temp_label.latlng_=a,planes_array[t].temp_label.move()),selected_aircraft!=t&&-1===$.inArray(t,selected_aircraft_array)||!isMapPannable()||(showLeftOverlay||isMapView()||angular.element($("#aircraftInfoOverlay")).scope().updatePosition(),draw_fake_polyline(t),multi_select_mode||1!=follow_aircraft||plane_list[t].followed||(plane_list[t].followed=1,isAirportView()||map.panToOffsetted(a))))}}else a_active=0;clearTimeout(aInterval),1==playback_play&&(aInterval=setTimeout(animate_playback,playback_tick_ms_step))}}}function calculateNewPlaybackPos(e){if(!plane_list_next[e])return!1;var t=0,a=timeLocal.getTime()+(t=(plane_list[e],5100));planes_array_fake[e]={},planes_array[e]&&(planes_array_fake[e].dist=calculateDistanceBetween(plane_list_next[e][1],plane_list_next[e][2],planes_array[e].position.lat(),planes_array[e].position.lng())/48/6371);var i=toRad(plane_list_next[e][1]),l=toRad(plane_list_next[e][2]),r=toRad(plane_list[e][1]),n=l-toRad(plane_list[e][2]),s=Math.sin(n)*Math.cos(i),o=Math.cos(r)*Math.sin(i)-Math.sin(r)*Math.cos(i)*Math.cos(n),c=Math.atan2(s,o);c=(toDeg(c)+360)%360,planes_array_fake[e].ts=a,planes_array_fake[e].ms=0,planes_array_fake[e].newlat=plane_list_next[e][1],planes_array_fake[e].newlon=plane_list_next[e][2],planes_array_fake[e].brng=c,planes_array_fake[e].speed=1.852*plane_list_next[e][5]*(12*playbackStep);var p=plane_list[e]?plane_list[e][7]:"";if(polylines[e]&&polylines[e].length>0&&e==selected_aircraft&&!p.match(radarRegexp)){var _=polylines[e][polylines[e].length-1].getPath().getAt(0),d=[new google.maps.LatLng(plane_list[e][1],plane_list[e][2]),_],f=new google.maps.Polyline({path:d,strokeColor:meter_to_color(.3048*plane_list[e][4]),strokeOpacity:.6,strokeWeight:3,geodesic:!0});f.setMap(map),polylines[e].push(f),polylines_index[e][plane_list[e][1]+"/"+plane_list[e][2]]="1"}var u=c;planes_array[e]&&(planes_array[e].setIcon(get_sprite(plane_list[e][8],u,e==selected_aircraft||-1!==$.inArray(e,selected_aircraft_array)?"1":"0",plane_list[e][6],plane_list[e]?plane_list[e][7]:"",plane_list[e][16])),planes_array[e].aircraft_track=u)}function calculatePlaybackPos(e){if(planes_array[e]&&planes_array_fake[e]){timeLocal.getTime();if(planes_array_fake[e]){planes_array_fake[e].ms+=playback_tick_ms_real;var t=toRad(planes_array_fake[e].newlat),a=toRad(planes_array_fake[e].newlon),i=calculateDistanceBetween(planes_array[e].position.lat(),planes_array[e].position.lng(),planes_array_fake[e].newlat,planes_array_fake[e].newlon)/6371-planes_array_fake[e].dist,l=parseInt(planes_array_fake[e].brng);l>=180?l-=180:l+=180,l=toRad(l);var r=Math.asin(Math.sin(t)*Math.cos(i)+Math.cos(t)*Math.sin(i)*Math.cos(l)),n=a+Math.atan2(Math.sin(l)*Math.sin(i)*Math.cos(t),Math.cos(i)-Math.sin(t)*Math.sin(r));return n=(n+3*Math.PI)%(2*Math.PI)-Math.PI,r=toDeg(r),n=toDeg(n),plane_list[e][1]=r,plane_list[e][2]=n,new google.maps.LatLng(r,n)}}}function animate(){var e=timeLocal.getTime();for(var t in planes_array)if(plane_list_org&&plane_list_org[t]&&e-1e3*plane_list_org[t][10]<3e4){planes_array_fake[t]||calculateNewPos(t);var a=calculateCurrentPos(t);if(planes_array[t].setPosition(a),planes_array[t].label&&(planes_array[t].label.latlng_=a,planes_array[t].label.move()),planes_array[t].temp_label&&(planes_array[t].temp_label.latlng_=a,planes_array[t].temp_label.move()),(selected_aircraft==t||-1!==$.inArray(t,selected_aircraft_array))&&(showLeftOverlay||isMapView()||angular.element($("#aircraftInfoOverlay")).scope().updatePosition(),draw_fake_polyline(t),1==follow_aircraft&&!plane_list[t].followed&&isMapPannable()&&(plane_list[t].followed=1,!isAirportView()))){if((!screen.orientation||screen.orientation&&screen.orientation.type&&-1==screen.orientation.type.indexOf("primary"))&&(screen.orientation={angle:window.orientation,type:90==window.orientation||-90==window.orientation?"landscape":"portrait"}),dispatcher.display.isMobile&&screen.orientation.type.indexOf("landscape")>=0&&document.body.classList.contains("show-left-overlay")){var i=map.getBounds().toSpan();a=new google.maps.LatLng(a.lat(),a.lng()+-.25*i.lng())}map.panToOffsetted(a)}}if(clearTimeout(aInterval),init_anim){if(planes_showing<=10)l=100;else if(planes_showing<=100)l=400;else if(planes_showing<=300)l=1600;else if(planes_showing<=500)l=2e3;else if(planes_showing<=1e3)l=3e3;else var l=4e3;aInterval=setTimeout(function(){window.requestAnimationFrame(animate)},l)}}function calculateNewPos(e){if(planes_array[e])if(plane_list_org[e][5]>20&&0!=plane_list_org[e][3]){calculateRealTimestamp(e);var t=timeLocal.getTime()+1e4,a=1e3*plane_list[e][10],i=toRad(plane_list_org[e][1]),l=toRad(plane_list_org[e][2]),r=1.852*(plane_list_org[e][5]<40?.7*plane_list_org[e][5]:plane_list_org[e][5])/60/60*((t-a)/1e3)/6371,n=toRad(parseInt(plane_list_org[e][3])),s=Math.asin(Math.sin(i)*Math.cos(r)+Math.cos(i)*Math.sin(r)*Math.cos(n)),o=l+Math.atan2(Math.sin(n)*Math.sin(r)*Math.cos(i),Math.cos(r)-Math.sin(i)*Math.sin(s));o=(o+3*Math.PI)%(2*Math.PI)-Math.PI;var i=toRad(planes_array[e].position.lat()),c=o-(l=toRad(planes_array[e].position.lng())),p=Math.sin(c)*Math.cos(s),_=Math.cos(i)*Math.sin(s)-Math.sin(i)*Math.cos(s)*Math.cos(c);n=(toDeg(n=Math.atan2(p,_))+360)%360;var d=s-i,f=Math.sin(d/2)*Math.sin(d/2)+Math.cos(i)*Math.cos(s)*Math.sin(c/2)*Math.sin(c/2),u=60*(6371*(2*Math.atan2(Math.sqrt(f),Math.sqrt(1-f))))*60/10;if(planes_array_fake[e]={},planes_array_fake[e].ts=t,planes_array_fake[e].newlat=toDeg(s),planes_array_fake[e].newlon=toDeg(o),planes_array_fake[e].brng=n,planes_array_fake[e].speed=u,brngDiff=Math.abs(bearingDiff(n,parseInt(plane_list_org[e][3]))),brngDiff>100||planes_array_fake[e].speed>5e3)planes_array_fake[e]={},planes_array_fake[e].ts=timeLocal.getTime(),planes_array_fake[e].newlat=plane_list_org[e][1],planes_array_fake[e].newlon=plane_list_org[e][2],planes_array_fake[e].brng=0,planes_array_fake[e].speed=0;else if(brngDiff<50&&brngDiff>20){var m=averageBearing(parseInt(plane_list[e][3]),parseInt(n));planes_array[e].setIcon(get_sprite(plane_list[e][8],m,e==selected_aircraft||-1!==$.inArray(e,selected_aircraft_array)?"1":"0",plane_list[e][6],plane_list[e]?plane_list[e][7]:"",plane_list[e][16])),planes_array[e].aircraft_track=m}}else planes_array_fake[e]={},planes_array_fake[e].ts=timeLocal.getTime(),planes_array_fake[e].newlat=plane_list_org[e][1],planes_array_fake[e].newlon=plane_list_org[e][2],planes_array_fake[e].brng=0,planes_array_fake[e].speed=0}function calculateRealTimestamp(e){if(plane_list_org[e]&&plane_list_old[e]){var t=toRad(plane_list_old[e][1]),a=toRad(plane_list_old[e][2]),i=toRad(plane_list_org[e][1]),l=i-t,r=toRad(plane_list_org[e][2])-a,n=Math.sin(l/2)*Math.sin(l/2)+Math.sin(r/2)*Math.sin(r/2)*Math.cos(t)*Math.cos(i),s=6371*(2*Math.atan2(Math.sqrt(n),Math.sqrt(1-n))),o=plane_list_old[e][10]+Math.round(.539956803*s/((parseInt(plane_list_old[e][5])+parseInt(plane_list_org[e][5]))/2)*60*60);o<plane_list_org[e][10]&&plane_list_org[e][10]-o<10&&(plane_list[e][10]=o)}}function calculateCurrentPos(e){if(planes_array[e]&&planes_array_fake[e]){var t=timeLocal.getTime();if(planes_array_fake[e].ts>t){var a=toRad(planes_array_fake[e].newlat),i=toRad(planes_array_fake[e].newlon),l=planes_array_fake[e].speed/60/60*((planes_array_fake[e].ts-t)/1e3)/6371,r=parseInt(planes_array_fake[e].brng);r>=180?r-=180:r+=180,r=toRad(r);var n=Math.asin(Math.sin(a)*Math.cos(l)+Math.cos(a)*Math.sin(l)*Math.cos(r)),s=i+Math.atan2(Math.sin(r)*Math.sin(l)*Math.cos(a),Math.cos(l)-Math.sin(a)*Math.sin(n));return s=(s+3*Math.PI)%(2*Math.PI)-Math.PI,n=toDeg(n),s=toDeg(s),plane_list[e][1]=n,plane_list[e][2]=s,new google.maps.LatLng(n,s)}return new google.maps.LatLng(planes_array_fake[e].newlat,planes_array_fake[e].newlon)}}function calculateFirstPos(e){if(plane_list[e]){var t=timeLocal.getTime(),a=toRad(plane_list_org[e][1]),i=toRad(plane_list_org[e][2]),l=1.852*plane_list_org[e][5]/60/60*((t-1e3*plane_list_org[e][10])/1e3)/6371,r=toRad(parseInt(plane_list_org[e][3])),n=Math.asin(Math.sin(a)*Math.cos(l)+Math.cos(a)*Math.sin(l)*Math.cos(r)),s=i+Math.atan2(Math.sin(r)*Math.sin(l)*Math.cos(a),Math.cos(l)-Math.sin(a)*Math.sin(n));return s=(s+3*Math.PI)%(2*Math.PI)-Math.PI,n=toDeg(n),s=toDeg(s),plane_list[e][1]=n,plane_list[e][2]=s,new google.maps.LatLng(n,s)}}function bearingDiff(e,t){for(var a=t-e;a<-180;)a+=360;for(;a>180;)a-=360;return-a}function calculateDistanceBetween(e,t,a,i){var l=toRad(a-e),r=toRad(i-t),e=toRad(e),a=toRad(a),n=Math.sin(l/2)*Math.sin(l/2)+Math.sin(r/2)*Math.sin(r/2)*Math.cos(e)*Math.cos(a);return 6371*(2*Math.atan2(Math.sqrt(n),Math.sqrt(1-n)))}function calculateDistanceBetweenVincenty(e,t,a,i){var l,r=6378137,n=6356752.3142,s=1/298.257223563,o=toRad(i-t),c=Math.atan((1-s)*Math.tan(toRad(e))),p=Math.atan((1-s)*Math.tan(toRad(a))),_=Math.sin(c),d=Math.cos(c),f=Math.sin(p),u=Math.cos(p),m=o,g=10;do{var h=Math.sin(m),y=Math.cos(m),v=Math.sqrt(u*h*(u*h)+(d*f-_*u*y)*(d*f-_*u*y));if(0===v)return 0;var b=_*f+d*u*y,w=Math.atan2(v,b),k=d*u*h/v,$=1-k*k,T=b-2*_*f/$,C=s/16*$*(4+s*(4-3*$));isNaN(T)&&(T=0),l=m,m=o+(1-C)*s*k*(w+C*v*(T+C*b*(2*T*T-1)))}while(Math.abs(m-l)>1e-12&&--g>0);if(!g)return NaN;var L=$*(r*r-n*n)/(n*n),M=L/1024*(256+L*(L*(74-47*L)-128));return n*(1+L/16384*(4096+L*(L*(320-175*L)-768)))*(w-M*v*(T+M/4*(b*(2*T*T-1)-M/6*T*(4*v*v-3)*(4*T*T-3))))/1e3}function averageBearing(e,t){var a=0,i=toRad(e),l=toRad(t),r=Math.cos(i)+Math.cos(l),n=Math.sin(i)+Math.sin(l);return(a=Math.round(toDeg(Math.atan2(n,r))))<0&&(a+=360),a}function toRad(e){return e*Math.PI/180}function toDeg(e){return 180*e/Math.PI}function getLength(e){if(Object.hasOwnProperty("keys"))return Object.keys(e).length;Object.keys||(Object.keys=function(e){if(e!==Object(e))throw new TypeError("Object.keys called on a non-object");var t,a=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&a.push(t);return a})}function locateMapControls(){var e={},t=$("#map_canvas > div:first-child > div:first-child").children(":eq(1), div.gmnoprint");return $.each(g_MapControlPosition,function(a,i){e[a]=t.eq(i)}),e}function getMapControl(e){return g_MapControls.length||(g_MapControls=locateMapControls()),g_MapControls[e]?g_MapControls[e]:$("<div>",{id:"map_control_"+e})}function getParam(e,t){void 0===t&&(t=null);var a=decodeURI(window.location.search.replace(new RegExp("^(?:.*[&\\?]"+encodeURI(e).replace(/[\.\+\*]/g,"\\$&")+"(?:\\=([^&]*))?)?.*$","i"),"$1"));return""==a?t:a}function drawPlaybackTimeline(){$("body").addClass("show-playback-overlay");var e=new Date,t=parseInt(dispatcher.userFeatures["history.playback.global.days"]);playbackTimelineOpt.min=new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()-t),playbackTimelineOpt.max=new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours()+4),playbackTimeline=new links.Timeline(document.getElementById("playbackTimelineContainer"),playbackTimelineOpt),timeline_options=playbackTimeline.getOptions(),links.events.addListener(playbackTimeline,"timechanged",onTimelineTimeChange),setTimelineCustomeTime();var a=new Date(playback_time.getTime()-12e4),i=new Date(playback_time.getTime()+18e4);playbackTimeline.setVisibleChartRange(a,i),$("#playback-zoomin").click(function(){timelineChangeZoom(.4)}),$("#playback-zoomout").click(function(){timelineChangeZoom(-.4)}),$("#playback-scroll-left").click(function(){timelineMove(-.2)}),$("#playback-scroll-right").click(function(){timelineMove(.2)}),$(".timeline-customtime").append("<svg><use xlink:href='#icon-fr24-timeline-point' /></svg>")}function setTimelineCustomeTime(){playbackTimeline.setCustomTime(playback_time)}function onTimelineTimeChange(e){var t=new Date,a=new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes());if(!(e.time.getTime()>a.getTime())){if(selected_time=new Date(e.time.setSeconds(0)),playback_time="undefined"!=typeof time?time:selected_time,$("#playbackChoice, #playbackStatus").html(timeline_options.DAYS_SHORT[playback_time.getDay()]+", "+timeline_options.MONTHS_SHORT[playback_time.getMonth()]+" "+playback_time.getDate()+", "+playback_time.getFullYear()+", "+add_zero(playback_time.getHours())+":"+add_zero(playback_time.getMinutes())),multi_select_mode&&selected_aircraft_array.length>0){remove_all_labels_multi(!0);var i=[],l=showMultiSelectRoute;$.each(selected_aircraft_array,function(e,t){i.push(t)}),$.each(i,function(e,t){t&&remove_aircraft_polylines(t)}),showMultiSelectRoute=l,selected_aircraft_array=[],$.each(i,function(e,t){t&&(selected_aircraft=t,addMultiSelect(t),query_flight_data(t),add_label(t))}),selected_aircraft="NULL",statusMultiSelect()}else multi_select_mode||"NULL"===selected_aircraft||(remove_polylines(),remove_all_labels(!0));playback_queue=[],playback_fetch_time=0,clearTimeout(fetchInterval),plane_list={},playback_fetch_time=0,clearTimeout(preFetchInterval),preFetchInterval=!1,clearTimeout(aInterval),aInterval=!1,waiting_for_pb_data=!1,fetch_playback_list()}}function timelineChangeZoom(e){null!==typeof playbackTimeline&&(playbackTimeline.zoom(e),playbackTimeline.trigger("rangechange"),playbackTimeline.trigger("rangechanged"))}function timelineMove(e){null!==typeof playbackTimeline&&(playbackTimeline.move(e),playbackTimeline.trigger("rangechange"),playbackTimeline.trigger("rangechanged"))}function pushPolyPoint(e,t,a){if(1===init_track_tooltip){void 0===a&&(a={time:null,speed:null,alt:null});var i=!1;if(a.time){a.time=1e3*a.time;var l=new Date(a.time);if(null===last_polycircle_time)last_polycircle_time=new Date(a.time),i=!0;else{var r;r=a.alt>0&&a.alt<1e3?6e4:a.alt>1e3&&a.alt<2e3?6e4:12e4,l.getTime()-last_polycircle_time.getTime()>r&&(i=!0,last_polycircle_time=new Date(a.time))}_hours=l.getUTCHours().toString().fulfill(2,0),_minutes=l.getUTCMinutes().toString().fulfill(2,0),a.time=["UTC ",_hours,":",_minutes].join("")}if(a.speed){var n={kt:1,kmh:1.852,mph:1.1508},s={kt:"kt",kmh:"km/h",mph:"mph"};a.speed=Math.round(a.speed*n[init_unit_speed])+" "+s[init_unit_speed]}if(a.alt){n={ft:1,m:.3048};a.alt=formatNumber(Math.round(a.alt*n[init_unit_alt]))+" "+init_unit_alt}if(i){var o={strokeColor:"#FF0000",strokeOpacity:0,strokeWeight:40,fillColor:e,fillOpacity:1,map:map,center:new google.maps.LatLng(t[0],t[1]),radius:tooltipRadius[map.getZoom()],customData:a};polyPointCirclesRaw.push(o);infowindow.open(map),infowindow.setContent('<div class="selectedAircfratTooltip"><div><strong>Time:</strong> -</div><div><strong>Ground speed:</strong> -</div><div><strong>Altitude:</strong>  -</div></div>'),infowindow.close()}}}function drawPolyPoint(){if(0===polyPointCirclesRaw.length)return!1;for(i=0;i<polyPointCircles.length;i++)polyPointCircles[i].setMap(null);polyPointCircles=[];for(var e=polyPointCirclesRaw.length,t=polyPointCirclesRaw[e-1].customData.alt<2e3?1:2,a=tooltipRadius[map.getZoom()],i=0;i<e-t;i++){var l=polyPointCirclesRaw[i],r=new google.maps.Circle(l);r.setRadius(a),polyPointCircles.push(r);var n=function(e){clearTimeout(infowindowHide),follow_aircraft=0;var t='<div class="selectedAircfratTooltip"><div><strong>Time:</strong> '+this.customData.time+"</div><div><strong>Ground speed:</strong> "+this.customData.speed+"</div><div><strong>Altitude:</strong> "+this.customData.alt+"</div></div>";infowindow.open(map),infowindow.setContent(t),infowindow.setPosition(new google.maps.LatLng(e.latLng.lat(),e.latLng.lng()))};google.maps.event.addListener(r,"mouseover",n),google.maps.event.addListener(r,"click",n),google.maps.event.addListener(r,"mouseout",function(){infowindowHide=setTimeout(function(){infowindow.close()},200)})}}function HandleWeatherTileChange(e,t){var a=/[0-9]{1,2}kft/gi,i=NavigationManager.isFeatureAllowed(e)?1==t:0,l=$("*[data-source='"+e+"']"),r=l.is("button")?l.val():l.data("value"),n=r.replace(a,"1kft"),s="map_weather_tile_wind_speed"===e,o=l.data("point-query"),c=l.data("overrides")?l.data("overrides").split(";"):[],p=l.hasClass("fc");l.data("z-index");if(s&&!i){for(var _=["gfs-halfdeg-windspeed-kts-1kft-msl","gfs-halfdeg-windvector-1kft-msl"],d=0;d<_.length;d++)(g=weatherTiles[_[d]])&&g.insertIndex>=0&&g.remove();$(".wind-legend, #fr24_WindsGuide").addClass("hidden")}var f=weatherTiles[n]?weatherTiles[n]:weatherTiles[n]=new WeatherTileLayer(r,p);f.productId=r;for(d=0;d<c.length;d++){var u=c[d].split(":")[0],m=c[d].split(":")[1];f[u]=m}if(0===playback_mode)if(i){weather_data_consent||displayWeatherMsg();var g=weatherTiles[disableMapping[n]];g&&g.insertIndex>=0&&g.remove(),f.show().then(function(){void 0!==o&&(pointQueries[r]?pointQueries[r]:pointQueries[r]=new window[o],pointQueries[r].init())})}else f.insertIndex>=0&&f.remove(),void 0!==o&&(void 0!==pointQueries[r]&&pointQueries[r].destroy(),delete pointQueries[r]);i&&s&&($(".wind-legend").addClass("hidden"),$("#fr24_WindsGuide, .wind-legend."+n).removeClass("hidden"),RenderWeatherAltitudeSlider()),ToggleWeatherPerformanceMessage()}function SetWindLegendUnits(){$(".legend-container span.barb").each(function(e,t){if(e>0){var a=$(t).data("value"),i=NavigationManager.ConvertUnits("wspeed",a,null,null,0),l=i.split(" ")[1];a=-1===l.indexOf("kt")?i.split(" ")[0]:a,$(t).text(a),$("h4 span.unit").text("("+l+")")}}),$(".legend-container.speed > span").each(function(e,t){if(!$(this).hasClass("row-fixer")){var a=$(t).data("value"),i=NavigationManager.ConvertUnits("wspeed",a,"m/s",null,0),l=i.split(" ")[1];a=-1===l.indexOf("ms")&&-1===l.indexOf("m/s")?i.split(" ")[0]:a,$(t).text(a),$("h4 span.unit").text("("+l+")")}})}function SetAltitudeSliderLabel(e,t){var a=(1e3*t).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",");$(e).parent().prev().html("Selected altitude: "+a+" ft")}function RenderWeatherAltitudeSlider(){var e=".weather-altitude-slider";$(e).parent().parent().removeClass("hidden"),$(e).hasClass("ui-slider")||$(e).slider({range:"min",min:1,max:51,value:1,create:function(t,a){SetWindLegendUnits();var i=$("*[data-source='map_weather_tile_wind_speed']"),l=i.attr("value"),r=/[0-9]{1,2}/gi.exec(l).toString();$("a.wspeed").attr("data-value","gfs-halfdeg-windspeed-kts-"+r+"kft-msl"),$("a.wbarbs").attr("data-value","gfs-halfdeg-windvector-"+r+"kft-msl");var n=$("a[data-value='"+l+"']").text();i.text(n),$(this).slider("value",r),SetAltitudeSliderLabel(e,r)},stop:function(e,t){var a=$("*[data-source='map_weather_tile_wind_speed']"),i=a.attr("value"),l=/[0-9]{1,2}/gi;i=i.replace(l,t.value),a.attr("value",i),$("a.wspeed").attr("data-value","gfs-halfdeg-windspeed-kts-"+t.value+"kft-msl"),$("a.wbarbs").attr("data-value","gfs-halfdeg-windvector-"+t.value+"kft-msl");var r=i.replace(l,"1");if(void 0!==weatherTiles[r]){setSetting("map_weather_tile_wind_speed",i);var n=weatherTiles[r];n.productId=i,n.setupTileCall(n.currentTime,!0)}},slide:function(t,a){SetAltitudeSliderLabel(e,a.value)}})}function ToggleWeatherPerformanceMessage(){$("#layoutsettings .toggle.on").length>=2?$(".weather-performance-msg").show():$(".weather-performance-msg").hide()}function HandleSettingChange(e,t){var a=!1,i=!1;switch(e){case"map_enable_filters":enable_filters=parseInt(t),a=!0;break;case"map_enable_unblock_filters":init_unblock_filters=parseInt(t),a=!0,NavigationManager&&"function"==typeof NavigationManager.renderFilterPopup&&NavigationManager.renderFilterPopup();break;case"map_airports":0==(init_airports=parseInt(t))&&clearMapPins("airport"),i=!0;break;case"map_airport_density":init_airport_density=parseInt(t),a=!0;break;case"show_ground_traffic":ground_traffic=parseInt(t),a=!0;break;case"show_gliders":glider_traffic=parseInt(t),a=!0;break;case"show_vehicles":vehicular_traffic=parseInt(t),a=!0;break;case"show_airborn_traffic":airborn_traffic=parseInt(t),a=!0;break;case"clock_local":init_clock_local=parseInt(t);break;case"clock_12h":init_clock_12h=parseInt(t);break;case"show_faa_traffic":faa_traffic=parseInt(t),a=!0;break;case"show_mlat_traffic":mlat_traffic=parseInt(t),a=!0;break;case"show_adsb_traffic":adsb_traffic=parseInt(t),a=!0;break;case"show_flarm_traffic":flarm_traffic=parseInt(t),a=!0;break;case"show_estimated_traffic":estimated_traffic=parseInt(t),a=!0;break;case"animate_aircraft":a_active=init_anim=t;break;case"map_weather_tile_ir_satellite":weather_tile_ir_satellite=parseInt(t),!playback_mode&&HandleWeatherTileChange(e,weather_tile_ir_satellite);break;case"map_weather_tile_global_radar":weather_tile_global_radar=parseInt(t),!playback_mode&&HandleWeatherTileChange(e,weather_tile_global_radar);break;case"map_weather_tile_air_sigmets":weather_tile_air_sigmets=parseInt(t),!playback_mode&&HandleWeatherTileChange(e,weather_tile_air_sigmets);break;case"map_weather_tile_volcanic_eruptions":weather_tile_volcanic_eruptions=parseInt(t),!playback_mode&&HandleWeatherTileChange(e,weather_tile_volcanic_eruptions);break;case"map_weather_tile_sigwx_high":weather_tile_sigwx_high=parseInt(t),!playback_mode&&HandleWeatherTileChange(e,weather_tile_sigwx_high);break;case"map_weather_tile_lightning_heat_map":weather_tile_lightning_heat_map=parseInt(t),!playback_mode&&HandleWeatherTileChange(e,weather_tile_lightning_heat_map);break;case"map_weather_tile_precipitation_rate_forecast":weather_tile_precipitation_rate_forcast=parseInt(t),!playback_mode&&HandleWeatherTileChange(e,weather_tile_precipitation_rate_forcast);break;case"map_weather_tile_wind_speed":weather_tile_wind_speed=-1!==t.indexOf("gfs")?1:0,!playback_mode&&HandleWeatherTileChange(e,weather_tile_wind_speed);break;case"map_lightning":1==(init_lightning=parseInt(t))?(lightningLayer=lightningLayer||new LightningLayer,!playback_mode&&lightningLayer.initializeLightning()):lightningLayer&&lightningLayer.hideLightning();break;case"map_weather":1===(init_weather=parseInt(t))?(weatherLayer=weatherLayer||new WeatherLayer,!playback_mode&&weatherLayer.initializeWeather(map)):weatherLayer&&weatherLayer.resetData();break;case"map_sidemenu_photo_hide":init_sidemenu_photo_hide=parseInt(t),toggleAircraftPhoto();break;case"unit_speed":init_unit_speed=t;break;case"unit_temp":init_unit_temp=t,1==init_weather&&(weatherLayer=weatherLayer||new WeatherLayer).initializeWeather();break;case"unit_alt":init_unit_alt=t;break;case"unit_dist":init_unit_dist=t;break;case"map_aircraft_size":init_aircraft_size=t,i=!0;break;case"map_labels":init_labels=parseInt(t),show_labels=init_labels,0===init_labels?delete_all_labels():planes_showing<=250?show_labels=1:planes_showing>250&&(show_labels=0),i=!0;break;case"map_label_1":case"map_label_2":case"map_label_3":case"map_label_4":window[e.replace("map_","init_")]=t,init_labels&&(delete_all_labels(),i=!0);break;case"map_label_bkg":init_label_bkg=parseInt(t),0===init_label_bkg?$("body").addClass("hide-label-bkg"):$("body").removeClass("hide-label-bkg");break;case"map_track_tooltip":init_track_tooltip=parseInt(t);break;case"map_tracks":1===(init_tracks=parseInt(t))?fr24Tracks.loadTracks():fr24Tracks.removeTracks();break;case"map_atc":(t=parseInt(t))!==init_atc&&(1===(init_atc=t)?loadATC():removeATC());break;case"map_navdata":t!==init_navcharts&&(init_navcharts=t,"none"!==t&&void 0!==dispatcher.userFeatures["map.layer.atc"]&&"enabled"===dispatcher.userFeatures["map.layer.atc"]?("undefined"==typeof navdataLayer&&(navdataLayer=new NavDataLayer),navdataLayer.createLayer(t)):"undefined"!=typeof navdataLayer&&navdataLayer.removeLayer());break;case"map_type":init_type!=t&&"delayView"!==map_left_menu_view&&(init_type=t,map.setMapTypeId(t));break;case"map_fade":init_fade=parseInt(t);var l=$(".map-opacity-overlay");l&&l.css("opacity",init_fade/100);break;case"map_night":"object"==typeof nite&&(1==t?(0==nite_initialised&&(nite.init(map),niteInterval=setInterval(function(){nite.refresh()},1e4),nite_initialised=1),nite.show()):nite_initialised&&(clearTimeout(niteInterval),nite.hide()));break;case"menu_stats":init_menu_stats=parseInt(t),toggleStats("aircraft");break;case"menu_stats_status":init_menu_stats_status=parseInt(t),showLeftMenuItem($("#menuStats a.menuChoice"));break;case"menu_delay_stats_status":init_setting_menu_delay_stats_status=parseInt(t),showLeftMenuItem($("#menuAirportStats a.menuChoice"));break;case"menu_twitter_status":init_menu_twitter_status=parseInt(t),showLeftMenuItem($("#menuTwitter h5"));break;case"menu_blog_status":init_menu_blog_status=parseInt(t),showLeftMenuItem($("#menuBlog h5"));break;case"menu_delay_stats_continent":"-1"!=(init_menu_delay_stats_continent=parseInt(t))&&void 0!==angular.element("#menuAirportStats").scope()&&angular.element("#menuAirportStats").scope().fetchStats(),toggleStats("delay");break;case"menu_socialmedia":init_menu_socialmedia=parseInt(t),toggleSocialMedia();break;case"menu_twitter":init_menu_twitter=parseInt(t),toggleTwitter();break;case"menu_blog":init_menu_blog=parseInt(t),toggleBlog();break;case"map_sidebar_closed":setting_map_sidebar_closed=0,showSidebar();break;case"map_left_menu_view":map_left_menu_view=t,showLeftOverlay=""===t||"mapView"===t}!0===a?(clearTimeout(fetchInterval),fetch_plane_list()):!0===i&&(update_static_pins(),update_planes(1)),ToggleWeatherPerformanceMessage()}function handleEstimatedTraffic(){estimated_traffic=dataSourcesTurnedOff()?0:$("#fr24_showEstimated button").val(),FullRefresh=!0}function dataSourcesTurnedOff(){return 0==adsb_traffic&&0==flarm_traffic&&0==mlat_traffic&&0==faa_traffic}function updateSliderUnits(){if(1!=simple_mode){var e=$("#fr24_FilterAltitude").slider("option"),t=$("#fr24_FilterSpeed").slider("option");e.slide(null,e),t.slide(null,t),NavigationManager.renderFilterPopup()}}function displayNotification(e,t,a){var i;html='<div class="notify-msg '+e+'">',html+=t,html+="</div>";var l=$(html);$("#mapStaticOverlays #notifications").prepend(l),void 0!==a&&((i=l.find("button")).get(0)||(i=l),i.on("click",a)),l.fadeIn("fast")}function displayShowAllMsg(){if(-1===$.inArray(map_left_menu_view,enabledShowMessageViews))return!1;displayNotification("showall-msg","Your visibility setting have been temporarily disabled. <br/>Press here to restore your settings.",function(){removeShowAllMsg();var e=$(this);e.fadeOut("fast",function(){e.remove()})})}function displayWeatherMsg(){if(0==$(".weather-msg").length){displayNotification("weather-msg",'The weather data is provided by Baron "as-is" without any warranty. It should only be used for informational purposes and not for safety-of-life.Flightradar24 or Baron will not be held responsible for injury, death, damage, loss, delay, cost, expense, or inconvenience arising from improper use of the data.<br /><button>Got it</button>',function(){var e=$(this).closest("div");e.fadeOut("fast",function(){e.remove(),weather_data_consent=1,setCookie("weather_data_consent",1,365)})})}}function displayCookieMsg(){displayNotification("cookielaw-msg",'This site requires cookies in order to work properly. <a target="_blank" href="/privacy-policy">Find out more</a>.<button>Got it</button>',function(){var e=$(this).closest("div");e.fadeOut("fast",function(){e.remove(),setCookie("cookie_law_consent",1,365,dispatcher.cookieDomain)})})}function getShowAllIndex(){for(var e=null,t=0;t<=filters.length-1;t++)"showall"==filters[t][0]&&"true"==filters[t][1]&&(e=t);return e}function removeShowAllMsg(){var e=getShowAllIndex();$("#mapStaticOverlays .showall-msg").remove(),null!==e&&filters.splice(e,1),clearTimeout(fetchInterval),fetch_plane_list()}function updateNiteOverlay(e){if(1==init_nite&&"object"==typeof nite){var t=void 0===e?new Date:e;nite.setDate(t)}}function fetchAircraftByReg(){if(""==query_reg)return clearTimeout(fetchByRegInterval),!1;var e="/zones/fcgi/feed.js?faa=1&gnd=1&mlat=1&estimated=1&flarm=1&adsb=1&vehicles=1&gliders=1&reg="+query_reg;e+=addPublicKey();var t="//"+dispatcher.urls.feedPlaneList;$.ajax(t+e,{type:"GET",dataType:feed_request_method,timeout:5e3}).done(function(e){"object"==typeof e&&$.each(e,function(e,t){if(t[1]&&t[2]){map.setZoom(10);var a=new google.maps.LatLng(t[1],t[2]);isAirportView()||map.panToOffsetted(a)}})}),clearTimeout(fetchByRegInterval),fetchByRegInterval=setTimeout(function(){fetchAircraftByReg()},6e4)}function toggleSocialMedia(){1===init_menu_socialmedia?$("#menuSocialmedia").slideDown("slow"):$("#menuSocialmedia").slideUp("slow")}function toggleTwitter(){1===init_menu_twitter?$("#menuTwitter").slideDown("slow"):$("#menuTwitter").slideUp("slow")}function toggleAircraftPhoto(){1===init_sidemenu_photo_hide?$("body").addClass("hide-aircraft-photo"):$("body").removeClass("hide-aircraft-photo")}function toggleBlog(){1===init_menu_blog?$("#menuBlog").slideDown("slow"):$("#menuBlog").slideUp("slow")}function toggleStats(e){switch(e){case"aircraft":1===init_menu_stats?$("#menuStats").slideDown("slow"):$("#menuStats").slideUp("slow");break;case"delay":-1!=init_menu_delay_stats_continent?$("#menuAirportStats").slideDown("slow"):$("#menuAirportStats").slideUp("slow")}}function showStats(e){var t=0,a=0;$("#menuStatsContent span.text").each(function(){var i=$(this).attr("data-radar");void 0!==i&&(t+=e.visible[i],a+=e.total[i],$(this).html(e.visible[i]+' <span class="total">'+numberWithCommas(e.total[i])+"</span>"))}),t=numberWithCommas(t),a=numberWithCommas(a),$("#statTotal").html(t+' <span class="total">'+a+"</span>"),$("#menuPlanesValue").html(t+(0==t?'<img src="'+dispatcher.urls.static+'/images/warning.png" style="margin-left: 2px;" title="You are either watching an area without coverage, or have set a too strict filter." /> / ':" / ")+a)}function numberWithCommas(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function recordOutboundLink(e,t,a){t&&""!=t||(t="Outbound Links"),a&&""!=a||(a=$(e).attr("href"))}function calcTextWidth(e){var t=e.html(),a="<span>"+t+"</span>";e.html(a);var i=e.find("span:first").width();return e.html(t),i}function showAircarfInfoWindow(){showLeftOverlay||isMapView()||"function"==typeof angular.element($("#aircraftInfoOverlay")).scope().showInfoBox&&angular.element($("#aircraftInfoOverlay")).scope().showInfoBox()}function updateViewData(){var e=getCurrentView();if(e)switch(map_left_menu_view){case"listView":"function"==typeof e.scope().renderListViewData&&(e.scope().renderListViewData(),e.scope().$apply())}}function adjustViewHeight(){var e=getCurrentView();if(e&&"function"==typeof e.scope().adjustHeight){var t=e.scope().$root.$$phase;e.scope().initTopbarLocal=init_topbar,e.scope().adjustHeight(),"$apply"!==t&&"$digest"!==t&&e.scope().$apply()}}function viewToggleTopbar(){var e=getCurrentView();if(e){var t=e.scope().$root.$$phase;e.scope().initTopbarLocal=init_topbar,"$apply"!==t&&"$digest"!==t&&e.scope().$apply()}}function getCurrentView(){var e=null;if(map_left_menu_view){var t=$("#"+map_left_menu_view);t.is(":visible")&&"undefined"!=typeof angular&&(e=angular.element(t))}return e}function isMapView(){return""===map_left_menu_view||"mapView"===map_left_menu_view||"fullscreenView"===map_left_menu_view||"multiView"===map_left_menu_view}function isMapPannable(){return"mapView"===map_left_menu_view||"airportView"===map_left_menu_view||"fullscreenView"===map_left_menu_view||"fleetView"===map_left_menu_view||"multiView"===map_left_menu_view}function isFleetView(){return"fleetView"===map_left_menu_view}function isListView(){return"listView"===map_left_menu_view}function isAirportView(){return"airportView"===map_left_menu_view}function updateUserFeatures(){if(!0===pauseFeed)return!1;$.getJSON(dispatcher.urls.site+"/user/features",function(e){dispatcher.userFeatures=e}).fail(function(){})}function fetch_atc_tile(e,t){var a=getNormalizedCoord(e,t);return a?"//tiles.flightradar24.com/atc_boundaries/"+t+"/"+a.x+"/"+a.y+"/tile.png":null}function getNormalizedCoord(e,t){var a=e.y,i=e.x,l=1<<t;return a<0||a>=l?null:((i<0||i>=l)&&(i=(i%l+l)%l),{x:i,y:a})}function loadATC(){if(void 0===dispatcher.userFeatures["map.layer.atc"]||"enabled"!==dispatcher.userFeatures["map.layer.atc"])return!1;var e;null===mapAtcLayer&&(mapAtcLayer=new google.maps.ImageMapType({getTileUrl:fetch_atc_tile,tileSize:new google.maps.Size(256,256)}),$(window).on("visibilitychange.atc",function(){document.hidden&&(e=!1)}),atcMapEventHandler=google.maps.event.addListener(map,"click",function(t){if($(window).keydown(function(t){(t.metaKey||t.ctrlKey)&&(e=!0),$(window).one("keyup",function(t){e=!1})}),e){var a={lat:t.latLng.lat(),lon:t.latLng.lng()};$.getJSON(dispatcher.urls.site+"/geodata/atc_name",a,function(e){var a=e.map(function(e){return e.name}).join(" / ");a in atcPopups&&(atcPopups[a].close(),delete atcPopups[a]);var i="<div class='googft-info-window atc-popup'><a class='atc-tower-icon'></a><span class='atc-tower-text'>"+a+"</span></div>",l=new google.maps.InfoWindow({content:i,position:t.latLng});l.open(map),atcPopups[a]=l})}})),null!==mapAtcLayer&&(map.overlayMapTypes.push(null),-1==mapAtcLayerIdx&&(mapAtcLayerIdx=map.overlayMapTypes.length-1),map.overlayMapTypes.setAt(mapAtcLayerIdx,mapAtcLayer))}function removeATC(){if(null!==mapAtcLayer){google.maps.event.removeListener(atcMapEventHandler),map.overlayMapTypes.setAt(mapAtcLayerIdx,null),mapAtcLayer=null;for(var e in atcPopups)atcPopups.hasOwnProperty(e)&&(atcPopups[e].close(),delete atcPopups[e]);$(window).off("visibilitychange.atc")}}function create_selected_aircraft_graph(e,t){var t=t||"#altSpeedGraph";if($(t).is(":visible")){var a=[],i=[];$.each(e,function(e,t){if(t.hasOwnProperty("alt")){var l=1e3*t.ts;i.push([l,parseInt(NavigationManager.ConvertUnits("altitude",t.alt,!1,!1,!1,!0,""))]),a.push([l,parseInt(NavigationManager.ConvertUnits("speed",t.spd,!1,!1,!1,!0,""))])}}),i.reverse(),a.reverse(),i.sort(function(e,t){return e[0]-t[0]}),a.sort(function(e,t){return e[0]-t[0]});var l={label:{spd:{},alt:{}},interval:18e5},r={kt:"kt",kmh:"km/h",mph:"mph"}[init_unit_speed],n=init_unit_alt;"#altSpeedGraph"===t?(l.label.spd={enabled:!1},l.label.alt={enabled:!1}):(l.label.spd={format:"{value:,.0f} "+r,style:{color:"#d1d0d0",fontSize:"1.3em"}},l.label.alt={format:"{value:,.0f} "+n,style:{color:"#d1d0d0",fontSize:"1.3em"}},l.interval=9e5),$(t).highcharts({credits:{enabled:!1},global:{useUTC:!0,timezoneOffset:0},lang:{decimalPoint:".",thousandsSep:","},chart:{zoomType:"xy",backgroundColor:"transparent",spacing:[10,0,10,0],style:{fontFamily:'"Roboto Condensed",sans-serif',fontSize:"1em"}},title:{text:""},xAxis:[{type:"datetime",dateTimeLabelFormats:{hour:"%H:%M"},gridLineWidth:"0.1em",gridLineColor:"#6d6d6d",tickPixelInterval:80,title:{text:"UTC",align:"low",offset:0},labels:{style:{fontFamily:'"Roboto Condensed",sans-serif',fontSize:"1.3em",color:"#d1d0d0"}}}],yAxis:[{min:0,gridLineWidth:1,gridLineColor:"#6d6d6d",labels:l.label.alt,tickPixelInterval:48,title:{text:"",style:{color:"#64bef1"}}},{min:0,gridLineWidth:1,gridLineColor:"#6d6d6d",tickPixelInterval:48,title:{text:"",style:{color:"#f8c023"}},labels:l.label.spd,opposite:!0}],tooltip:{shared:!0,borderRadius:0,borderWidth:0,shadow:!1,useHTML:!0,style:{fontSize:"1em"},backgroundColor:"#fff",valueDecimals:0,xDateFormat:'<span style="display:inline-block; margin-bottom: 0.2em;">%A, %b %e, %H:%M (UTC)</span>',pointFormat:'<div style="line-height: 1.2em"><span style="margin-right: 0.3em; font-size: 1.2em; display: inline-block; text-transform: uppercase; color: {series.color}">{series.name}:</span> <span style="font-size: 1.3em;">{point.y}</span></div>'},legend:{enabled:!1,layout:"vertical",align:"right",x:-110,verticalAlign:"top",y:47,floating:!0,backgroundColor:"#fff"},plotOptions:{spline:{lineWidth:2,states:{hover:{lineWidth:3}},marker:{enabled:!1}}},series:[{pointStart:0,name:"Speed",color:"#ddba2f",type:"spline",yAxis:1,data:a,tooltip:{valueSuffix:" "+r}},{pointStart:0,name:"Altitude",color:"#81b5f0",type:"spline",data:i,tooltip:{valueSuffix:" "+n}}]})}}function update_selected_aircraft_graph(e){var t=$("#altSpeedGraph").highcharts();if($("#altSpeedGraphContainer").is(":visible")&&t){a=1e3*e.ts;t.series[0].addPoint([a,parseInt(NavigationManager.ConvertUnits("speed",e.spd,!1,!1,!1,!0,""))],!0,!1),t.series[1].addPoint([a,parseInt(NavigationManager.ConvertUnits("altitude",e.alt,!1,!1,!1,!0,""))],!0,!1)}if(t=$("#altSpeedGraphLarge").highcharts(),$("#altSpeedGraphContainerLarge").is(":visible")&&t){var a=1e3*e.ts;t.series[0].addPoint([a,parseInt(NavigationManager.ConvertUnits("speed",e.spd,!1,!1,!1,!0,""))],!0,!1),t.series[1].addPoint([a,parseInt(NavigationManager.ConvertUnits("altitude",e.alt,!1,!1,!1,!0,""))],!0,!1)}}function getScrollbarWidth(){var e=document.createElement("div");e.style.visibility="hidden",e.style.width="100px",e.style.msOverflowStyle="scrollbar",document.body.appendChild(e);var t=e.offsetWidth;e.style.overflow="scroll";var a=document.createElement("div");a.style.width="100%",e.appendChild(a);var i=a.offsetWidth;return e.parentNode.removeChild(e),t-i}function showLeftMenuItem(e){var t,a=$(e).parent(),i=$(e).next(),l=null,r=$(e).parent().parent();switch(void 0!==r.attr("id")&&(a=r),a.attr("id")){case"menuStats":l=init_menu_stats_status;break;case"menuAirportStats":l=init_setting_menu_delay_stats_status;break;case"menuBlog":1===(l=init_menu_blog_status)?$("body").addClass("blog-feed"):$("body").removeClass("blog-feed");break;case"menuTwitter":1===(l=init_menu_twitter_status)?$("body").addClass("news-feed"):$("body").removeClass("news-feed")}return a.removeClass("active"),1==l?($(".fa.fa-chevron-circle-right",a).removeClass("fa-chevron-circle-right").addClass("fa-chevron-circle-down"),i.slideDown(600,function(){getMediaFeedLimits()}),t=1):0==l&&($(".fa.fa-chevron-circle-down",a).removeClass("fa-chevron-circle-down").addClass("fa-chevron-circle-right"),i.slideUp(600,function(){getMediaFeedLimits()}),t=0),t}function handleVisibilityChange(){if(map_delays_mode)return!1;if(document.hidden)pauseFeed=!0,init_anim=0,1==playback_play&&($(this).removeClass("pause").addClass("play"),$("#playback-step-back").attr("disabled",!1),$("#playback-step-forward").attr("disabled",!1),clearTimeout(playbackInterval),playbackInterval=!1,clearTimeout(aInterval),aInterval=!1,clearTimeout(preFetchInterval));else{if("function"==typeof renewPublicKey&&renewPublicKey(),pauseFeed=!1,getSetting("animate_aircraft")&&(init_anim=1),clearTimeout(fetchInterval),fetchInterval=setTimeout(fetch_plane_list,500),multi_select_mode){remove_all_labels_multi(!0);var e=[],t=showMultiSelectRoute;$.each(selected_aircraft_array,function(t,a){e.push(a)}),$.each(e,function(e,t){t&&remove_aircraft_polylines(t)}),showMultiSelectRoute=t,selected_aircraft_array=[],$.each(e,function(e,t){t&&(selected_aircraft=t,addMultiSelect(t),query_flight_data(t),add_label(t))}),selected_aircraft="NULL",statusMultiSelect()}else multi_select_mode||"NULL"===selected_aircraft||(remove_all_labels(),remove_polylines(),query_flight_data(selected_aircraft));update_planes(),setTimeout(function(){void 0!==angular.element("#menuAirportStats").scope()&&angular.element("#menuAirportStats").scope().fetchStats(),get_mediaFeeds()},3e5),1==playback_play&&($(this).removeClass("play").addClass("pause"),$("#playback-step-back").attr("disabled",!0),$("#playback-step-forward").attr("disabled",!0),clearTimeout(playbackInterval),playbackInterval=setTimeout("playback_change_time('')",500),clearTimeout(preFetchInterval),preFetchInterval=!1,playback_change_fetch_time())}}function arrangeMultiSelectWindows(){if(!showMultiSelectInfo)return!1;var e=$("#leftColOverlayMulti .flightInfoboxMulti");if(0===e.length)return!1;e.each(function(e){$(this).removeClass(function(e,t){return(t.match(/\bfib-i-\S+/g)||[]).join(" ")}),$(this).addClass("fib-i-"+e)});var t=$(window).height(),a=e.first().outerHeight()+$("#multiSelectShowRoute").outerHeight(),i=Math.floor(t/a);$("#leftColOverlayMulti .flightInfoboxMulti:lt("+i+")").css({clear:"both",float:"left"}),$("#leftColOverlayMulti .flightInfoboxMulti:gt("+(i-1)+")").css({display:"inline-block"}),statusMultiSelect()}function statusMultiSelect(){var e=$("#multiSelectShowRoute"),t=$("#multiSelectInfoWindow");selected_aircraft_array.length>0?(showMultiSelectRoute?e.removeClass("gray").removeClass("white").addClass("yellow"):e.removeClass("yellow").removeClass("gray").addClass("white"),showMultiSelectInfo?(t.removeClass("gray").removeClass("white").addClass("yellow"),$(".icon-gray, .icon-white",t).hide(),$(".icon-yellow",t).show()):(t.removeClass("yellow").removeClass("gray").addClass("white"),$(".icon-yellow, .icon-gray",t).hide(),$(".icon-white",t).show())):(e.removeClass("yellow").removeClass("white").addClass("gray"),t.removeClass("yellow").removeClass("white").addClass("gray"),$(".icon-white, .icon-yellow",t).hide(),$(".icon-gray",t).show())}function changeViewTitleText(e){var t=$('#fr24_ViewsDropdown li a[data-value="'+e+'"]');if(t.length>0){var a=t.text(),i=t.data("icon");$("#fr24_ViewsDropdown a").removeClass("selected"),t.addClass("selected"),t.parents(".dropdown").find(".dropdown-toggle").html('<svg class="view-icon"><use xlink:href="#icon-fr24-'+i+'" /></svg><span class="view">'+a+'</span> <svg><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#icon-fr24-arrow-down"></use></svg>')}}function historyReplaceState(e){if(isset(Fr24,"AirportPanel")&&Fr24.AirportPanel.isOpen())return!1;if(!map||$("#modalBlackout").length>0)return!1;var t="/";if(1==simple_mode&&(map_left_menu_view="mapView",t+="simple/"),"mapView"!=map_left_menu_view&&(t+=map_left_menu_view.toLowerCase()+"/"),"airportView"==map_left_menu_view){var a=getSetting("airportViewAirport");t+=a?a.toLowerCase()+"/":""}else if("fleetView"==map_left_menu_view){var i=getSetting("fleetViewAirline"),l="";i&&i.fleet?l="custom-"+i.fleet:i&&i.airline&&(l=i.airline),t+=l?l.toLowerCase()+"/":""}if(0==simple_mode)if(1==playback_mode){var r=/([0-9-\.])+,([0-9-\.])+\/[0-9]{1,2}$/i,n=/airport\/[a-z]{3}$/i,s=window.location.pathname;"NULL"==selected_aircraft?(r.test(s)||"/"===s||n.test(s))&&(t+=playback_time.getFullYear()+"-"+add_zero(playback_time.getMonth()+1)+"-"+add_zero(playback_time.getDate())+"/"+add_zero(playback_time.getHours())+":"+add_zero(playback_time.getMinutes())+"/"+playback_speed+"x/"+Math.round(100*map.center.lat())/100+","+Math.round(100*map.center.lng())/100+"/"+map.zoom):"NULL"!=selected_aircraft&&plane_list&&plane_list[selected_aircraft]&&!multi_select_mode&&(o=(o=plane_list[selected_aircraft][16].replace("#","")).replace("*",""),t+=playback_time.getFullYear()+"-"+add_zero(playback_time.getMonth()+1)+"-"+add_zero(playback_time.getDate())+"/"+add_zero(playback_time.getHours())+":"+add_zero(playback_time.getMinutes())+"/"+playback_speed+"x/"+o+"/"+selected_aircraft)}else if(1!=playback_mode)if("NULL"!=selected_aircraft&&plane_list&&selected_aircraft in plane_list&&plane_list[selected_aircraft].length>2){var o=plane_list[selected_aircraft][16].replace("#","");o=o.replace("*",""),multi_select_mode?multi_select_mode&&(t+=selected_aircraft_array.join(",")):t+=load3dView?o+"/"+selected_aircraft+"/3d":o+"/"+selected_aircraft}else selected_aircraft_array.length>0?t+=selected_aircraft_array.join(","):t+=Math.round(100*map.center.lat())/100+","+Math.round(100*map.center.lng())/100+"/"+map.zoom;e&&"object"==typeof _gaq&&_gaq.push(["_trackPageview",t]),History.replaceState({currentSection:""},document.title,t)}function addMultiSelect(e){if(!multi_select_mode)return!1;var t=selected_aircraft_array.length;if(t>=selected_aircraft_limit&&-1===$.inArray(e,selected_aircraft_array)){var a=selected_aircraft_limit-1,i=selected_aircraft_array.splice(0,t-a);$.each(i,function(e,t){remove_aircraft_polylines(t)}),selected_aircraft_array.push(e)}else{if(-1!==$.inArray(e,selected_aircraft_array)){var l=$.inArray(e,selected_aircraft_array),i=selected_aircraft_array[l];return selected_aircraft_array.splice(l,1),remove_aircraft_polylines(i),0===selected_aircraft_array.length&&(showMultiSelectRoute=!1,$(".flightInfoboxMulti").remove()),statusMultiSelect(),!1}selected_aircraft_array.push(e)}return!0}function addPublicKey(){var e="";if(cookie_pubkey){var t=cookie_pubkey;1==_objLocalStorage.getItem("clearKey")&&(t="!"+t,_objLocalStorage.setItem("clearKey",0)),e="&pk="+t}return e}function showPromoPopup(){if($(window).width()<760)return!1;closeAircraftDataCount>=4&&$("#carousel-dialog").length>0&&1!==parseInt(getSetting("show_promo_popup"))?($("#carousel-dialog").dialog({modal:!0,draggable:!1,buttons:{Ok:function(){$(this).dialog("close")}},open:function(e,t){var a=t.dialog|t;$("#carousel").slidingCarousel({squeeze:100}).initialize(),$("#mapStaticOverlays").hide(),$(".ui-dialog").addClass("carousel-background"),$(".ui-dialog").css("position","absolute"),$(this).dialog("adjustWidth",t);var i=$(".ui-dialog-content",a).data("width");$(".ui-dialog").css({top:$("body").scrollTop()+60+"px",width:i})},close:function(){$("#mapStaticOverlays").show()},resizable:!1,width:750}),setSetting("show_promo_popup",1)):closeAircraftDataCount<=4&&closeAircraftDataCount++}var _objLocalStorage=new Fr24.LocalStorage,atcMapEventHandler=null,atcPopups={},closeAircraftDataCount=0,fetchByRegInterval=null,infowindow,infowindowHide=null,intAircraftLimitForLabel=400,last_polycircle_time=null,mapAtcLayer=null,mapAtcLayerIdx=-1,objSelectedAirportMarker=null,paramAircraftLimit=parseInt(getParam("aircraftLimit",1e3)),paramMaxAlt=parseInt(getParam("maxAlt",5e4)),paramMaxSpeed=parseInt(getParam("maxSpeed",1e3)),paramMinAlt=parseInt(getParam("minAlt",0)),paramMinSpeed=parseInt(getParam("minSpeed",0)),paramNoProgress=parseInt(getParam("noProgress",0)),paramNoTime=parseInt(parseInt(getParam("noTime",0))),playbackTimeline=null,playbackTimelineOpt={width:"100%",height:"60px",min:null,max:null,zoomMin:18e6,zoomMax:31536e10,showCustomTime:!0},polylineInCoverage=[],polyPointCircles=[],polyPointCirclesRaw=[],radarRegexp=/^F-EST$/,selected_airline=null,tooltipRadius={2:125,3:83,4:62,5:50,6:41,7:35,8:31,9:27,10:25,11:22,12:20,13:19,14:13,15:8,16:4,17:3,18:2,19:1,20:1,21:1,22:1},windowScrollbarPadding=null,windowScrollbarWidth=null,aInterval=!1,aircraft_id,aircraft_track,aircraftInfoLevel=dispatcher.userFeatures["map.info.aircraft"],aircraftInfowindow=null,airport_index={},clock_interval=5e3,continents=[1,3,4,5,6,7],cookie_enc=null,cookie_pubkey=null,current_hover,document_title="Flightradar24",enabledShowMessageViews=["mapView","fullscreenView"],feed_error=0,feed_fetch_timeout,feed_queued=0,feed_request_method="json",feed_request_slam_ms=1e3,feed_request_time_ms=0,feed_state="init",fetchInterval,timeInterval,preFetchInterval,loginCheckInterval,updateInterval,niteInterval,flightInfoLevel=dispatcher.userFeatures["map.info.flight"],follow_aircraft=0,force_init_call=0,geolocation_move=!1,ignoredSettings=["map_lat","map_lon","map_zoom","new_version_dialog_closed","awd_dismissed","menu_twitter_status","menu_blog_status","map_left_menu_view"],init_aircraft_size="auto",init_airport_density=100,init_ash_alt="1;1;1",init_ash_valid=0,init_atc=0,init_call=0,init_clock_12h,init_clock_local,init_filter,init_filter_check=0,init_follow=1,init_goto_aircraft=null,init_label_1="cs",init_label_2,init_label_3,init_label_4,init_labels=0,init_lat=60,init_lon=15,init_menu_blog=1,init_menu_blog_status=1,init_menu_delay_stats_continent=0,init_menu_socialmedia=1,init_menu_stats=1,init_menu_stats_status=0,init_menu_twitter=1,init_menu_twitter_status=1,init_navcharts="none",init_setting_menu_delay_stats_status=1,init_track_tooltip=0,init_tracks=0,init_type="terrain",init_unit_alt="ft",init_unit_dist="km",init_unit_speed="kt",init_unit_temp="c",init_zoom=6,isDragged=!1,isMapDblClick,load3dView=!1,map,map_delays_mode=!1,map_fullscreen_view=0,map_left_menu_view="mapView",map_nav_pins={airport:{},route:{}},mouseEvent=document.createEvent("MouseEvents"),multi_select_mode=!1,nav_list={airport:[],route:[]},pauseFeed=!1,plane_list={},plane_list_old={},plane_list_org={},plane_list_next=!1,planeInfoLoadingTimeout,planes_array={},planes_showing=0,planes_total=0,playback_queue=[],playback_speed=12,playback_tick_ms=0,playback_tick_ms_real=0,playback_tick_ms_step=100,playback_tick_ms_ts=0,selected_aircraft="NULL",selected_aircraft_array=[],selected_aircraft_limit=6,selected_count={},selected_data={},selected_data_ems={ems:{},availability:[],aircraft:null,airspace:""},selective_unblocking=[],seleted_airport,show_labels=0,showLeftOverlay=!0,showMultiSelectInfo=!0,showMultiSelectRoute=!1,sidebar_closed=0,subscriptionFeatureTooltip="web"===dispatcher.userSubscriptionPlatform&&dispatcher.display.isDevice?"":"hasTooltip",subscriptionUpgradetext=dispatcher.subscriptionUpgradetext,timeLocal=new Date;if(window.fnPopulateClickhandlerData=function(){},1==simple_mode)var init_airports=0,init_fade=30;else var init_airports=1,init_fade=40;if(void 0===refresh_rate)var refresh_rate=8e3;var init_vor=0,init_ndb=0,init_sidemenu_photo_hide=0,init_topbar=1,init_weather=0,init_clouds=0,init_lightning=0,init_precipitations=0,init_pressure=0,init_snow=0,init_wind=0,init_temp=0,init_nite=1,nite_initialised=0,ground_traffic=1,glider_traffic=1,vehicular_traffic=1,airborn_traffic=1,faa_traffic=1,mlat_traffic=1,adsb_traffic=1,flarm_traffic=1,estimated_traffic=240,init_ash_clouds=1,init_navdata=0,max_filters=7,cloudLayer,weatherLayer,precipitationLayer,pressureLayer,snowLayer,windLayer,tempLayer,lightningLayer,weather_tile_ir_satellite=0,weather_tile_global_radar=0,weather_tile_air_sigmets=0,weather_tile_volcanic_eruptions=0,weather_tile_sigwx_high=0,weather_tile_precipitation_rate_forcast=0,weather_tile_wind_speed=0,weather_tile_lightning_heat_map=0,enable_filters=1,init_unblock_filters=0,fetch_plane_list,update_planes,delete_planes,show_loader,hide_loader,add_label,query_flight_id="",query_callsign="",query_pb_date="",query_pb_time="",query_lat="",query_lon="",query_z="",query_airport="",query_airportInfo=0,query_solo=0,query_view=0,query_single=0,$query_callsign=null,setCookie,getCookie,polylines={},polylines_index={},polylines_fake={},polylines_fake_index={},filters=[],show_aircraft_data,remove_polylines,show_aircraft_data_requests=0,show_aircraft_data_threshold=3,init_anim=1,a_active=1,mouseMove=0,total_count=0,planes_array_fake={},UTC_hour,UTC_minute,i,aircraft_static_values=[["Airline","airline"],["Flight","flight"],["From","from_city"],["Via","via"],["Via","via2"],["To","to_city"],["Comment","comment"],["Aircraft","aircraft"]],aircraft_dynamic_values=[["ETA",17],["Reg",9],["Altitude",4],["V/S",15],["Speed",5],["Track",3],["Hex",0],["Squawk",6],["Pos","p"],["Radar",7]],waiting_for_data=!1,waiting_for_pb_data=!1,pb_data_fail_count=0,pb_data_fail_timeout,idleTimeout,currentZoom,current_aircraft_size,polyLineCoordinates,polyLine,element,api,searchAnimTimeout,searchLoadingTimeout,throttleTimeout,throttleTimeout2,disableTimeout=18e5,playback_time,playback_fetch_time=0,playback_mode=0,playback_play=0,playbackInterval,playback_last,timeline_options,trail_color="rainbow",playbackStep=1,disablePlayback=0,map_layers=[],aircraft_type_icons=[],mediaFeedInterval=null,first_run=1,overlay_vor=0,loadFullFeed=!1,goToDelayed="",showRoute=0,showRouteEnabled=!0,showRoutePrevPos=[],link_url="https://fr24.com",isResizeForMobile=!1,g_hasAC=!1,spriteIcons={},mapBoundsOffset=.1,phonetics={A:"ALPHA",B:"BRAVO",C:"CHARLIE",D:"DELTA",E:"ECHO",F:"FOXTROT",G:"GOLF",H:"HOTEL",I:"INDIA",J:"JULIET",K:"KILO",L:"LIMA",M:"MIKE",N:"NOVEMBER",O:"OSCAR",P:"PAPA",Q:"QUEBEC",R:"ROMEO",S:"SIERRA",T:"TANGO",U:"UNIFORM",V:"VICTOR",W:"WHISKEY",X:"X-RAY",Y:"YANKEE",Z:"ZULU",0:"ZERO",1:"ONE",2:"TWO",3:"THREE",4:"FOUR",5:"FIVE",6:"SIX",7:"SEVEN",8:"EIGHT",9:"NINER","-":"DASH"},g_MapControls={},g_MapControlPosition={logo:0,jump:3};$(window).unload(function(){clearTimeout(fetchInterval),clearTimeout(playbackInterval),clearTimeout(preFetchInterval),clearTimeout(fetchInterval),clearTimeout(aInterval),clearTimeout(timeInterval),clearTimeout(updateInterval),clearTimeout(niteInterval)}),Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),a=t.length;--a>=0&&t.item(a)!==this;);return a>-1}),CustomLabel.prototype=new google.maps.OverlayView,CustomLabel.prototype.draw=function(){var e=this,t=this.div_;if(t||(t=this.div_=document.createElement("DIV"),1==e.active_label?(t.id="label_active_"+e.aircraft_id,t.className="aircraft_label_container"):(t.id="label_"+e.aircraft_id,t.className="marker_label"),this.getPanes().overlayImage.appendChild(t)),this.getProjection().fromLatLngToDivPixel(this.latlng_))if(planes_array&&plane_list&&planes_array[e.aircraft_id]&&plane_list[e.aircraft_id]){planes_array[e.aircraft_id].getIcon().size;e.rewrite(),e.move()}else t.innerHTML="",e.remove();e.aircraft_id!=selected_aircraft||showLeftOverlay||e.remove()},CustomLabel.prototype.rewrite=function(){var e=this,t=this.div_;if(t)if(1==e.active_label){var a="nocallsign_"==planes_array[e.aircraft_id].callsign.substr(0,11)?"No callsign":planes_array[e.aircraft_id].callsign.replace("#","");a=a.replace("*",""),t.innerHTML='<div class="aircraft_label">'+a+'</div><div class="aircraft_label_bottom"></div>'}else{var i="";label_extended="nocallsign_"==e.aircraft_id.substr(0,11)?1:0,i+=this.returnLabel(e,init_label_1,1),null!==init_label_2&&map.zoom>7&&(label_extended=1,i+=this.returnLabel(e,init_label_2,2)),null!==init_label_3&&map.zoom>7&&(label_extended=1,i+=this.returnLabel(e,init_label_3,3)),null!==init_label_4&&map.zoom>7&&(label_extended=1,i+=this.returnLabel(e,init_label_4,4)),selected_aircraft==e.aircraft_id&&$(t).hide(),""==i?this.remove():t.innerHTML=i}},CustomLabel.prototype.returnLabel=function(e,t,a){if(a>2&&"function"!=typeof window.get_navdata)return"";var i="",l="";switch("alt"!==t&&"altspeed"!==t||(plane_list[e.aircraft_id][15]>128?l="&nbsp;":plane_list[e.aircraft_id][15]<-128&&(l="&nbsp;")),t){case"acreg":plane_list[e.aircraft_id][9]&&plane_list[e.aircraft_id][8]?i+=plane_list[e.aircraft_id][8]+"&nbsp;"+plane_list[e.aircraft_id][9]:plane_list[e.aircraft_id][8]?i+=plane_list[e.aircraft_id][8]:plane_list[e.aircraft_id][9]&&(i+=plane_list[e.aircraft_id][9]);break;case"altspeed":i+=format_flight_level(plane_list[e.aircraft_id][4])+l+"&nbsp;"+plane_list[e.aircraft_id][5];break;case"tofrom":plane_list[e.aircraft_id][11]&&plane_list[e.aircraft_id][12]&&(i+=plane_list[e.aircraft_id][11]+"&nbsp;-&nbsp;"+plane_list[e.aircraft_id][12]);break;case"ac":plane_list[e.aircraft_id][8]&&(i+=plane_list[e.aircraft_id][8]);break;case"reg":plane_list[e.aircraft_id][9]&&(i+=plane_list[e.aircraft_id][9]);break;case"flight":plane_list[e.aircraft_id][13]&&(i+=plane_list[e.aircraft_id][13]);break;case"alt":i+=format_flight_level(plane_list[e.aircraft_id][4])+l;break;case"speed":i+=plane_list[e.aircraft_id][5];break;case"cs":i=(i="nocallsign_"==planes_array[e.aircraft_id].callsign.substr(0,11)?"No callsign":planes_array[e.aircraft_id].callsign.replace("#","")).replace("*","")}return a>1&&""!=i&&(i='<span style="font-size: 0.85em;">'+i+"</span>"),i},CustomLabel.prototype.move=function(){var e=this,t=this.div_,a=this.getProjection().fromLatLngToDivPixel(this.latlng_);if(t&&a&&planes_array&&plane_list&&planes_array[e.aircraft_id]&&plane_list[e.aircraft_id]){var i,l=planes_array[e.aircraft_id].getIcon().size,r=0;1==e.active_label?(i=Math.round(a.x-l.width/2+1),r=Math.round(a.y-l.height/2+2)):(i=Math.round(a.x+l.width/2+1),r=Math.round(a.y-l.height/2+4)),t.style.transform=t.style.webkitTransform="translate("+i+"px,"+r+"px)"}},CustomLabel.prototype.remove=function(){this.div_&&(this.div_.parentNode.removeChild(this.div_),this.div_=null)},CustomLabel.prototype.getPosition=function(){return this.latlng_};var left_overlay_first_load=1;$().ready(function(){function resetWeatherToggle(){$("#layoutsettings .accordion").trigger("hidden.bs.collapse"),$("#layoutsettings #weather_layers").removeClass("in"),$("#layoutsettings .accordion-toggle").addClass("collapsed")}if($("#fr24_SettingsDropdown").on("settings_changed",function(e,t,a){switch(t){case"unit_speed":case"unit_alt":updateSliderUnits()}}),$("body.mobile").length&&(isResizeForMobile=!0),checkSidebarState(1),1!=simple_mode&&show_utc_time(),"function"==typeof window.get_navdata?(login_check(),loginCheckInterval=setInterval(function(){login_check()},9e5),$(".premum-contents","#leftColOverlay, #cnt-panel-clickhandler").removeClass("premum-contents")):$(".premum-contents","#leftColOverlay, #cnt-panel-clickhandler").next(".attrText").html(""),"#!/"==location.hash.substr(0,3)&&(window.location=dispatcher.urls.site+"/"+location.hash.substr(3,location.hash.length-3)),$("a.menuChoice").click(function(){"premiumButton"==$(this).attr("id")?$("#premiumOverlay").css("top",$(this).position().top+5+"px").toggle():($("ul.menuChoices li.active").removeClass("active"),$("ul.menuChoices ul.subChoices").hide(),$(this).parent("li").addClass("active"),$(this).parent("li").find("ul.subChoices").show())}),$(".no-click").click(function(e){return e.preventDefault(),e.stopPropagation(),!1}),$(document.body).on("click","#leftColOverlay .close, #cnt-panel-clickhandler .close",function(){$(".aircraft_marker.active .aircraft_label_container").remove(),$("#aircraft_"+selected_aircraft+" .temporary_label").length>0&&$("#aircraft_"+selected_aircraft+" .temporary_label").removeClass("opacity_0").show();var e=selected_aircraft;close_aircraft_data(),remove_label(e,!0),handleAppAdBlackout()}),$(document.body).on("click","#follow-aircraft, #btn-aircraft-action-follow",function(){if($(this).hasClass("active"))$(this).removeClass("active"),follow_aircraft=0;else if($(this).addClass("active"),follow_aircraft=1,plane_list[selected_aircraft]&&isMapPannable()&&!isAirportView()){var e=new google.maps.LatLng(plane_list[selected_aircraft][1],plane_list[selected_aircraft][2]);map.panToOffsetted(e)}}),$(document.body).on("focus","input.select-on-focus",function(){$(this).select()}).on("mouseup","input.select-on-focus",function(e){e.preventDefault()}),$(document.body).on("click","a#chat-link",function(){window.open("//www.flightradar24.com/chat/index.php","Chat","menubar=no,width=550,height=600,toolbar=no")}),$(document.body).on("change","#jump-to",function(){jumpToController($(this).val()),$(this).val("")}),$("#playbackButton").click(function(){$("#map_canvas").length>0&&mapCanvasStub.getProjection()&&0==playback_mode&&0==disablePlayback&&$("#playbackOverlay").toggle()}),$("#playback-start").click(function(){window.busMan&&window.busMan.hideMapAds(),$("#fr24_PlaybackMenu").removeClass("open"),playback_start()}),$("#playback-exit").click(function(){window.busMan&&window.busMan.showMapAds(),disablePlayback=1,playback_exit(),setTimeout("disablePlayback=0",1e3)}),$("#playback-step-back").click(function(){$("#playback-step-back").attr("disabled",!0),$("#playback-step-forward").attr("disabled",!0),$("#playback-pause").attr("disabled",!0),playback_change_time(0),playback_queue=[],playback_fetch_time=new Date(playback_time.getTime()),fetch_playback_list()}),$("#playback-step-forward").click(function(){$("#playback-step-back").attr("disabled",!0),$("#playback-step-forward").attr("disabled",!0),$("#playback-pause").attr("disabled",!0),playback_change_time(1),playback_queue=[],playback_fetch_time=new Date(playback_time.getTime()),fetch_playback_list()}),$("#playback-pause").click(function(){1==playback_play?(playback_play=0,$(this).removeClass("pause").addClass("play"),$("#playback-step-back").attr("disabled",!1),$("#playback-step-forward").attr("disabled",!1),clearTimeout(playbackInterval),playbackInterval=!1,clearTimeout(preFetchInterval),clearTimeout(aInterval),aInterval=!1,playback_fetch_time=0):0==playback_play&&(playback_play=1,$(this).removeClass("play").addClass("pause"),$("#playback-step-back").attr("disabled",!0),$("#playback-step-forward").attr("disabled",!0),clearTimeout(playbackInterval),playbackInterval=setTimeout("playback_change_time('')",500),clearTimeout(preFetchInterval),preFetchInterval=!1,playback_change_fetch_time(),0!=aInterval&&(clearTimeout(aInterval),aInterval=setTimeout(animate_playback,100)))}),$(".overlayBoxClose").click(function(){$(".overlayBoxContainer").hide()}),$("#mac-overlay").length>0&&($("#mac-overlay-background").css("opacity",.7).show(),$("#mac-overlay").css("left",($("body").width()-800)/2+"px").css("top",($("body").height()-570)/2+"px").show()),$("#mac-overlay a").click(function(){$("#mac-overlay-background").remove(),$("#mac-overlay").remove()}),$("#slider-playbackSpeed").slider({range:"min",min:12,max:120,value:12,step:12,slide:function(e,t){$("#slider-playbackSpeed-value").html(t.value+"x"),$("#slider-playbackSpeed-value").attr("data-playback-speed",t.value),playback_speed=t.value,1==playback_play&&(playback_play=0,$(this).children("img").removeClass("pause").addClass("play"),$("#playback-step-back").attr("disabled",!1),$("#playback-step-forward").attr("disabled",!1),clearTimeout(playbackInterval),playbackInterval=!1,clearTimeout(preFetchInterval))},stop:function(e,t){0==playback_play&&(playback_play=1,$(this).children("img").removeClass("play").addClass("pause"),$("#playback-step-back").attr("disabled",!0),$("#playback-step-forward").attr("disabled",!0),playback_tick_ms=0,playback_fetch_time=0,playback_queue=[],playbackStep=$("#slider-playbackSpeed-value").attr("data-playback-speed")/12,clearTimeout(playbackInterval),clearTimeout(preFetchInterval),clearTimeout(aInterval),aInterval=!1,fetch_playback_list())}}),$("#slider-playbackSpeed").slider("value",12),$("#slider-playbackSpeed-value").html("12x").attr("data-playback-speed",12),$("#modalContentClose").click(function(){hide_airport_info()}),$("#airportListType").change(function(){get_airport_flights(selected_airport,$(this).val())}),$(document).on("click",".aircraftLink",function(){return goToAircraft($(this).attr("data-aircraft")),!1}),1!=simple_mode){$("select#playback-date").selectmenu({appendTo:"#playbackOverlay",maxHeight:200}),$("select#playback-hour").selectmenu({appendTo:"#playbackOverlay",maxHeight:200}),$("select#playback-minute").selectmenu({appendTo:"#playbackOverlay",maxHeight:200}),$("select#playback-speed").selectmenu({appendTo:"#playbackOverlay",maxHeight:200}),$("select#airportListType").selectmenu({appendTo:"#modalContent",maxHeight:400}),$("#searchBox").focus(function(){dispatcher.display.isMobile&&$("#searchBox").prop("placeholder","Flight, airport or registration"),clearTimeout(searchAnimTimeout),$("#leftCol").length}),$("#searchBox").blur(function(){dispatcher.display.isMobile&&$("#searchBox").prop("placeholder",""),searchAnimTimeout=setTimeout(function(){$("#searchBox").val("")},100)});var objSearchCache={},searchLiCounter=0,currentCat,goToWasHovered=!1,leftMargin=$(window).width()<860&&$(window).width()>680?860-$(window).width():0;document.getElementById("searchBox")&&($("#searchBox").autocomplete({appendTo:"#content-container",autoFocus:!0,delay:50,minLength:3,position:{my:"right top+10",at:"right+"+leftMargin+" bottom"},search:function(e,t){searchLiCounter=0,currentCat=null,searchStats={},clearTimeout(searchLoadingTimeout),searchLoadingTimeout=setTimeout("$('#searchBox').removeClass('ui-autocomplete-loading');",5e3)},response:function(e,t){$(this).removeClass("ui-autocomplete-loading"),t.content.push({type:"adv",label:"Advanced search"})},select:function(e,t){switch(t.item.type){case"live":addMultiSelect(t.item.id),1==goToWasHovered?void 0!==t.item.detail.flight?show_flight_info(t.item.detail.flight):void 0!==t.item.detail.reg?show_reg_info(t.item.detail.reg):goToAircraft(t.item.id,!0):goToAircraft(t.item.id,!0);break;case"schedule":show_flight_info(t.item.id);break;case"aircraft":show_reg_info(t.item.id);break;case"airport":map.setCenter(new google.maps.LatLng(t.item.detail.lat,t.item.detail.lon)),map.setZoom(8),clearTimeout(fetchInterval),fetch_plane_list();break;case"operator":document.location.href="/data/airlines/"+(t.item.detail.iata?t.item.detail.iata.toLowerCase()+"-":"")+t.item.id.toLowerCase()}selected_aircraft!=t.item.id&&1==follow_aircraft&&(follow_aircraft=0,$("a#follow-aircraft").removeClass("active")),$(this).blur()},source:function(e,t){var a=e.term.trim().toLowerCase(),i=13,l=$(window).height();a.length<3||(l<428?i=2:l<465?i=3:l<504?i=4:l<540?i=5:l<596?i=6:l<628?i=7:l<668?i=8:l<705?i=9:l<758?i=10:l<795?i=11:l<830?i=12:l<850&&(i=13),$.getJSON(dispatcher.urls.search,{query:a,limit:i},function(e,a,i){searchStats=e.stats,t(e.results)}))},focus:function(e,t){return!1},blur:function(e,t){return $(this).blur(),!0},open:function(e,t){override_filters()&&removeShowAllMsg(),$("body").addClass("show-search-overlay"),$(this).removeClass("ui-autocomplete-loading"),goToWasHovered=!1,dispatcher.display.isMobile&&$("#fr24_ViewsToolbar").hide()},close:function(e,t){$("body").removeClass("show-search-overlay"),$(this).removeClass("ui-autocomplete-loading"),goToWasHovered=!1,dispatcher.display.isMobile&&$("#fr24_ViewsToolbar").show()}}).data("ui-autocomplete")._renderItem=function(e,t){var a=$("#searchBox").val().replace(/[^\'\.\-0-9A-Za-z ]/g,""),i=new RegExp(a.replace(/([-.'])/g,"\\$1?"),"gi"),l="";if(t.resultLabel=t.label,"airport"!==t.type&&"operator"!==t.type&&(t.resultLabel=t.resultLabel.replace(/^(.*-> )?([^/\($]+)( \/| \(|$)/,'$1<span class="first">$2</span>$3')),t.resultLabel=t.resultLabel.replace(i,'<span class="match">$&</span>'),void 0!==t.detail&&void 0!==t.detail.route&&(t.resultLabel+='</span><span class="route">'+t.detail.route),"adv"===t.type)return $("<li class='advsearch'></li>").append('<span onclick="document.location.href = \'/data/\';">Advanced search</span><a style="display:none;"></a>').appendTo(e);if("airport"===t.type?l='<span class="rowButton departures" data-iata="'+t.id+'" title="Departures"><svg><use xlink:href="#icon-fr24-departure" /></svg></span><span class="rowButton arrivals" data-iata="'+t.id+'" title="Arrivals"><svg><use xlink:href="#icon-fr24-arrival" /></svg></span><span class="rowButton onground" data-iata="'+t.id+'" title="On ground"><svg><use xlink:href="#icon-fr24-onground" /></svg></span>':"live"===t.type?l='<span class="rowButton info" title="View flight info"><svg><use xlink:href="#icon-fr24-info-boarder" /></svg></span><span class="rowButton goto" title="Go to flight"><svg><use xlink:href="#icon-fr24-plane-boarder" /></svg></span>':"schedule"===t.type&&(l='<span class="rowButton schedule" title="View flight info"><svg><use xlink:href="#icon-fr24-info-boarder" /></svg></span>'),t.type!=currentCat){var r="";switch(t.type){case"live":r="Live flights";break;case"schedule":r="Recent or scheduled flights";break;case"airport":r="Airports";break;case"aircraft":r="Aircraft";break;case"operator":r="Airlines"}""!==r&&$("<li class='sep'>"+r+"<div>"+searchStats.count[t.type]+" of "+searchStats.total[t.type]+" matches</div></li>").appendTo(e)}currentCat=t.type;var n="",s="",o="";if(void 0!==t.type&&"airport"==t.type)n="<svg class='"+t.type+"'><use xlink:href='#icon-fr24-"+t.type+"' /></svg>";else if(void 0!==t.detail&&void 0!==t.detail.logo){var c=t.detail.logo.split(":");2===c.length&&("fr24"===c[0]?o=dispatcher.urls.static+dispatcher.urls.operators+"/"+c[1]:"s3"===c[0]&&(o="//cdn.flightradar24.com/assets/airlines/logotypes/"+c[1]),s="background: #f5f5f5 url('"+o+"') center/4em no-repeat")}else s="background: #f5f5f5 url('"+dispatcher.urls.static+dispatcher.urls.operators+"/default.png') center/4em no-repeat";return $("<li class='"+(searchLiCounter%2==0?"":"odd")+"'></li>").append('<a class="'+t.type+'"><span class="rowIcon" style="'+s+'">'+n+'</span><span class="label '+t.type+'">'+t.resultLabel+"</span><br class=\"clear\" /></a><div class='rowButtons'>"+l+"</div>").appendTo(e)})}$(document.body).on("click","#cockpitClose",function(){$(".pilotViewLink").removeClass("active")}),$(document.body).on("click",".pilotViewLink, #btn-aircraft-action-3d",function(){return!$(this).hasClass("disabled")&&(-1==aircraft_type_assignments.grnd.indexOf(plane_list_org[selected_aircraft][8])&&("undefined"!=typeof cockpitViewModel?(cockpitViewModel.close(function(){getSetting("animate_aircraft")&&(init_anim=1),window.busMan&&window.busMan.hideThreeDAd()}),$(this).removeClass("active"),!1):($(this).addClass("active"),cockpitViewModel=new CesiumCockpit(function(){init_anim=0,window.busMan&&window.busMan.showThreeDAd()}),History.pushState("",document.title,window.location.href+"/3d"),void _gaq.push(["._trackEvent","3d_view","3d_view_open"]))))}),$(document.body).on("click","#fb-share",function(){var e=(window.screen.width-600)/2,t=(window.screen.height-450)/2,a=$(this).attr("href");return window.open(a,"sharer","resizable=0,toolbar=0,status=0,width=600,height=350,top="+t+",left="+e),!1}),$(document.body).on("click","#tw-share",function(){var e=(window.screen.width-600)/2,t=(window.screen.height-450)/2,a=$(this).attr("href");return window.open(a,"sharer","resizable=0,toolbar=0,status=0,width=600,height=250,top="+t+",left="+e),!1}),$(document.body).on("click","#gp-share",function(){var e=(window.screen.width-480)/2,t=(window.screen.height-450)/2,a=$(this).attr("href");return window.open(a,"sharer","resizable=0,toolbar=0,status=0,width=480,height=250,top="+t+",left="+e),!1}),$(document.body).on("click","img.sideView",function(){showSideView($(this).attr("src"))}),$(document.body).on("click","a#sideviewContentClose",function(){hideSideView()}),$(document.body).on("click","a.showRouteLink, #btn-aircraft-action-route",function(){if($(this).hasClass("disabled"))return!1;$(this).hasClass("active")?($(this).removeClass("active"),hideSelectedRoute(!0)):($(this).addClass("active"),delete_all_labels(),showSelectedRoute())}),$(document.body).on("click","#multiSelectShowRoute",function(){if(0===selected_aircraft_array.length)return!1;showMultiSelectRoute=!showMultiSelectRoute,selected_aircraft="NULL",delete_all_labels(),update_planes()}),$(document.body).on("click","#multiSelectInfoWindow",function(){if(0===selected_aircraft_array.length)return!1;(showMultiSelectInfo=!showMultiSelectInfo)?($("#leftColOverlayMulti .flightInfoboxMulti").show(),arrangeMultiSelectWindows()):$("#leftColOverlayMulti .flightInfoboxMulti").hide()}),$(document.body).on("click","#multiSelectInfoWindow, #multiSelectShowRoute",function(){selected_aircraft_array.length>0?statusMultiSelect():$("#msgMultiSelect").fadeIn().delay(1e3).fadeOut()}),$(document.body).on("click","a.shareFlightLink",function(){if($(this).hasClass("disabled"))return!1;$(this).hasClass("active")?hideShareBox():($(this).addClass("active"),showShareBox($(this)))});var historyPageViewTest=/\/([0-9]{4}-[0-9]{2}-[0-9]{2}|-?[0-9\.]+,-?[0-9\.]+)\//;History.Adapter.bind(window,"statechange",function(){hide_tooltip();var State=History.getState();if(State&&(State.data.currentSection&&""!==State.data.currentSection&&(State.data.currentCallback&&""!==State.data.currentCallback?eval(State.data.currentCallback):showDynamicOverlay(State.data.currentSection,State.data.currentUrl,State.data.currentSource,State.data.currentOverlayState)),"object"==typeof _gaq)){var currUrl="/"+State.url.replace(dispatcher.urls.site,"").replace(/^\/|\/$/g,"");historyPageViewTest.test(currUrl)||_gaq.push(["_trackPageview",currUrl])}}),$(document.body).on("click","div.dynamicOverlay a.close, #modalBlackout .loadError input",function(){closeDynamicOverlay()}),$(document.body).on("click","div.dynamicOverlay a.fa-map-marker",function(){$(this).data("icao");var e,t=$(this).data("lat"),a=$(this).data("long");if(t&&a&&isMapView())return e=new google.maps.LatLng(t,a),map.setZoom(8),map.panTo(e),closeDynamicOverlay(),!1}),$(document.body).keydown(function(e){27===e.which&&$("#mapDynamicOverlays .dynamicOverlay.active").length>0&&closeDynamicOverlay()}),$(document.body).on("click","ul.ui-autocomplete span.arrivals",function(){show_airport_info($(this).attr("data-iata"),"arr")}),$(document.body).on("click","ul.ui-autocomplete span.departures",function(){show_airport_info($(this).attr("data-iata"),"dep")}),$(document.body).on("click","ul.ui-autocomplete span.onground",function(){show_airport_info($(this).attr("data-iata"),"gro")}),$("#leftColOverlay").on("click",".airportLink",function(){""!==$.trim($(this).attr("data-iata"))&&show_airport_info(["",$(this).attr("data-iata")])}),$("#airport-origin-link, #airport-destination-link").on("click",function(e){e.preventDefault(),""!==$.trim($(this).attr("data-iata"))&&show_airport_info(["",$(this).attr("data-iata")])}),$("#leftColOverlay").on("click",".regLink",function(){show_reg_info($(this).attr("data-reg"))}),$("#leftColOverlay").on("click",".btn-info-window",function(){var e=$(this).data("class"),t="lo_"+e,a=0;$("#leftColOverlay").toggleClass(e),$("#leftColOverlay").hasClass(e)&&(a=1),setSetting(t,a)}),$("#btnAltSpeedGraph").on("click",function(){$("#aircraftInfoGridContainer","#leftColOverlay, #cnt-panel-clickhandler").toggleClass("show-graph"),create_selected_aircraft_graph(selected_data[selected_aircraft].trail)}),$("#altSpeedGraphContainerLarge").draggable({cancel:"#altSpeedGraphLarge"}),$("#altSpeedGraphExpand").on("click",function(){$("#altSpeedGraphContainerLarge").toggle(),create_selected_aircraft_graph(selected_data[selected_aircraft].trail,"#altSpeedGraphLarge")}),$("#altSpeedGraphContainerLarge > a").on("click",function(){$("#altSpeedGraphContainerLarge").toggle()}),$(document.body).on("mouseenter","ul.ui-autocomplete span.info",function(){goToWasHovered=!0}),$(document.body).on("mouseleave","ul.ui-autocomplete span.info",function(){goToWasHovered=!1}),$("#awdContainer").length>0&&setTimeout(function(){0===$("#modalBlackout").length&&($(".modalContainer").hide(),$("#awdContainer").show(),blackoutMap())},1e4),$("#awdContentClose").click(function(){setSetting("awd_dismissed","1",14),clearBlackout(),$("#awdContainer").remove()}),$("#awdContentClose2").click(function(){setSetting("awd_dismissed","1",14),clearBlackout(),$("#awdContainer").remove()}),$("#menuStats a.menuChoice, #menuAirportStats a.menuChoice").click(function(){var e=$(this).parent();setSetting("menuStats"===e.attr("id")?"menu_stats_status":"menu_delay_stats_status","menuStats"===e.attr("id")?init_menu_stats_status=init_menu_stats_status?0:1:init_setting_menu_delay_stats_status=init_setting_menu_delay_stats_status?0:1,365)}),$("#menuTwitter h5").click(function(){var e;e=init_menu_twitter_status=init_menu_twitter_status?0:1,showLeftMenuItem("#menuTwitter h5"),setSetting("menu_twitter_status",e,365)}),$("#menuBlog h5").click(function(){var e;e=init_menu_blog_status=init_menu_blog_status?0:1,showLeftMenuItem("#menuBlog h5"),setSetting("menu_blog_status",e,365)}),$("#layoutsettings .accordion").on("shown.bs.collapse",function(e){$(".other_layers_section").hide()}),$("#layoutsettings .accordion").on("hidden.bs.collapse",function(e){$(".other_layers_section").show()}),$('div[data-toggle="tab"]').on("shown.bs.tab",function(){"#layoutsettings"!=$(this).attr("href")&&resetWeatherToggle()}),$(window).resize(function(){null!==playbackTimeline&&playbackTimeline.redraw(),checkSidebarState(),getMediaFeedLimits()}),1!=simple_mode&&(get_mediaFeeds(),mediaFeedInterval=setInterval(function(){get_mediaFeeds()},12e4)),$("#fr24_ViewsDropdownContainer button").click(function(){var e=$("#fr24_ViewsDropdownContainer");$(e).hasClass("open")?$(".view-search",e).show():$(".view-search",e).hide()}),$("#fr24_ViewsDropdownContainer").click(function(e){if("INPUT"===$(e.target)[0].nodeName)return!1;$(this).hasClass("open")?$(".view-search",this).show():"multiView"!==map_left_menu_view&&$(".view-search",this).hide()}),$("#fr24_ViewsDropdown li a").click(function(){if($(this).parent().hasClass("notAllowed"))return!1;$(this).parent().hasClass("disabled")||(changeViewTitleText($(this).data("value")),NavigationManager&&1==NavigationManager.initNavState()&&(setSetting("map_left_menu_view",map_left_menu_view),NavigationManager&&"function"==typeof NavigationManager.updateUserProfile&&NavigationManager.updateUserProfile("put")))}),$("#fr24_Fullscreen a").on("click",function(){return!dispatcher.display.isMobile&&(!$(this).hasClass("disabled")&&($("body").hasClass("fullscreenView")?(map_fullscreen_view=0,$(this).removeClass("selected"),$(this).parent().removeClass("open"),$("body").removeClass("fullscreenView"),init_topbar=1,showSidebar(),adjustViewHeight()):(map_fullscreen_view=1,$(this).addClass("selected"),$("body").addClass("fullscreenView"),init_topbar=0,closeSidebar(),adjustViewHeight()),void setSetting("map_fullscreen_view",map_fullscreen_view)))}),setting_map_left_menu_view=getSetting("map_left_menu_view"),setting_map_left_menu_view&&(setting_map_left_menu_view=setting_map_left_menu_view.replace("View",""),changeViewTitleText(setting_map_left_menu_view)),$("#filter_select_all").on("change",function(){var e="#selective_unblocking input[type=checkbox]";$(this).is(":checked")?$(e).prop("checked",!0):$(e).prop("checked",!1),NavigationManager&&"function"==typeof NavigationManager.renderFilterPopup&&NavigationManager.renderFilterPopup()}),$("#filter_select_all, #selective_unblocking input[type=checkbox]").on("change",function(){fetch_plane_list();var e=[];$("#selective_unblocking input[type=checkbox]:checked").each(function(){var t=$(this).data("value");e.push(t)}),setSetting("filter_selective_unblocking",e),NavigationManager&&"function"==typeof NavigationManager.renderFilterPopup&&NavigationManager.renderFilterPopup()})}),window.recordOutboundLink,document.addEventListener("visibilitychange",handleVisibilityChange,!1),dispatcher.display&&!dispatcher.display.isMobile&&($(document).ready(function(){var e=this;e.btnChLgFlightsToggle=document.getElementById("btn-ch-lg-flights-toggle"),e.cntChLgFlights=document.getElementById("cnt-ch-lg-flights"),e.linkChLgMoreFlights=document.getElementById("link-ch-lg-more-flights"),e.tblChLgFlights=document.getElementById("tbl-ch-lg-flights"),e.cntChLgFlightsLoader=document.getElementById("cnt-ch-lg-flights-loader"),e.btnChLgFlightsToggle&&e.btnChLgFlightsToggle.addEventListener("click",function(t){if(this.classList.toggle("active")){if(e.linkChLgMoreFlights.innerHTML="More "+e.btnChLgFlightsToggle.dataset.reg+' flights <svg class="icon-fr24-goto"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#icon-fr24-goto"></use></svg>',e.linkChLgMoreFlights.href="/data/aircraft/"+e.btnChLgFlightsToggle.dataset.reg.toLowerCase(),e.linkChLgMoreFlights.target="_blank",e.linkChLgMoreFlights.dataset.tooltipValue="Get full information on past and upcoming "+e.btnChLgFlightsToggle.dataset.reg+" flights",e.linkChLgMoreFlights.dataset.tooltipMaxwidth="200px",e.linkChLgMoreFlights.classList.add("hasTooltip"),e.cntChLgFlights.classList.remove("hidden"),!e.btnChLgFlightsToggle.isDataLoaded){e.tblChLgFlights.classList.add("hidden"),e.cntChLgFlightsLoader.classList.remove("hidden");var a=getCookie("_frPl")||"";fetch(dispatcher.urls.mobileApi+"/common/v1/flight/list.json?query="+e.btnChLgFlightsToggle.dataset.reg+"&fetchBy=reg&filterBy=historic&limit=5&page=1&timestamp="+Math.floor((new Date).getTime()/1e3)+"&token="+a,{method:"GET",mode:"cors",headers:{"Access-Control-Request-Headers":"*",Accept:"application/json"},redirect:"follow"}).then(function(t){return t.json().then(function(t){var a=1==init_clock_12h?"h:mm A":"HH:mm";if(t.result&&t.result.response&&Array.isArray(t.result.response.data)){var i=t.result.response.data,l=document.querySelector("#tbl-ch-lg-flights tbody");if(e.btnChLgFlightsToggle.isDataLoaded=!0,e.tblChLgFlights.classList.remove("hidden"),e.cntChLgFlightsLoader.classList.add("hidden"),l.firstChild)for(;l.firstChild;)l.removeChild(l.firstChild);for(var r=1;r<i.length;r++){var n=document.createElement("tr"),s=document.createElement("tr"),o=document.createElement("td"),c=document.createElement("td"),p=document.createElement("td");if(n.setAttribute("id",Math.random().toString(36).replace(/[^a-z0-9]+/g,"").substr(0,10)),s.classList.add("slave"),s.classList.add("hidden"),p.setAttribute("colspan","2"),void 0!==i[r]&&i[r].time&&(i[r].time.scheduled&&i[r].time.scheduled.departure||i[r].time.real&&i[r].time.real.departure)){var _=i[r].time.scheduled.departure||i[r].time.real.departure,d=i[r].status.generic.status.color;null!=d&&"null"!=d||(d="gray"),o.innerHTML='<span class="status '+d+'"></span><span class="date">'+moment(1e3*_).utc().format("D MMM")+"</span>"}else o.innerHTML='<span class="status"></span><span class="date">N/A</span>';var f=void 0!==i[r]&&void 0!==i[r].airport&&i[r].airport.origin?i[r].airport.origin.position.region.city+" ("+i[r].airport.origin.code.iata+")":"N/A",u=void 0!==i[r]&&void 0!==i[r].airport&&i[r].airport.destination?i[r].airport.destination.position.region.city+" ("+i[r].airport.destination.code.iata+")":"N/A",m=void 0!==i[r]&&void 0!==i[r].identification&&i[r].identification.callsign?"("+i[r].identification.callsign+")":"",g=void 0!==i[r]&&void 0!==i[r].identification&&i[r].identification.number.default?i[r].identification.number.default:"";c.innerHTML='<p class="flight">'+g+" <small>"+m+'</small></p><p class="route">'+f+" - "+u+'</p><svg class="icon-fr24-arrow"><use xlink:href="#icon-fr24-arrow-down" /></svg>';var h="-",y="-",v="-",b="-";if(void 0!==i[r]&&void 0!==i[r].time&&i[r].time.scheduled){i[r].time.scheduled.departure>0&&(w=0,1==init_clock_local&&i[r].airport&&i[r].airport.origin&&i[r].airport.origin.timezone&&i[r].airport.origin.timezone.offset&&(w=i[r].airport.origin.timezone.offset),h=moment(1e3*(i[r].time.scheduled.departure+w)).utc().format(a).replace(/am|pm/gi,function(e){return"<small>"+e+"</small>"})),i[r].time.scheduled.arrival>0&&(w=0,1==init_clock_local&&isset(i[r],"airport","destination","timezone","offset")&&(w=i[r].airport.destination.timezone.offset),y=moment(1e3*(i[r].time.scheduled.arrival+w)).utc().format(a).replace(/am|pm/gi,function(e){return"<small>"+e+"</small>"}))}if(void 0!==i[r]&&void 0!==i[r].time&&i[r].time.real){var w;i[r].time.real.departure>0&&(w=0,1==init_clock_local&&i[r].airport&&i[r].airport.origin&&i[r].airport.origin.timezone&&i[r].airport.origin.timezone.offset&&(w=i[r].airport.origin.timezone.offset),v=moment(1e3*(i[r].time.real.departure+w)).utc().format(a).replace(/am|pm/gi,function(e){return"<small>"+e+"</small>"}))}void 0!==i[r]&&void 0!==i[r].time&&i[r].time.other&&i[r].time.other.duration>0&&(b=minutesToHHMM(i[r].time.other.duration/60,!1));var k=isset(i[r],"airport","destination","timezone","offset")?parseInt(i[r].airport.destination.timezone.offset):0,$="";isset(i[r],"status","generic","eventTime","utc")&&($=moment.utc(1e3*(parseInt(i[r].status.generic.eventTime.utc)+k)).format(a).replace(/am|pm/gi,function(e){return"<small>"+e+"</small>"})),p.innerHTML='<div class="cnt"><div class="row"><div><label>SCHEDULED DEP.</label><p>'+h+"</p></div><div><label>ACTUAL DEP.</label><p>"+v+"</p></div><div><label>SCHEDULED ARR.</label><p>"+y+'</p></div></div><div class="row"><div><label>STATUS</label><p>'+(void 0!==i[r]&&void 0!==i[r].status&&i[r].status.generic.status.text?i[r].status.generic.status.text.ucfirst()+" "+$:"-")+"</p></div><div><label>FLIGHT TIME</label><p>"+b+"</p></div></div></div>",n.appendChild(o),n.appendChild(c),n.classList.add("master"),s.appendChild(p),l.appendChild(n),l.appendChild(s)}}})})}}else e.cntChLgFlights.classList.add("hidden")})}),document.addEventListener("click",function(e){for(var t=e.target;t&&t!=this;t=t.parentNode)if(t.matches("#tbl-ch-lg-flights tbody tr")){var a=document.querySelector("#tbl-ch-lg-flights tbody tr.master.active");a&&(a.classList.remove("active"),a.nextSibling.classList.add("hidden")),(!a||a&&a.id!=t.id)&&(t.classList.add("active"),t.nextSibling.classList.remove("hidden"));break}},!1));var isset=function(e){for(var t=Array.prototype.slice.call(arguments,1),a=0;a<t.length;a++){if(!e||null==e||!e.hasOwnProperty(t[a])||null==t[a])return!1;if(null==(e=e[t[a]]))return!1}return!0};