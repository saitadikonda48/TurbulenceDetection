<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Use correct character set. -->
  <meta charset="utf-8">
  <!-- Tell IE to use the latest, best version. -->
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <!-- Make the application on mobile take up the full browser screen and disable user scaling. -->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">
  <title>Automated Turbulence Detection</title>
  <script src="../Build/Cesium/Cesium.js"></script>
  <style>
      @import url(../Build/Cesium/Widgets/widgets.css);
      html, body, #cesiumContainer {
          width: 100%; height: 100%; margin: 0; padding: 0; overflow: hidden;
      }
  </style>
</head>
<body>
  <div style="width: 100%; height: 100%;">
    <!--
    <button style="z-index: 2; position: absolute; top: 6px; left: 6px;" class="cesium-button cesium-button-toolbar" onclick="toggleTurbulence()">Toggle turbulence</button>
    -->
    <div id="cesiumContainer"></div>
    <script>
      // Set center to be the geographic center of the United States
      var extent = Cesium.Rectangle.fromDegrees(-100,25,-95,55);
      Cesium.Camera.DEFAULT_VIEW_RECTANGLE = extent;
      Cesium.Camera.DEFAULT_VIEW_FACTOR = 0;
      // Remove unnecessary buttons
      var viewer = new Cesium.Viewer('cesiumContainer', {
        timeline : false,
        animation : false,
        baseLayerPicker : false,
        sceneModePicker : false
      });
      // Limit the user's ability to zoom out
      viewer.scene.screenSpaceCameraController.maximumZoomDistance=15000000;

      // Handle toggling turbulence layer
      var turbulenceOn = false;
      var turbulenceLayer = null;
      function toggleTurbulence() {
        if (!turbulenceOn) {
          if (turbulenceLayer === null) {
            turbulenceLayer = viewer.imageryLayers.addImageryProvider(new Cesium.SingleTileImageryProvider({
              url : 'turbulence.png'
            }));
          } else {
            viewer.imageryLayers.add(turbulenceLayer)
          }
        } else {
          viewer.imageryLayers.remove(turbulenceLayer, false);
        }
        turbulenceOn = !turbulenceOn;
        checkbox.checked = turbulenceOn;
      }

      // Add turbulence button to toolbar
      var arr = document.getElementsByClassName("cesium-viewer-toolbar");
      if (arr.length > 0) {
        var toolbar = arr[0]
        var button = document.createElement("button");
        button.type = "button";
        button.onclick = toggleTurbulence;
        button.className = "cesium-button";

        var label = document.createElement("label");
        label.type = "label";
        label.style = "pointer-events: none;";

        var checkbox = document.createElement("input");
        checkbox.type = "checkbox";
        checkbox.style = "pointer-events: none;";

        label.appendChild(checkbox);
        label.appendChild(document.createTextNode("Turbulence"));
        button.appendChild(label);
        toolbar.appendChild(button);
      }
    </script>
  </div>
</body>
</html>
